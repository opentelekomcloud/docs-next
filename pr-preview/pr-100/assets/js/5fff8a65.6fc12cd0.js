"use strict";(self.webpackChunkdocs_next=self.webpackChunkdocs_next||[]).push([[81224],{93681:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>c,contentTitle:()=>l,default:()=>h,frontMatter:()=>r,metadata:()=>o,toc:()=>d});var s=i(74848),t=i(28453);const r={id:"creating-a-linux-Image-using-virtualBox-and-an-iso-file",title:"Creating a Linux Image Using VirtualBox and an ISO File",tags:["ims","migration"]},l="Creating a Linux Image Using VirtualBox and an ISO File",o={id:"best-practices/computing/image-management-service/creating-a-linux-Image-using-virtualBox-and-an-iso-file",title:"Creating a Linux Image Using VirtualBox and an ISO File",description:"Introduction",source:"@site/docs/best-practices/computing/image-management-service/creating-a-linux-Image-using-virtualBox-and-an-iso-file.md",sourceDirName:"best-practices/computing/image-management-service",slug:"/best-practices/computing/image-management-service/creating-a-linux-Image-using-virtualBox-and-an-iso-file",permalink:"/docs-next/pr-preview/pr-100/docs/best-practices/computing/image-management-service/creating-a-linux-Image-using-virtualBox-and-an-iso-file",draft:!1,unlisted:!1,editUrl:"https://github.com/akyriako/docs-next/tree/main/docs/best-practices/computing/image-management-service/creating-a-linux-Image-using-virtualBox-and-an-iso-file.md",tags:[{inline:!0,label:"ims",permalink:"/docs-next/pr-preview/pr-100/docs/tags/ims"},{inline:!0,label:"migration",permalink:"/docs-next/pr-preview/pr-100/docs/tags/migration"}],version:"current",frontMatter:{id:"creating-a-linux-Image-using-virtualBox-and-an-iso-file",title:"Creating a Linux Image Using VirtualBox and an ISO File",tags:["ims","migration"]}},c={},d=[{value:"Introduction",id:"introduction",level:2},{value:"VirtualBox",id:"virtualbox",level:4},{value:"Scenarios",id:"scenarios",level:4},{value:"Advantages",id:"advantages",level:4},{value:"Tools and Costs",id:"tools-and-costs",level:4},{value:"Image Creation Process",id:"image-creation-process",level:4},{value:"Step 1: Installing VirtualBox",id:"step-1-installing-virtualbox",level:2},{value:"Preparations",id:"preparations",level:4},{value:"Host CPU Settings (Hardware Virtualization)",id:"host-cpu-settings-hardware-virtualization",level:4},{value:"Procedure",id:"procedure",level:4},{value:"Step 2: Creating a VM and Installing an OS",id:"step-2-creating-a-vm-and-installing-an-os",level:2},{value:"Creating an Empty VM",id:"creating-an-empty-vm",level:2},{value:"Prerequisites",id:"prerequisites",level:4},{value:"Procedure",id:"procedure-1",level:4},{value:"Installing a Linux OS on the VM",id:"installing-a-linux-os-on-the-vm",level:2},{value:"Prerequisites",id:"prerequisites-1",level:4},{value:"Procedure",id:"procedure-2",level:4},{value:"Step 3: Configuring the VM",id:"step-3-configuring-the-vm",level:2},{value:"Installing Drivers and Changing the Disk Identifiers to the UUID Format",id:"installing-drivers-and-changing-the-disk-identifiers-to-the-uuid-format",level:2},{value:"Install Native Xen and KVM Drivers",id:"install-native-xen-and-kvm-drivers",level:4},{value:"Change the Disk Identifier in the GRUB Configuration File to the UUID Format",id:"change-the-disk-identifier-in-the-grub-configuration-file-to-the-uuid-format",level:4},{value:"Change the Disk Identifiers in the fstab File to the UUID Format",id:"change-the-disk-identifiers-in-the-fstab-file-to-the-uuid-format",level:4},{value:"Installing Cloud-Init",id:"installing-cloud-init",level:2},{value:"Scenarios",id:"scenarios-1",level:4},{value:"Prerequisites",id:"prerequisites-2",level:4},{value:"Procedure",id:"procedure-3",level:4},{value:"Check Whether Cloud-Init Has Been Installed",id:"check-whether-cloud-init-has-been-installed",level:4},{value:"(Recommended) Install Cloud-Init Using the Official Installation Package",id:"recommended-install-cloud-init-using-the-official-installation-package",level:4},{value:"Install Cloud-Init Using the Official Source Code Package and pip",id:"install-cloud-init-using-the-official-source-code-package-and-pip",level:4},{value:"Install Cloud-Init Using the Official GitHub Source Code",id:"install-cloud-init-using-the-official-github-source-code",level:4},{value:"(Optional) Installing the One-Click Password Reset Plug-in_Image Management Service",id:"optional-installing-the-one-click-password-reset-plug-in_image-management-service",level:2},{value:"Procedure",id:"procedure-4",level:4},{value:"Configuring NetworkManager",id:"configuring-networkmanager",level:2},{value:"Red Hat, Oracle, CentOS 6.x, CentOS 7.x, EulerOS 2.x, Fedora 22, or Later",id:"red-hat-oracle-centos-6x-centos-7x-euleros-2x-fedora-22-or-later",level:4},{value:"Debian 9.0 or Later",id:"debian-90-or-later",level:4},{value:"Ubuntu 14 or Later",id:"ubuntu-14-or-later",level:4},{value:"SUSE 11 SP3 and openSUSE 13 or Later",id:"suse-11-sp3-and-opensuse-13-or-later",level:4},{value:"Step 4: Obtaining the Image File_Image Management Service",id:"step-4-obtaining-the-image-file_image-management-service",level:2},{value:"Step 5: Registering the Image File as a Private Image",id:"step-5-registering-the-image-file-as-a-private-image",level:2},{value:"Constraints",id:"constraints",level:4},{value:"Procedure",id:"procedure-5",level:4}];function a(e){const n={a:"a",br:"br",code:"code",em:"em",h1:"h1",h2:"h2",h4:"h4",img:"img",li:"li",ol:"ol",p:"p",strong:"strong",ul:"ul",...(0,t.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.h1,{id:"creating-a-linux-image-using-virtualbox-and-an-iso-file",children:"Creating a Linux Image Using VirtualBox and an ISO File"}),"\n",(0,s.jsx)(n.h2,{id:"introduction",children:"Introduction"}),"\n",(0,s.jsx)(n.h4,{id:"virtualbox",children:"VirtualBox"}),"\n",(0,s.jsx)(n.p,{children:"VirtualBox is free, open-source virtualization software. It was first offered by InnoTek GmbH from Germany and re-branded as Oracle VM VirtualBox when InnoTek was acquired by Oracle Corporation."}),"\n",(0,s.jsxs)(n.p,{children:["For more information about VirtualBox, visit the Oracle official website. Click ",(0,s.jsx)(n.a,{href:"https://www.virtualbox.org/wiki/Guest_OSes",children:"here"})," to see the guest OSs that can work with VirtualBox."]}),"\n",(0,s.jsx)(n.h4,{id:"scenarios",children:"Scenarios"}),"\n",(0,s.jsx)(n.p,{children:"You can use a 32-bit or 64-bit Linux guest OS provided by VirtualBox to create an image file in VHD format."}),"\n",(0,s.jsx)(n.h4,{id:"advantages",children:"Advantages"}),"\n",(0,s.jsx)(n.p,{children:"You can customize Linux image files."}),"\n",(0,s.jsx)(n.h4,{id:"tools-and-costs",children:"Tools and Costs"}),"\n",(0,s.jsx)(n.h4,{id:"image-creation-process",children:"Image Creation Process"}),"\n",(0,s.jsx)(n.p,{children:"The following figure shows how to use VirtualBox to create an image from an ISO file."}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Figure 1"})," Image creation process",(0,s.jsx)(n.br,{}),"\n",(0,s.jsx)(n.img,{src:"https://support.huaweicloud.com/intl/en-us/bestpractice-ims/en-us_image_0200645302.png",alt:""})]}),"\n",(0,s.jsx)(n.h2,{id:"step-1-installing-virtualbox",children:"Step 1: Installing VirtualBox"}),"\n",(0,s.jsx)(n.h4,{id:"preparations",children:"Preparations"}),"\n",(0,s.jsx)(n.p,{children:"The host where VirtualBox is to be installed must meet the following requirements:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"A 64-bit Windows OS (recommended)."}),"\n",(0,s.jsx)(n.li,{children:"At least 4 GB of memory and a dual-core processor. For example, the host specifications can be 8U16G."}),"\n",(0,s.jsx)(n.li,{children:"At least 20 GB of available disk space."}),"\n",(0,s.jsxs)(n.li,{children:["Hardware virtualization (Intel VT-x or AMD-V). For how to enable this, see ",(0,s.jsx)(n.a,{href:"#ims_bp_0017__section1503794314311",children:"Host CPU Settings (Hardware Virtualization)"}),"."]}),"\n"]}),"\n",(0,s.jsx)(n.h4,{id:"host-cpu-settings-hardware-virtualization",children:"Host CPU Settings (Hardware Virtualization)"}),"\n",(0,s.jsx)(n.p,{children:"For an Intel host, perform the following operations to enable hardware virtualization:"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:"https://support.huaweicloud.com/intl/en-us/bestpractice-ims/public_sys-resources/note_3.0-en-us.png",alt:""})}),"\n",(0,s.jsx)(n.p,{children:"The operations may differ depending on the CPU type. You can do it as prompted."}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"During the host startup, press the BIOS key set by the manufacturer to access the BIOS."}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["Choose ",(0,s.jsx)(n.strong,{children:"Configuration"})," > ",(0,s.jsx)(n.strong,{children:"Intel Virtual Technology"}),", and press ",(0,s.jsx)(n.strong,{children:"Enter"}),"."]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["Select ",(0,s.jsx)(n.strong,{children:"Enabled"})," and press ",(0,s.jsx)(n.strong,{children:"Enter"}),". The value of ",(0,s.jsx)(n.strong,{children:"Intel Virtual Technology"})," will become ",(0,s.jsx)(n.strong,{children:"Enabled"}),"."]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["Press ",(0,s.jsx)(n.strong,{children:"F10"})," to save the settings and exit."]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Figure 1"})," Enabling hardware virtualization",(0,s.jsx)(n.br,{}),"\n",(0,s.jsx)(n.img,{src:"https://support.huaweicloud.com/intl/en-us/bestpractice-ims/en-us_image_0107215471.png",alt:""})]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h4,{id:"procedure",children:"Procedure"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Download the VirtualBox installation package. VirtualBox-5.2.0 is used as an example."}),"\n",(0,s.jsxs)(n.p,{children:["Download it from ",(0,s.jsx)(n.a,{href:"https://www.virtualbox.org/wiki/Downloads",children:"https://www.virtualbox.org/wiki/Downloads"}),"."]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["Decompress the package. Right-click ",(0,s.jsx)(n.strong,{children:"VirtualBox-5.2.0-118431-Win.exe"}),", choose ",(0,s.jsx)(n.strong,{children:"Run as administrator"}),", and click ",(0,s.jsx)(n.strong,{children:"Next"}),"."]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Figure 2"})," Installing VirtualBox",(0,s.jsx)(n.br,{}),"\n",(0,s.jsx)(n.img,{src:"https://support.huaweicloud.com/intl/en-us/bestpractice-ims/en-us_image_0107215473.png",alt:""})]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["Select the VirtualBox installation path and click ",(0,s.jsx)(n.strong,{children:"Next"}),"."]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Figure 3"})," Selecting an installation path",(0,s.jsx)(n.br,{}),"\n",(0,s.jsx)(n.img,{src:"https://support.huaweicloud.com/intl/en-us/bestpractice-ims/en-us_image_0107215475.png",alt:""})]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["Personalize the settings and click ",(0,s.jsx)(n.strong,{children:"Next"}),"."]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Figure 4"})," Personalized settings",(0,s.jsx)(n.br,{}),"\n",(0,s.jsx)(n.img,{src:"https://support.huaweicloud.com/intl/en-us/bestpractice-ims/en-us_image_0107215477.png",alt:""})]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["Click ",(0,s.jsx)(n.strong,{children:"Finish"}),"."]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"step-2-creating-a-vm-and-installing-an-os",children:"Step 2: Creating a VM and Installing an OS"}),"\n",(0,s.jsx)(n.h2,{id:"creating-an-empty-vm",children:"Creating an Empty VM"}),"\n",(0,s.jsx)(n.h4,{id:"prerequisites",children:"Prerequisites"}),"\n",(0,s.jsx)(n.p,{children:"VirtualBox has been installed."}),"\n",(0,s.jsx)(n.h4,{id:"procedure-1",children:"Procedure"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["Open VirtualBox and click ",(0,s.jsx)(n.strong,{children:"New"}),". In the displayed ",(0,s.jsx)(n.strong,{children:"Create Virtual Machine"})," dialog box, enter a VM name, select an OS type and version, and click ",(0,s.jsx)(n.strong,{children:"Next"}),"."]}),"\n",(0,s.jsxs)(n.p,{children:["Take Ubuntu as an example. The type must be ",(0,s.jsx)(n.strong,{children:"Linux"}),"."]}),"\n",(0,s.jsx)(n.p,{children:"Ensure that the selected version is the same as that of the OS you want to install on the VM."}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Figure 1"})," Creating a VM",(0,s.jsx)(n.br,{}),"\n",(0,s.jsx)(n.img,{src:"https://support.huaweicloud.com/intl/en-us/bestpractice-ims/en-us_image_0268280658.png",alt:""})]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["In the ",(0,s.jsx)(n.strong,{children:"Memory size"})," dialog box, set a value and click ",(0,s.jsx)(n.strong,{children:"Next"}),"."]}),"\n",(0,s.jsx)(n.p,{children:"You can reference the VM specifications or official OS requirements. The minimum value is 256 MB. You can set the memory size to 512 MB as an example."}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Figure 2"})," Setting the memory size",(0,s.jsx)(n.br,{}),"\n",(0,s.jsx)(n.img,{src:"https://support.huaweicloud.com/intl/en-us/bestpractice-ims/en-us_image_0268284967.png",alt:""})]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["In the ",(0,s.jsx)(n.strong,{children:"Hard disk"})," dialog box, select ",(0,s.jsx)(n.strong,{children:"Create a virtual hard disk now"})," and click ",(0,s.jsx)(n.strong,{children:"Create"}),"."]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Figure 3"})," Creating a virtual hard disk",(0,s.jsx)(n.br,{}),"\n",(0,s.jsx)(n.img,{src:"https://support.huaweicloud.com/intl/en-us/bestpractice-ims/en-us_image_0268287010.png",alt:""})]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["In the ",(0,s.jsx)(n.strong,{children:"Hard disk file type"})," dialog box, select ",(0,s.jsx)(n.strong,{children:"VHD"})," and click ",(0,s.jsx)(n.strong,{children:"Next"}),"."]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Figure 4"})," Setting the hard disk file type",(0,s.jsx)(n.br,{}),"\n",(0,s.jsx)(n.img,{src:"https://support.huaweicloud.com/intl/en-us/bestpractice-ims/en-us_image_0268287244.png",alt:""})]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["In the ",(0,s.jsx)(n.strong,{children:"Storage on physical hard disk"})," dialog box, select ",(0,s.jsx)(n.strong,{children:"Dynamically allocated"})," and click ",(0,s.jsx)(n.strong,{children:"Next"}),"."]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Figure 5"})," Selecting the disk allocation mode",(0,s.jsx)(n.br,{}),"\n",(0,s.jsx)(n.img,{src:"https://support.huaweicloud.com/intl/en-us/bestpractice-ims/en-us_image_0268288436.png",alt:""})]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["In the ",(0,s.jsx)(n.strong,{children:"File location and size"})," dialog box, set the disk size and storage location."]}),"\n",(0,s.jsx)(n.p,{children:"For example, you can set the disk size to 20 GB."}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Figure 6"})," Setting the disk location and size",(0,s.jsx)(n.br,{}),"\n",(0,s.jsx)(n.img,{src:"https://support.huaweicloud.com/intl/en-us/bestpractice-ims/en-us_image_0268290676.png",alt:""})]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["Click ",(0,s.jsx)(n.strong,{children:"Create"}),"."]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"installing-a-linux-os-on-the-vm",children:"Installing a Linux OS on the VM"}),"\n",(0,s.jsx)(n.p,{children:"The procedure varies depending on the image file you use. This section uses Ubuntu 20.04 as an example to describe how to install a Linux OS on the VM."}),"\n",(0,s.jsx)(n.h4,{id:"prerequisites-1",children:"Prerequisites"}),"\n",(0,s.jsxs)(n.p,{children:["You have obtained the ISO image file, for example, ",(0,s.jsx)(n.strong,{children:"Ubuntu-20.04-server.iso"}),"."]}),"\n",(0,s.jsx)(n.h4,{id:"procedure-2",children:"Procedure"}),"\n",(0,s.jsx)(n.p,{children:"Use the ISO file to install Linux for the empty VM."}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["In VirtualBox Manager, select the new VM and click ",(0,s.jsx)(n.strong,{children:"Settings"}),"."]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Figure 1"})," Setting the VM",(0,s.jsx)(n.br,{}),"\n",(0,s.jsx)(n.img,{src:"https://support.huaweicloud.com/intl/en-us/bestpractice-ims/en-us_image_0268393798.png",alt:""})]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["Choose ",(0,s.jsx)(n.strong,{children:"Storage"})," > ",(0,s.jsx)(n.strong,{children:"Empty"}),", click ",(0,s.jsx)(n.img,{src:"https://support.huaweicloud.com/intl/en-us/bestpractice-ims/en-us_image_0268393752.png",alt:""})," in the ",(0,s.jsx)(n.strong,{children:"Attributes"})," area, and select the ISO image file ",(0,s.jsx)(n.strong,{children:"Ubuntu-20.04-server.iso"}),"."]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Figure 2"})," Selecting the ISO file to be mounted",(0,s.jsx)(n.br,{}),"\n",(0,s.jsx)(n.img,{src:"https://support.huaweicloud.com/intl/en-us/bestpractice-ims/en-us_image_0268393846.png",alt:""})]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Figure 3"})," Mounted ISO file",(0,s.jsx)(n.br,{}),"\n",(0,s.jsx)(n.img,{src:"https://support.huaweicloud.com/intl/en-us/bestpractice-ims/en-us_image_0000001457709502.png",alt:""})]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["Click ",(0,s.jsx)(n.strong,{children:"OK"}),"."]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["In VirtualBox Manager, select the new VM and click ",(0,s.jsx)(n.strong,{children:"Start"}),"."]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Figure 4"})," Starting the VM",(0,s.jsx)(n.br,{}),"\n",(0,s.jsx)(n.img,{src:"https://support.huaweicloud.com/intl/en-us/bestpractice-ims/en-us_image_0268337032.png",alt:""})]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Install the OS."}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["Select ",(0,s.jsx)(n.strong,{children:"English"})," and press ",(0,s.jsx)(n.strong,{children:"Enter"}),"."]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:"https://support.huaweicloud.com/intl/en-us/bestpractice-ims/en-us_image_0000001514305585.png",alt:""})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["Select ",(0,s.jsx)(n.strong,{children:"Continue without updating"}),"."]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:"https://support.huaweicloud.com/intl/en-us/bestpractice-ims/en-us_image_0000001464149800.png",alt:""})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["Retain the default settings for the keyboard. Select ",(0,s.jsx)(n.strong,{children:"Done"})]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:"https://support.huaweicloud.com/intl/en-us/bestpractice-ims/en-us_image_0000001514311097.png",alt:""})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["Retain the default settings for the installation base. Select ",(0,s.jsx)(n.strong,{children:"Done"}),"."]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:"https://support.huaweicloud.com/intl/en-us/bestpractice-ims/en-us_image_0000001514670405.png",alt:""})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["Retain the default settings for the network. Select ",(0,s.jsx)(n.strong,{children:"Done"}),"."]}),"\n",(0,s.jsx)(n.p,{children:"The installation program will automatically identify the IP address. If the network cannot be found, the installation program can still continue and you can configure the network again after the installation is complete."}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:"https://support.huaweicloud.com/intl/en-us/bestpractice-ims/en-us_image_0000001463836772.png",alt:""})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["Retain the default settings for the proxy. Select ",(0,s.jsx)(n.strong,{children:"Done"}),"."]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:"https://support.huaweicloud.com/intl/en-us/bestpractice-ims/en-us_image_0000001514558429.png",alt:""})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["Retain the default settings for the software source. Select ",(0,s.jsx)(n.strong,{children:"Done"}),"."]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:"https://support.huaweicloud.com/intl/en-us/bestpractice-ims/en-us_image_0000001463840256.png",alt:""})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["Retain the default settings for disk partitioning (use an entire disk and set up this disk as an LVM group). Select ",(0,s.jsx)(n.strong,{children:"Done"}),"."]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:"https://support.huaweicloud.com/intl/en-us/bestpractice-ims/en-us_image_0000001514561077.png",alt:""})}),"\n",(0,s.jsxs)(n.p,{children:["The file system information will be displayed. Check it and select ",(0,s.jsx)(n.strong,{children:"Done"}),"."]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:"https://support.huaweicloud.com/intl/en-us/bestpractice-ims/en-us_image_0000001463841764.png",alt:""})}),"\n",(0,s.jsxs)(n.p,{children:["Confirm the destructive action and select ",(0,s.jsx)(n.strong,{children:"Continue"}),"."]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:"https://support.huaweicloud.com/intl/en-us/bestpractice-ims/en-us_image_0000001514681605.png",alt:""})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["Configure the server name, username, and password. Select ",(0,s.jsx)(n.strong,{children:"Done"}),"."]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Your name"}),": It is not a username for logging in to the server. You can consider it as server description."]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Your Server's name"}),": It is a unique server name on the same network. The name cannot contain uppercase letters."]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Pick a username"}),": It is a username for logging in to the server. If you forget it or its password, you will not be allowed to log in to the server."]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Choose a password"}),": It is the password for logging in to the server."]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Confirm your password"}),": Enter your password again."]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:"https://support.huaweicloud.com/intl/en-us/bestpractice-ims/en-us_image_0000001464161876.png",alt:""})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Install SSH so that you can remotely connect to the Linux server."}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:["Select ",(0,s.jsx)(n.strong,{children:"Install OpenSSH server"}),". Then, press ",(0,s.jsx)(n.strong,{children:"Tab"})," to select ",(0,s.jsx)(n.strong,{children:"Done"}),"."]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:"https://support.huaweicloud.com/intl/en-us/bestpractice-ims/en-us_image_0000001514587325.png",alt:""})}),"\n",(0,s.jsxs)(n.ol,{start:"11",children:["\n",(0,s.jsxs)(n.li,{children:["Select ",(0,s.jsx)(n.strong,{children:"Done"})," to start the OS installation."]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:"https://support.huaweicloud.com/intl/en-us/bestpractice-ims/en-us_image_0000001464002560.png",alt:""})}),"\n",(0,s.jsxs)(n.ol,{start:"12",children:["\n",(0,s.jsxs)(n.li,{children:["After the installation is complete, select ",(0,s.jsx)(n.strong,{children:"Reboot"})," to restart the system."]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:"https://support.huaweicloud.com/intl/en-us/bestpractice-ims/en-us_image_0000001464031938.png",alt:""})}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"step-3-configuring-the-vm",children:"Step 3: Configuring the VM"}),"\n",(0,s.jsx)(n.h2,{id:"installing-drivers-and-changing-the-disk-identifiers-to-the-uuid-format",children:"Installing Drivers and Changing the Disk Identifiers to the UUID Format"}),"\n",(0,s.jsx)(n.p,{children:"To ensure that the ECSs created from the image support both Xen and KVM virtualization, install Native Xen and KVM drivers and change the disk identifiers to the UUID format for the VM which is used as the image source."}),"\n",(0,s.jsxs)(n.p,{children:["This section describes how to perform these operations on a Linux VM that runs Ubuntu 20.04. For other OSs, see ",(0,s.jsx)(n.a,{href:"https://support.huaweicloud.com/intl/en-us/usermanual-ims/en-us_topic_0047501133.html",children:"Optimization Process (Linux)"}),"."]}),"\n",(0,s.jsx)(n.h4,{id:"install-native-xen-and-kvm-drivers",children:"Install Native Xen and KVM Drivers"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["Run the following command to open the ",(0,s.jsx)(n.strong,{children:"modules"})," file:"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"vi /etc/initramfs-tools/modules"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["Press ",(0,s.jsx)(n.strong,{children:"i"})," to enter the editing mode and add the native Xen (xen-pv) and KVM (virtio) drivers to the ",(0,s.jsx)(n.strong,{children:"/etc/initramfs-tools/modules"})," file (the format depends on the OS requirements)."]}),"\n",(0,s.jsx)(n.p,{children:"``\n[root@CTU10000xxxxx ~]#vi /etc/initramfs-tools/modules\n..."}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h1,{id:"examples",children:"Examples:"}),"\n",(0,s.jsx)(n.h1,{id:""}),"\n",(0,s.jsx)(n.h1,{id:"raid1",children:"raid1"}),"\n",(0,s.jsx)(n.h1,{id:"sd_mod",children:"sd_mOd"}),"\n",(0,s.jsxs)(n.p,{children:["xen-blkfront\nxen-netfront\nvirtio_blk\nvirtio_scsi\nvirtio_net\nvirtio_pci\nvirtio_ring\nvirtio",(0,s.jsx)(n.br,{}),"\n","``"]}),"\n",(0,s.jsxs)(n.ol,{start:"3",children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["Press ",(0,s.jsx)(n.strong,{children:"Esc"}),", enter ",(0,s.jsx)(n.strong,{children:":wq"}),", and press ",(0,s.jsx)(n.strong,{children:"Enter"})," to save the settings and exit the vi editor."]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Run the following command to generate initrd again:"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"update-initramfs -u"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Run the following commands to check whether native Xen and KVM drivers have been installed:"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"lsinitramfs /boot/initrd.img-`uname -r` |grep xen"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"lsinitramfs /boot/initrd.img-`uname -r` |grep virtio"})}),"\n",(0,s.jsxs)(n.p,{children:["``\n[root@ CTU10000xxxxx home]# lsinitramfs /boot/initrd.img-",(0,s.jsx)(n.code,{children:"uname -r"})," |grep xen\nlib/modules/3.5.0-23-generic/kernel/drivers/net/ethernet/qlogic/netxen\nlib/modules/3.5.0-23-generic/kernel/drivers/net/ethernet/qlogic/netxen/netxen_nic.ko\nlib/modules/3.5.0-23-generic/kernel/drivers/net/xen-netback\nlib/modules/3.5.0-23-generic/kernel/drivers/net/xen-netback/xen-netback.ko\nlib/modules/3.5.0-23-generic/kernel/drivers/block/xen-blkback\nlib/modules/3.5.0-23-generic/kernel/drivers/block/xen-blkback/xen-blkback.ko"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:["[root@ CTU10000xxxxx home]# lsinitramfs /boot/initrd.img-",(0,s.jsx)(n.code,{children:"uname -r"})," |grep virtio\nlib/modules/3.5.0-23-generic/kernel/drivers/scsi/virtio_scsi.ko\n``"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:"https://support.huaweicloud.com/intl/en-us/bestpractice-ims/public_sys-resources/note_3.0-en-us.png",alt:""})}),"\n",(0,s.jsxs)(n.p,{children:["If you add built-in drivers to the initrd or initramfs file, the VM will not be affected. This makes it easy to modify the drivers. However, the drivers cannot be shown by running the ",(0,s.jsx)(n.strong,{children:"lsinitrd"})," command. You can run the following commands to check whether the drivers are built-in ones in the kernel:"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.code,{children:"[root@ CTU10000xxxxx home]# cat /boot/config-`uname -r` | grep CONFIG_VIRTIO | grep y CONFIG_VIRTIO_BLK=y CONFIG_VIRTIO_NET=y CONFIG_VIRTIO=y CONFIG_VIRTIO_RING=y CONFIG_VIRTIO_PCI=y CONFIG_VIRTIO_MMIO_CMDLINE_DEVICES=y [root@ CTU10000xxxxx home]# cat /boot/config-`uname -r` | grep CONFIG_XEN | grep y CONFIG_XEN_BLKDEV_FRONTEND=y CONFIG_XEN_NETDEV_FRONTEND=y"})}),"\n",(0,s.jsx)(n.h4,{id:"change-the-disk-identifier-in-the-grub-configuration-file-to-the-uuid-format",children:"Change the Disk Identifier in the GRUB Configuration File to the UUID Format"}),"\n",(0,s.jsxs)(n.p,{children:["Take Ubuntu 20.04 as an example. Run ",(0,s.jsx)(n.strong,{children:"blkid"})," to obtain the UUID of the root partition. Modify the ",(0,s.jsx)(n.strong,{children:"/boot/grub/grub.cfg"})," file and use the UUID of the root partition to configure the boot item. If the root partition already uses UUID, no modification is required. The procedure is as follows:"]}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["Log in to the newly created VM as user ",(0,s.jsx)(n.strong,{children:"root"}),"."]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Run the following command to query all types of mounted file systems and their device UUIDs:"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"blkid"})}),"\n",(0,s.jsx)(n.p,{children:"The following information is displayed:"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.code,{children:'/dev/xvda1: UUID="ec51d860-34bf-4374-ad46-a0c3e337fd34" TYPE="ext3" /dev/xvda5: UUID="7a44a9ce-9281-4740-b95f-c8de33ae5c11" TYPE="swap"'})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["Run the following command to query the ",(0,s.jsx)(n.strong,{children:"grub.cfg"})," file:"]}),"\n",(0,s.jsxs)(n.p,{children:["**cat /boot/grub/grub.**",(0,s.jsx)(n.strong,{children:"cfg"})]}),"\n",(0,s.jsx)(n.p,{children:"The following information is displayed:"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.code,{children:"......menuentry 'Ubuntu Linux, with Linux 3.13.0-24-generic' --class ubuntu --class gnu-linux --class gnu --class os --unrestricted $menuentry_id_option 'gnulinux-3.13.0-24-generic-advanced-ec51d860-34bf-4374-ad46-a0c3e337fd34' { recordfail load_video gfxmode $linux_gfx_mode insmod gzio insmod part_msdos insmod ext2 if [ x$feature_platform_search_hint = xy ]; then search --no-floppy --fs-uuid --set=root ec51d860-34bf-4374-ad46-a0c3e337fd34 else search --no-floppy --fs-uuid --set=root ec51d860-34bf-4374-ad46-a0c3e337fd34 fi echo 'Loading Linux 3.13.0-24-generic ...' linux /boot/vmlinuz-3.13.0-24-generic root=/dev/xvda1 ro  echo 'Loading initial ramdisk ...' initrd /boot/initrd.img-3.13.0-24-generic  }"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["Check whether the ",(0,s.jsx)(n.strong,{children:"/boot/grub/grub.cfg"})," configuration file contains ",(0,s.jsx)(n.strong,{children:"root=/dev/xvda1"})," or ",(0,s.jsx)(n.strong,{children:"root=UUID=ec51d860-34bf-4374-ad46-a0c3e337fd34"}),"."]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["If ",(0,s.jsx)(n.strong,{children:"root=UUID=ec51d860-34bf-4374-ad46-a0c3e337fd34"})," is contained, the root partition is in the UUID format and no further action is required."]}),"\n",(0,s.jsxs)(n.li,{children:["If ",(0,s.jsx)(n.strong,{children:"root=/dev/xvda1"})," is contained, the root partition is represented by a device name. Go to step ",(0,s.jsx)(n.a,{href:"#ims_bp_0022__en-us_topic_0106036281_lf7085be4afa540f3b52640d8d9157c9a",children:"5"}),"."]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["Obtain the UUID of the root partition based on ",(0,s.jsx)(n.strong,{children:"root=/dev/xvda1"})," and information obtained by running the ",(0,s.jsx)(n.strong,{children:"blkid"})," command."]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["Run the following command to open the ",(0,s.jsx)(n.strong,{children:"grub.cfg"})," file:"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"vi /boot/grub/grub.cfg"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["Press ",(0,s.jsx)(n.strong,{children:"i"})," to enter the editing mode. Change the identifier of the root partition to the UUID format. For example, change ",(0,s.jsx)(n.strong,{children:"root=/dev/xvda1"})," to ",(0,s.jsx)(n.strong,{children:"root=UUID=ec51d860-34bf-4374-ad46-a0c3e337fd34"}),"."]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["Press ",(0,s.jsx)(n.strong,{children:"Esc"}),", enter ",(0,s.jsx)(n.strong,{children:":wq"}),", and press ",(0,s.jsx)(n.strong,{children:"Enter"})," to save the settings and exit the vi editor."]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Run the following command to verify the change:"}),"\n",(0,s.jsxs)(n.p,{children:["**cat /boot/grub/grub.**",(0,s.jsx)(n.strong,{children:"cfg"})]}),"\n",(0,s.jsx)(n.p,{children:"The change is successful if information similar to the following is displayed:"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.code,{children:"......menuentry 'Ubuntu Linux, with Linux 3.13.0-24-generic' --class ubuntu --class gnu-linux --class gnu --class os --unrestricted $menuentry_id_option 'gnulinux-3.13.0-24-generic-advanced-ec51d860-34bf-4374-ad46-a0c3e337fd34' { recordfail load_video gfxmode $linux_gfx_mode insmod gzio insmod part_msdos insmod ext2 if [ x$feature_platform_search_hint = xy ]; then search --no-floppy --fs-uuid --set=root ec51d860-34bf-4374-ad46-a0c3e337fd34 else search --no-floppy --fs-uuid --set=root ec51d860-34bf-4374-ad46-a0c3e337fd34 fi echo 'Loading Linux 3.13.0-24-generic ...' linux /boot/vmlinuz-3.13.0-24-generic root=UUID=ec51d860-34bf-4374-ad46-a0c3e337fd34 ro echo 'Loading initial ramdisk ...' initrd /boot/initrd.img-3.13.0-24-generic }"})}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h4,{id:"change-the-disk-identifiers-in-the-fstab-file-to-the-uuid-format",children:"Change the Disk Identifiers in the fstab File to the UUID Format"}),"\n",(0,s.jsxs)(n.p,{children:["Take Ubuntu 20.04 as an example. Run ",(0,s.jsx)(n.strong,{children:"blkid"})," to obtain the UUIDs of all partitions. Modify the ",(0,s.jsx)(n.strong,{children:"/etc/fstab"})," file and use the partition UUIDs to configure automatic partition mounting."]}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Run the following command to query all types of mounted file systems and their device UUIDs:"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"blkid"})}),"\n",(0,s.jsx)(n.p,{children:"The following information is displayed:"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.code,{children:'/dev/xvda2: UUID="4eb40294-4c6f-4384-bbb6-b8795bbb1130" TYPE="xfs"   /dev/xvda1: UUID="2de37c6b-2648-43b4-a4f5-40162154e135" TYPE="swap"'})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["Run the following command to query the ",(0,s.jsx)(n.strong,{children:"fstab"})," file:"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"cat /etc/fstab"})}),"\n",(0,s.jsx)(n.p,{children:"The following information is displayed:"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.code,{children:"[root@CTU1000028010 ~]# cat /etc/fstab   /dev/xvda2  /       xfs     defaults    0 0  /dev/xvda1  swap    swap    defaults    0 0     "})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["Check whether the disk identifiers in the ",(0,s.jsx)(n.strong,{children:"fstab"})," file are device names or UUIDs."]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"If they are UUIDs, no further action is required."}),"\n",(0,s.jsxs)(n.li,{children:["If they are device names, go to step ",(0,s.jsx)(n.a,{href:"#ims_bp_0022__en-us_topic_0106036281_li63646666154817",children:"4"}),"."]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["Run the following command to open the ",(0,s.jsx)(n.strong,{children:"fstab"})," file:"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"vi /etc/fstab"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["Press ",(0,s.jsx)(n.strong,{children:"i"})," to enter the editing mode and change the disk identifiers to the UUID format."]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["Press ",(0,s.jsx)(n.strong,{children:"Esc"}),", enter ",(0,s.jsx)(n.strong,{children:":wq"}),", and press ",(0,s.jsx)(n.strong,{children:"Enter"})," to save the settings and exit the vi editor."]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"installing-cloud-init",children:"Installing Cloud-Init"}),"\n",(0,s.jsx)(n.h4,{id:"scenarios-1",children:"Scenarios"}),"\n",(0,s.jsx)(n.p,{children:"To ensure that you can use the user data injection function to inject initial custom information into ECSs created from a private image (such as setting the ECS login password), install Cloud-Init on the ECS used to create the image."}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"You need to download Cloud-Init from its official website. Therefore, you must bind an EIP to the ECS."}),"\n",(0,s.jsx)(n.li,{children:"If Cloud-Init is not installed, you cannot configure an ECS. As a result, you can only use the password in the image file to log in to the created ECSs."}),"\n",(0,s.jsx)(n.li,{children:"By default, ECSs created from a public image have Cloud-Init installed. You do not need to install or configure Cloud-Init on such ECSs."}),"\n",(0,s.jsxs)(n.li,{children:["For ECSs created using an external image file, install and configure Cloud-Init by performing the operations in this section. For how to configure Cloud-Init, see ",(0,s.jsx)(n.a,{href:"https://support.huaweicloud.com/intl/en-us/bestpractice-ims/ims_bp_0024.html#ims_bp_0024",children:"Configuring Cloud-Init"}),"."]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:"https://support.huaweicloud.com/intl/en-us/bestpractice-ims/public_sys-resources/note_3.0-en-us.png",alt:""})}),"\n",(0,s.jsx)(n.p,{children:"Cloud-Init is open-source software. If the installed version has security vulnerabilities, you are advised to upgrade it to the latest version."}),"\n",(0,s.jsx)(n.h4,{id:"prerequisites-2",children:"Prerequisites"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"An EIP has been bound to the ECS."}),"\n",(0,s.jsx)(n.li,{children:"You have logged in to the ECS."}),"\n",(0,s.jsx)(n.li,{children:"The IP address obtaining mode of the ECS is DHCP."}),"\n"]}),"\n",(0,s.jsx)(n.h4,{id:"procedure-3",children:"Procedure"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Check whether Cloud-Init has been installed."}),"\n",(0,s.jsxs)(n.p,{children:["For details, see ",(0,s.jsx)(n.a,{href:"#ims_bp_0023__en-us_topic_0030730603_section57525650153449",children:"Check Whether Cloud-Init Has Been Installed"}),"."]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Install Cloud-Init."}),"\n",(0,s.jsxs)(n.p,{children:["You can install Cloud-Init in any of the following ways: ",(0,s.jsx)(n.a,{href:"#ims_bp_0023__en-us_topic_0030730603_section9013470154018",children:"(Recommended) Install Cloud-Init Using the Official Installation Package"}),", ",(0,s.jsx)(n.a,{href:"#ims_bp_0023__en-us_topic_0030730603_section124220553610",children:"Install Cloud-Init Using the Official Source Code Package and pip"}),", and ",(0,s.jsx)(n.a,{href:"#ims_bp_0023__en-us_topic_0030730603_section14939636151511",children:"Install Cloud-Init Using the Official GitHub Source Code"}),"."]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h4,{id:"check-whether-cloud-init-has-been-installed",children:"Check Whether Cloud-Init Has Been Installed"}),"\n",(0,s.jsx)(n.p,{children:"Perform the operations provided here to check whether Cloud-Init has been installed. The methods of checking whether Cloud-Init is installed vary depending on the OSs."}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"If you are in a Python 3 environment, run the following command to check whether Cloud-Init is installed (Ubuntu 22.0.4 is used as an example):"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"which cloud-init"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"If information similar to the following is displayed, Cloud-Init has been installed:"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.code,{children:"/usr/bin/cloud-init"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"If information similar to the following is displayed, Cloud-Init is not installed:"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.code,{children:"/usr/bin/which: no cloud-init in (/usr/local/bin:/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin)"})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"If you are in a Python 2 environment, run the following command to check whether Cloud-Init is installed (CentOS 6 is used as an example):"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"which cloud-init"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"If information similar to the following is displayed, Cloud-Init has been installed:"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.code,{children:"cloud-init-0.7.5-10.el6.centos.2.x86_64"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"If no information is returned, Cloud-Init is not installed."}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:"https://support.huaweicloud.com/intl/en-us/bestpractice-ims/public_sys-resources/note_3.0-en-us.png",alt:""})}),"\n",(0,s.jsxs)(n.p,{children:["To confirm Cloud-Init is really not installed, you are advised to run ",(0,s.jsx)(n.strong,{children:"rpm -qa |grep cloud-init"})," to check again. If either of ",(0,s.jsx)(n.strong,{children:"which cloud-init"})," and ",(0,s.jsx)(n.strong,{children:"rpm -qa |grep cloud-init"})," shows that Cloud-Init has been installed, Cloud-Init is installed."]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"If Cloud-Init has been installed, perform the following operations:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Check whether to use the SSH certificate in the ECS OS. If the certificate is no longer used, delete it."}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["If the certificate is stored in a directory of user ",(0,s.jsx)(n.strong,{children:"root"}),", for example, ",(0,s.jsx)(n.em,{children:"/$path/$to/$root"}),(0,s.jsx)(n.strong,{children:"/.ssh/authorized_keys"}),", run the following commands:"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"cd /root/.ssh"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"rm authorized_keys"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["If the certificate is not stored in a directory of user ",(0,s.jsx)(n.strong,{children:"root"}),", for example, ",(0,s.jsx)(n.em,{children:"/$path/$to/$none-root"}),(0,s.jsx)(n.strong,{children:"/.ssh/authorized_keys"}),", run the following commands:"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"cd /home/centos/.ssh"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"rm authorized_keys"})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Run the following command to delete the cache generated by Cloud-Init and ensure that the ECS created from the private image can be logged in by using the certificate:"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"sudo rm -rf /var/lib/cloud/*"})}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:"https://support.huaweicloud.com/intl/en-us/bestpractice-ims/public_sys-resources/note_3.0-en-us.png",alt:""})}),"\n",(0,s.jsx)(n.p,{children:"Do not restart the ECS after performing the configuration. Otherwise, you need to configure it again."}),"\n",(0,s.jsx)(n.h4,{id:"recommended-install-cloud-init-using-the-official-installation-package",children:"(Recommended) Install Cloud-Init Using the Official Installation Package"}),"\n",(0,s.jsxs)(n.p,{children:["The method of installing Cloud-Init on an ECS varies depending on the OS. Perform the installation operations as user ",(0,s.jsx)(n.strong,{children:"root"}),"."]}),"\n",(0,s.jsx)(n.p,{children:"The following describes how to install Cloud-Init on an ECS running SUSE Linux, CentOS, Fedora, Debian, and Ubuntu. For other OS types, install the required type of Cloud-Init. For example, you need to install coreos-cloudinit on ECSs running CoreOS."}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"SUSE Linux"}),"\n",(0,s.jsx)(n.p,{children:"Paths for obtaining the Cloud-Init installation package for SUSE Linux"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.a,{href:"https://ftp5.gwdg.de/pub/opensuse/repositories/Cloud:/Tools",children:"https://ftp5.gwdg.de/pub/opensuse/repositories/Cloud:/Tools/"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.a,{href:"http://download.opensuse.org/repositories/Cloud:/Tools/",children:"http://download.opensuse.org/repositories/Cloud:/Tools/"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:"https://support.huaweicloud.com/intl/en-us/bestpractice-ims/public_sys-resources/note_3.0-en-us.png",alt:""})}),"\n",(0,s.jsx)(n.p,{children:"Select the required repo installation package in the provided paths."}),"\n",(0,s.jsx)(n.p,{children:"Take SUSE Enterprise Linux Server 12 as an example. Perform the following steps to install Cloud-Init:"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Log in to the ECS used to create a Linux private image."}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Run the following command to install the network installation source for SUSE Enterprise Linux Server 12:"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsxs)(n.strong,{children:["zypper ar ",(0,s.jsx)(n.a,{href:"https://ftp5.gwdg.de/pub/opensuse/repositories/Cloud:/Tools/SLE%5C_12%5C_SP3/Cloud:Tools.repo",children:"https://ftp5.gwdg.de/pub/opensuse/repositories/Cloud:/Tools/SLE\\_12\\_SP3/Cloud:Tools.repo"})]})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Run the following command to update the network installation source:"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"zypper refresh"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Run the following command to install Cloud-Init:"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"zypper install cloud-init"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Run the following commands to enable Cloud-Init to automatically start upon system boot:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"SUSE 11"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"chkconfig cloud-init-local on; chkconfig cloud-init on; chkconfig cloud-config on; chkconfig cloud-final on"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"service cloud-init-local status; service cloud-init status; service cloud-config status; service cloud-final status"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"SUSE 12 and openSUSE 12/13/42"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"systemctl enable cloud-init-local.service cloud-init.service cloud-config.service cloud-final.service"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"systemctl status cloud-init-local.service cloud-init.service cloud-config.service cloud-final.service"})}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:"https://support.huaweicloud.com/intl/en-us/bestpractice-ims/public_sys-resources/caution_3.0-en-us.png",alt:""})}),"\n",(0,s.jsx)(n.p,{children:"For SUSE and openSUSE, perform the following steps to disable dynamic change of the ECS name:"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["Run the following command to open the ",(0,s.jsx)(n.strong,{children:"dhcp"})," file using the vi editor:"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"vi"})," ",(0,s.jsx)(n.strong,{children:"etc/sysconfig/network/dhcp"})]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["Change the value of ",(0,s.jsx)(n.strong,{children:"DHCLIENT_SET_HOSTNAME"})," in the ",(0,s.jsx)(n.strong,{children:"dhcp"})," file to ",(0,s.jsx)(n.strong,{children:"no"}),"."]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"CentOS"})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.a,{href:"#ims_bp_0023__en-us_topic_0030730603_table859383892814",children:"Table 1"})," lists the Cloud-Init installation paths for CentOS. Select the required installation package from the following addresses."]}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Run the following commands to install Cloud-Init:"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"yum install"})," ",(0,s.jsx)(n.em,{children:"Cloud-Init installation package address"}),(0,s.jsx)(n.strong,{children:"/epel-release-"}),(0,s.jsx)(n.em,{children:"x-y"}),(0,s.jsx)(n.strong,{children:".noarch.rpm"})]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"yum install cloud-init"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:"https://support.huaweicloud.com/intl/en-us/bestpractice-ims/public_sys-resources/note_3.0-en-us.png",alt:""})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.em,{children:"Cloud-Init installation package address"})," indicates the address of the Cloud-Init epel-release installation package, and ",(0,s.jsx)(n.em,{children:"x-y"})," indicates the version of the Cloud-Init epel-release required by the current OS. Replace them with the actual values according to ",(0,s.jsx)(n.a,{href:"#ims_bp_0023__en-us_topic_0030730603_table859383892814",children:"Table 1"}),"."]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Take CentOS 6 64-bit as an example. If the version is 6.8, the command is as follows:"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsxs)(n.strong,{children:["yum install ",(0,s.jsx)(n.a,{href:"https://archives.fedoraproject.org/pub/archive/epel/6/x86%5C_64/epel-release-****6-8****.noarch.rpm",children:"https://archives.fedoraproject.org/pub/archive/epel/6/x86\\_64/epel-release-****6-8****.noarch.rpm"})]})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Take CentOS 7 64-bit as an example. If the version is 7.14, the command is as follows:"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsxs)(n.strong,{children:["yum install ",(0,s.jsx)(n.a,{href:"https://archives.fedoraproject.org/pub/epel/7/x86%5C_64/Packages/e/epel-release-****7-14****.noarch.rpm",children:"https://archives.fedoraproject.org/pub/epel/7/x86\\_64/Packages/e/epel-release-****7-14****.noarch.rpm"})]})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Run the following commands to enable Cloud-Init to automatically start upon system boot:"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"systemctl enable cloud-init-local.service cloud-init.service cloud-config.service cloud-final.service"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"systemctl status cloud-init-local.service cloud-init.service cloud-config.service cloud-final.service"})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Fedora"}),"\n",(0,s.jsxs)(n.p,{children:["Before installing Cloud-Init, ensure that the network installation source address has been configured for the OS by checking whether the ",(0,s.jsx)(n.strong,{children:"/etc/yum.repo.d/fedora.repo"})," file contains the installation source address of the software package. If the file does not contain the address, configure the address by following the instructions on the Fedora official website."]}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Run the following command to install Cloud-Init:"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"yum install cloud-init"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Run the following commands to enable Cloud-Init to automatically start upon system boot:"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"systemctl enable cloud-init-local.service cloud-init.service cloud-config.service cloud-final.service"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"systemctl status cloud-init-local.service cloud-init.service cloud-config.service cloud-final.service"})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Debian and Ubuntu"}),"\n",(0,s.jsxs)(n.p,{children:["Before installing Cloud-Init, ensure that the network installation source address has been configured for the OS by checking whether the ",(0,s.jsx)(n.strong,{children:"/etc/apt/sources.list"})," file contains the installation source address of the software package. If the file does not contain the address, configure the address by following the instructions on the Debian or Ubuntu official website."]}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Run the following commands to install Cloud-Init:"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"apt-get update"})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"apt-get install"})," ",(0,s.jsx)(n.strong,{children:"cloud-init"})]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Run the following commands to enable Cloud-Init to automatically start upon system boot:"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"systemctl enable cloud-init-local.service cloud-init.service cloud-config.service cloud-final.service"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"systemctl status cloud-init-local.service cloud-init.service cloud-config.service cloud-final.service"})}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Cloud-Init-23.2.2 is used as an example to describe how to install Cloud-Init on CentOS, Fedora, Ubuntu, Debian, and SUSE."})}),"\n",(0,s.jsxs)(n.p,{children:["Download the ",(0,s.jsx)(n.strong,{children:"cloud-init-23.2.2.tar.gz"})," source code package from ",(0,s.jsx)(n.a,{href:"https://launchpad.net/cloud-init/trunk/23.2.2/+download/cloud-init-23.2.2.tar.gz",children:"https://launchpad.net/cloud-init/trunk/23.2.2/+download/cloud-init-23.2.2.tar.gz"}),"."]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Centos 7/Fedora Server 36"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:"https://support.huaweicloud.com/intl/en-us/bestpractice-ims/public_sys-resources/notice_3.0-en-us.png",alt:""})}),"\n",(0,s.jsx)(n.p,{children:"Ensure that Python 3 has been installed."}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Check whether Cloud-Init has been installed. If any command output is displayed, Cloud-Init has been installed."}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.code,{children:"cloud-init -v"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Delete the cache directory of Cloud-Init."}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.code,{children:"rm -rf /var/lib/cloud/*"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Install dependency packages of Cloud-Init."}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.code,{children:"yum install python3-pip -y yum install python3-devel"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Download the Cloud-Init package."}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.code,{children:"wget https://launchpad.net/cloud-init/trunk/23.2.2/+download/cloud-init-23.2.2.tar.gz"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Decompress the Cloud-Init package."}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.code,{children:"tar -zxvf cloud-init-23.2.2.tar.gz"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["Go to the ",(0,s.jsx)(n.strong,{children:"cloud-init-23.2.2"})," directory and install dependent libraries:"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.code,{children:"cd cloud-init-23.2.2 pip3 install -r requirements.txt"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Install Cloud-Init."}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.code,{children:"python3 setup.py build python3 setup.py install --init-system systemd"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["(Optional) Diable Cloud-Init's network configuration capability by modifying the ",(0,s.jsx)(n.strong,{children:"/etc/cloud/cloud.cfg"})," file."]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.code,{children:"vi /etc/cloud/cloud.cfg"})}),"\n",(0,s.jsx)(n.p,{children:"Add the following content to the file:"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.code,{children:"network:   config: disabled"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Restart Cloud-Init and check its status."}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.code,{children:"systemctl restart cloud-init-local.service cloud-init.service cloud-config.service cloud-final.service systemctl status cloud-init-local.service cloud-init.service cloud-config.service cloud-final.service"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:"https://support.huaweicloud.com/intl/en-us/bestpractice-ims/en-us_image_0000001688060529.png",alt:""})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Enable Cloud-Init related services to automatically start upon system boot."}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.code,{children:"systemctl enable cloud-init-local.service cloud-init.service cloud-config.service cloud-final.service"})}),"\n",(0,s.jsxs)(n.ol,{start:"11",children:["\n",(0,s.jsx)(n.li,{children:"Check whether Cloud-Init is running properly."}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.code,{children:"cloud-init -v cloud-init init --local "})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:"https://support.huaweicloud.com/intl/en-us/bestpractice-ims/en-us_image_0000001639899816.png",alt:""})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Ubuntu 22.0.4/Debian 11"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:"https://support.huaweicloud.com/intl/en-us/bestpractice-ims/public_sys-resources/notice_3.0-en-us.png",alt:""})}),"\n",(0,s.jsx)(n.p,{children:"Ensure that Python 3 has been installed."}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Check and delete redundant Cloud-Init configuration files."}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.code,{children:"rm -rf /var/lib/cloud/* rm -f /var/log/cloud-init*"})}),"\n",(0,s.jsxs)(n.p,{children:["Delete all files except log-related configuration files from the ",(0,s.jsx)(n.strong,{children:"/etc/cloud/cloud.cfg.d/"})," directory."]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Update your package list and check whether Wget is installed. If it is not, install it."}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.code,{children:"sudo apt update sudo apt install wget "})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Install dependency packages."}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.code,{children:"apt-get install cloud-guest-utils -y apt-get install python3-pip -y apt-get install python3-devel"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Download the Cloud-Init package."}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.code,{children:"wget https://launchpad.net/cloud-init/trunk/23.2.2/+download/cloud-init-23.2.2.tar.gz"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Decompress the Cloud-Init package."}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.code,{children:"tar -zxvf cloud-init-23.2.2.tar.gz"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["Go to the ",(0,s.jsx)(n.strong,{children:"cloud-init"})," directory."]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.code,{children:"cd cloud-init-23.2.2"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Install dependent libraries."}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.code,{children:"pip3 install -r requirements.txt"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Install Cloud-Init."}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.code,{children:"python3 setup.py install"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"(Optional) Disable Cloud-Init's network configuration capability."}),"\n",(0,s.jsx)(n.p,{children:"You need to do so when the Cloud-Init version is 0.7.9 or later and you want to configure the network."}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:"https://support.huaweicloud.com/intl/en-us/bestpractice-ims/public_sys-resources/note_3.0-en-us.png",alt:""})}),"\n",(0,s.jsxs)(n.p,{children:["1. Open the ",(0,s.jsx)(n.strong,{children:"/etc/cloud/cloud.cfg"})," file."]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.code,{children:"vi /etc/cloud/cloud.cfg"})}),"\n",(0,s.jsxs)(n.p,{children:["2. Enter ",(0,s.jsx)(n.strong,{children:"i"})," and configure ",(0,s.jsx)(n.strong,{children:"network"}),". (If there is no such a configuration item, add it.)"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.code,{children:"network:   config: disabled"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Restart Cloud-Init and check its status."}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.code,{children:"systemctl restart cloud-init-local.service cloud-init.service cloud-config.service cloud-final.service systemctl status cloud-init-local.service cloud-init.service cloud-config.service cloud-final.service"})}),"\n",(0,s.jsxs)(n.ol,{start:"11",children:["\n",(0,s.jsx)(n.li,{children:"Enable Cloud-Init related services to automatically start upon system boot."}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.code,{children:"systemctl enable cloud-init-local.service cloud-init.service cloud-config.service cloud-final.service"})}),"\n",(0,s.jsxs)(n.ol,{start:"12",children:["\n",(0,s.jsx)(n.li,{children:"Check whether Cloud-Init is running properly."}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.code,{children:"cloud-init -v cloud-init init --local"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"SUSE Enterprise Linux Server 15"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:"https://support.huaweicloud.com/intl/en-us/bestpractice-ims/public_sys-resources/notice_3.0-en-us.png",alt:""})}),"\n",(0,s.jsx)(n.p,{children:"Ensure that Python 3 has been installed."}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"View existing SUSE repositories."}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.code,{children:"zypper lr"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Delete the SUSE repositories."}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.code,{children:"zypper rr No. of repositories listed in 1"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Configure a SUSE repository."}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.code,{children:"zypper ar https://ftp5.gwdg.de/pub/opensuse/repositories/Cloud:/Tools/SLE_15_SP4/Cloud:Tools.repo"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Refresh the SUSE repository."}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.code,{children:"zypper refresh"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Install Cloud-Init."}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.code,{children:"zypper install cloud-init"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["Run ",(0,s.jsx)(n.strong,{children:"cloud-init -v"}),". If error messages similar to the following are displayed, install the dependency packages."]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:"https://support.huaweicloud.com/intl/en-us/bestpractice-ims/en-us_image_0000001688251829.png",alt:""})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:"https://support.huaweicloud.com/intl/en-us/bestpractice-ims/en-us_image_0000001640131918.png",alt:""})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.code,{children:"pip install requests pyyaml oauthlib jsonschema jsonpatch jinja2 configobj"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["Check whether Cloud-Init is successfully installed. If the following error message is displayed, configure ",(0,s.jsx)(n.strong,{children:"datasource_list"})," in ",(0,s.jsx)(n.strong,{children:"/etc/cloud/cloud.cfg"}),"."]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:"https://support.huaweicloud.com/intl/en-us/bestpractice-ims/en-us_image_0000001639765024.png",alt:""})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.code,{children:"datasource_list: [ OpenStack ] datasource:   OpenStack: metadata_urls: ['http://169.254.169.254'] max_wait: 120 timeout: 5 apply_network_config: false"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Modify the configuration file, restart Cloud-Init, and check the Cloud-Init status."}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.code,{children:"systemctl restart cloud-init-local.service cloud-init.service cloud-config.service cloud-final.service  systemctl status cloud-init-local.service cloud-init.service cloud-config.service cloud-final.service"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Enable Cloud-Init related services to automatically start upon system boot."}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.code,{children:"systemctl enable cloud-init-local.service cloud-init.service cloud-config.service cloud-final.service"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:"https://support.huaweicloud.com/intl/en-us/bestpractice-ims/en-us_image_0000001688204517.png",alt:""})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Check whether Cloud-Init is running properly."}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.code,{children:"cloud-init -v cloud-init init --local"})}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h4,{id:"install-cloud-init-using-the-official-source-code-package-and-pip",children:"Install Cloud-Init Using the Official Source Code Package and pip"}),"\n",(0,s.jsx)(n.p,{children:"The following operations use Cloud-Init 0.7.9 as an example to describe how to install Cloud-Init."}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["Download the ",(0,s.jsx)(n.strong,{children:"cloud-init-0.7.9.tar.gz"})," source code package (version 0.7.9 is recommended) and upload it to the ",(0,s.jsx)(n.strong,{children:"/home/"})," directory of the ECS."]}),"\n",(0,s.jsxs)(n.p,{children:["Download ",(0,s.jsx)(n.strong,{children:"cloud-init-0.7.9.tar.gz"})," from the following path:"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.a,{href:"https://launchpad.net/cloud-init/trunk/0.7.9/+download/cloud-init-0.7.9.tar.gz",children:"https://launchpad.net/cloud-init/trunk/0.7.9/+download/cloud-init-0.7.9.tar.gz"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["Create a ",(0,s.jsx)(n.strong,{children:"pip.conf"})," file in the ",(0,s.jsx)(n.strong,{children:"~/.pip/"})," directory and edit the following content:"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:"https://support.huaweicloud.com/intl/en-us/bestpractice-ims/public_sys-resources/note_3.0-en-us.png",alt:""})}),"\n",(0,s.jsxs)(n.p,{children:["If the ",(0,s.jsx)(n.strong,{children:"~/.pip/"})," directory does not exist, run the ",(0,s.jsx)(n.strong,{children:"mkdir ~/.pip"})," command to create it."]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.code,{children:"[global] index-url  = https://<$mirror>/simple/ trusted-host = <$mirror>"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["Run the following command to install the downloaded Cloud-Init source code package (select ",(0,s.jsx)(n.strong,{children:"--upgrade"})," as needed during installation):"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"pip install [--upgrade] /home/cloud-init-0.7.9.tar.gz"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["Run the ",(0,s.jsx)(n.strong,{children:"cloud-init -v"})," command. Cloud-Init is installed successfully if the following information is displayed:"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.code,{children:"cloud-init 0.7.9"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Enable Cloud-Init to automatically start upon system boot."}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"If the OS uses SysVinit to manage automatic start of services, run the following commands:"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"chkconfig --add cloud-init-local; chkconfig --add cloud-init; chkconfig --add cloud-config; chkconfig --add cloud-final"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"chkconfig cloud-init-local on; chkconfig cloud-init on; chkconfig cloud-config on; chkconfig cloud-final on"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"service cloud-init-local status; service cloud-init status; service cloud-config status; service cloud-final status"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"If the OS uses Systemd to manage automatic start of services, run the following commands:"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"systemctl enable cloud-init-local.service cloud-init.service cloud-config.service cloud-final.service"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"systemctl status cloud-init-local.service cloud-init.service cloud-config.service cloud-final.service"})}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:"https://support.huaweicloud.com/intl/en-us/bestpractice-ims/public_sys-resources/caution_3.0-en-us.png",alt:""})}),"\n",(0,s.jsx)(n.p,{children:"If you install Cloud-Init using the official source code package and pip, pay attention to the following:"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["Add user ",(0,s.jsx)(n.strong,{children:"syslog"})," to the ",(0,s.jsx)(n.strong,{children:"adm"})," group during the installation. If user ",(0,s.jsx)(n.strong,{children:"syslog"})," exists, add it to the ",(0,s.jsx)(n.strong,{children:"adm"})," group. For some OSs (such as CentOS and SUSE), user ",(0,s.jsx)(n.strong,{children:"syslog"})," may not exist. Run the following commands to create user ",(0,s.jsx)(n.strong,{children:"syslog"})," and add it to the ",(0,s.jsx)(n.strong,{children:"adm"})," group:"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"useradd syslog"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"groupadd adm"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"usermod -g adm syslog"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["Change the value of ",(0,s.jsx)(n.strong,{children:"distro"})," in ",(0,s.jsx)(n.strong,{children:"system_info"})," in the ",(0,s.jsx)(n.strong,{children:"/etc/cloud/cloud.cfg"})," file based on the OS release version, such as ",(0,s.jsx)(n.strong,{children:"distro: ubuntu"}),", ",(0,s.jsx)(n.strong,{children:"distro: sles"}),", ",(0,s.jsx)(n.strong,{children:"distro: debian"}),", and ",(0,s.jsx)(n.strong,{children:"distro: fedora"}),"."]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h4,{id:"install-cloud-init-using-the-official-github-source-code",children:"Install Cloud-Init Using the Official GitHub Source Code"}),"\n",(0,s.jsxs)(n.p,{children:["You can obtain the Cloud-Init source code from GitHub at ",(0,s.jsx)(n.a,{href:"https://github.com/canonical/cloud-init/",children:"https://github.com/canonical/cloud-init/"})]}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["Run the following commands to download the source code package and copy it to the ",(0,s.jsx)(n.strong,{children:"/tmp/CLOUD-INIT"})," folder:"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:"https://support.huaweicloud.com/intl/en-us/bestpractice-ims/public_sys-resources/note_3.0-en-us.png",alt:""})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"wget"})," ",(0,s.jsx)(n.strong,{children:(0,s.jsx)(n.a,{href:"https://github.com/canonical/cloud-init/archive/refs/tags/0.7.6.zip",children:"https://github.com/canonical/cloud-init/archive/refs/tags/0.7.6.zip"})})]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"mkdir /tmp/CLOUD-INIT"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsxs)(n.strong,{children:["cp ",(0,s.jsx)(n.strong,{children:"cloud-init-0.7.6.zip"})," /tmp/CLOUD-INIT"]})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"cd /tmp/CLOUD-INIT"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Run the following command to decompress the package:"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsxs)(n.strong,{children:["unzip ",(0,s.jsx)(n.strong,{children:"cloud-init-0.7.6.zip"})]})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["Run the following command to enter the ",(0,s.jsx)(n.strong,{children:"cloud-init-0.7.6"})," folder:"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsxs)(n.strong,{children:["cd ",(0,s.jsx)(n.strong,{children:"cloud-init"}),"-0.7.6"]})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"(Optional) If the Cloud-Init version is 18.3 to 22.3, run the following commands:"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"sed -i '/VALID_DMI_ASSET_TAGS =/a\\VALID_DMI_ASSET_TAGS += [\"HUAWEICLOUD\"]' cloudinit/sources/DataSourceOpenStack.py"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"cat cloudinit/sources/DataSourceOpenStack.py | grep VALID_DMI_ASSET_TAGS"})}),"\n",(0,s.jsx)(n.p,{children:"If the following information is displayed, the execution is successful."}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:"https://support.huaweicloud.com/intl/en-us/bestpractice-ims/en-us_image_0000001390619817.png",alt:""})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Install Cloud-Init. The commands vary depending on the OS type."}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"For CentOS 6.x or SUSE 11.x, run the following commands:"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"python setup.py build"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"python setup.py install --init-system sysvinit"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"For CentOS 7.x or SUSE 12.x, run the following commands:"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"python setup.py build"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"python setup.py install --init-system systemd"})}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:"https://support.huaweicloud.com/intl/en-us/bestpractice-ims/public_sys-resources/note_3.0-en-us.png",alt:""})}),"\n",(0,s.jsxs)(n.p,{children:["Add user ",(0,s.jsx)(n.strong,{children:"syslog"})," to the ",(0,s.jsx)(n.strong,{children:"adm"})," group during the installation. If user ",(0,s.jsx)(n.strong,{children:"syslog"})," exists, add it to the ",(0,s.jsx)(n.strong,{children:"adm"})," group. For some OSs (such as CentOS and SUSE), user ",(0,s.jsx)(n.strong,{children:"syslog"})," may not exist. Run the following commands to create user ",(0,s.jsx)(n.strong,{children:"syslog"})," and add it to the ",(0,s.jsx)(n.strong,{children:"adm"})," group:"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"useradd syslog"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"groupadd adm"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"usermod -g adm syslog"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Enable Cloud-Init to automatically start upon system boot."}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"If the OS uses SysVinit to manage automatic start of services, run the following commands:"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"chkconfig --add cloud-init-local; chkconfig --add cloud-init; chkconfig --add cloud-config; chkconfig --add cloud-final"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"chkconfig cloud-init-local on; chkconfig cloud-init on; chkconfig cloud-config on; chkconfig cloud-final on"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"service cloud-init-local status; service cloud-init status; service cloud-config status; service cloud-final status"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"If the OS uses Systemd to manage automatic start of services, run the following commands:"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"systemctl enable cloud-init-local.service cloud-init.service cloud-config.service cloud-final.service"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"systemctl status cloud-init-local.service cloud-init.service cloud-config.service cloud-final.service"})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Run the following commands to check whether Cloud-Init has been installed:"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"cloud-init -v"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"cloud-init init --local"})}),"\n",(0,s.jsx)(n.p,{children:"Cloud-Init is successfully installed if the following information is displayed:"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.code,{children:"cloud-init 0.7.6"})}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"optional-installing-the-one-click-password-reset-plug-in_image-management-service",children:"(Optional) Installing the One-Click Password Reset Plug-in_Image Management Service"}),"\n",(0,s.jsx)(n.p,{children:"To ensure that you can reset the password of each ECS created from the image with a few clicks, you are advised to install the one-click password reset plug-in (CloudResetPwdAgent) on the VM which is used as the image source."}),"\n",(0,s.jsx)(n.h4,{id:"procedure-4",children:"Procedure"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Download the CloudResetPwdAgent software package."}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:"https://support.huaweicloud.com/intl/en-us/bestpractice-ims/public_sys-resources/note_3.0-en-us.png",alt:""})}),"\n",(0,s.jsx)(n.p,{children:"The one-click password reset plug-in can be automatically updated only if an EIP is bound to the VM."}),"\n",(0,s.jsxs)(n.p,{children:["You can download the ",(0,s.jsx)(n.strong,{children:"CloudResetPwdAgent.zip"})," package from:"]}),"\n",(0,s.jsxs)(n.p,{children:["For 32-bit OSs: ",(0,s.jsx)(n.a,{href:"http://ap-southeast-1-cloud-reset-pwd.obs.ap-southeast-1.myhuaweicloud.com/linux/32/reset_pwd_agent/CloudResetPwdAgent.zip",children:"http://ap-southeast-1-cloud-reset-pwd.obs.ap-southeast-1.myhuaweicloud.com/linux/32/reset_pwd_agent/CloudResetPwdAgent.zip"})]}),"\n",(0,s.jsxs)(n.p,{children:["For 64-bit OSs: ",(0,s.jsx)(n.a,{href:"http://ap-southeast-1-cloud-reset-pwd.obs.ap-southeast-1.myhuaweicloud.com/linux/64/reset_pwd_agent/CloudResetPwdAgent.zip",children:"http://ap-southeast-1-cloud-reset-pwd.obs.ap-southeast-1.myhuaweicloud.com/linux/64/reset_pwd_agent/CloudResetPwdAgent.zip"})]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["Run the following command to decompress ",(0,s.jsx)(n.strong,{children:"CloudResetPwdAgent.zip"}),":"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"unzip -o -d"})," ",(0,s.jsx)(n.em,{children:"Decompressed directory"})," ",(0,s.jsx)(n.strong,{children:"CloudResetPwdAgent.zip"})]}),"\n",(0,s.jsxs)(n.p,{children:["There is no special requirement for the directory that stores the decompressed ",(0,s.jsx)(n.strong,{children:"CloudResetPwdAgent.zip"}),". You can choose a directory as you need. If the directory is ",(0,s.jsx)(n.strong,{children:"/home/PwdAgent/test"}),", the command is as follows:"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"unzip -o -d /home/PwdAgent/test CloudResetPwdAgent.zip"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Install the one-click password reset plug-in."}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["Run the following command to open the ",(0,s.jsx)(n.strong,{children:"CloudResetPwdAgent.Linux"})," file:"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"cd CloudResetPwdAgent/CloudResetPwdAgent.Linux"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["Run the following command to add the execute permission for the ",(0,s.jsx)(n.strong,{children:"setup.sh"})," file:"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"chmod +x setup.sh"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Run the following command to install the plug-in:"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"sudo sh setup.sh"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Run the following command to check whether the installation is successful:"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"service cloudResetPwdAgent status"})}),"\n",(0,s.jsxs)(n.p,{children:["If the status of CloudResetPwdAgent is not ",(0,s.jsx)(n.strong,{children:"unrecognized service"}),", the installation is successful. Otherwise, the installation failed."]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:"https://support.huaweicloud.com/intl/en-us/bestpractice-ims/public_sys-resources/note_3.0-en-us.png",alt:""})}),"\n",(0,s.jsx)(n.p,{children:"If the installation failed, check whether the installation environment meets requirements and install the plug-in again."}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"configuring-networkmanager",children:"Configuring NetworkManager"}),"\n",(0,s.jsx)(n.p,{children:"Linux allows you to use NetworkManager to automatically configure the VM network. You are advised to use NetworkManager for new OS versions."}),"\n",(0,s.jsx)(n.p,{children:"Alternatively, you can use the native network management service of the OS."}),"\n",(0,s.jsx)(n.h4,{id:"red-hat-oracle-centos-6x-centos-7x-euleros-2x-fedora-22-or-later",children:"Red Hat, Oracle, CentOS 6.x, CentOS 7.x, EulerOS 2.x, Fedora 22, or Later"}),"\n",(0,s.jsx)(n.p,{children:"Install NetworkManager and use it for automatic network configuration."}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Run the following command to install NetworkManager:"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"yum install NetworkManager"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["Delete ",(0,s.jsx)(n.strong,{children:"ifcfg-eth1"})," to ",(0,s.jsx)(n.strong,{children:"ifcfg-eth11"})," from the ",(0,s.jsx)(n.strong,{children:"/etc/sysconfig/network-scripts/"})," directory and retain only ",(0,s.jsx)(n.strong,{children:"ifcfg-eth0"}),"."]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Run the following command to disable the network:"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"service network stop"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Run the following command to disable automatic startup of the network:"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"chkconfig network off"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Run the following commands to restart messagebus and NetworkManager and enable NetworkManager to start automatically at startup:"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"service messagebus restart"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"service NetworkManager restart"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"chkconfig NetworkManager on"})}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h4,{id:"debian-90-or-later",children:"Debian 9.0 or Later"}),"\n",(0,s.jsx)(n.p,{children:"Install NetworkManager and use it for automatic network configuration."}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Run the following command to install NetworkManager:"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"apt-get install network-manager"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["Change the value of ",(0,s.jsx)(n.strong,{children:"managed"})," in the ",(0,s.jsx)(n.strong,{children:"/etc/NetworkManager/NetworkManager.conf"})," file to ",(0,s.jsx)(n.strong,{children:"true"}),"."]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["Modify ",(0,s.jsx)(n.strong,{children:"/etc/network/interfaces"})," and retain only ",(0,s.jsx)(n.strong,{children:"eth0"}),"."]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Run the following commands to disable the network, restart messagebus and NetworkManager, and enable NetworkManager to start automatically at startup:"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"service network-manager restart"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"chkconfig network-manager on"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"service networking stop"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"service messagebus restart"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"service network-manager restart"})}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h4,{id:"ubuntu-14-or-later",children:"Ubuntu 14 or Later"}),"\n",(0,s.jsx)(n.p,{children:"Install NetworkManager and use it for automatic network configuration."}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Run the following command to install NetworkManager:"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"apt-get install network-manager"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["Change the value of ",(0,s.jsx)(n.strong,{children:"managed"})," in the ",(0,s.jsx)(n.strong,{children:"/etc/NetworkManager/NetworkManager.conf"})," file to ",(0,s.jsx)(n.strong,{children:"true"}),"."]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["Modify ",(0,s.jsx)(n.strong,{children:"/etc/network/interfaces"})," and retain only ",(0,s.jsx)(n.strong,{children:"eth0"}),"."]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Run the following command to disable the network:"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"service networking stop"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Run the following command to disable automatic startup of the network:"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"chkconfig network off"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Run the following commands to restart D-Bus and NetworkManager:"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"service dbus restart"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"service network-manager restar****t"})}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h4,{id:"suse-11-sp3-and-opensuse-13-or-later",children:"SUSE 11 SP3 and openSUSE 13 or Later"}),"\n",(0,s.jsx)(n.p,{children:"Install NetworkManager and use it for automatic network configuration."}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["Delete ",(0,s.jsx)(n.strong,{children:"ifcfg-eth1"})," to ",(0,s.jsx)(n.strong,{children:"ifcfg-eth11"})," from the ",(0,s.jsx)(n.strong,{children:"/etc/sysconfig/network-scripts/"})," directory and retain only ",(0,s.jsx)(n.strong,{children:"ifcfg-eth0"}),"."]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Run the following command to install NetworkManager:"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"zypper install NetworkManager"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["Start YaST, choose ",(0,s.jsx)(n.strong,{children:"Network Devices"})," in the navigation pane on the left, and select ",(0,s.jsx)(n.strong,{children:"Network Settings"})," in the right pane. In the ",(0,s.jsx)(n.strong,{children:"Network Setup Method"})," area of the ",(0,s.jsx)(n.strong,{children:"Global Options"})," page, change ",(0,s.jsx)(n.strong,{children:"Traditional Method with ifup"})," to ",(0,s.jsx)(n.strong,{children:"User Controlled with NetworkManager"})]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"step-4-obtaining-the-image-file_image-management-service",children:"Step 4: Obtaining the Image File_Image Management Service"}),"\n",(0,s.jsx)(n.p,{children:"Updated on 2022-08-29 GMT+08:00"}),"\n",(0,s.jsx)(n.p,{children:"After the VM is configured, perform the following operations to generate and export a Linux image file:"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["Open VirtualBox, select the VM, choose ",(0,s.jsx)(n.strong,{children:"Settings"})," > ",(0,s.jsx)(n.strong,{children:"Storage"}),", and select ",(0,s.jsx)(n.strong,{children:"Linux.vhd"}),"."]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Linux"})," is the VM name."]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"On the right pane, view the image file location."}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["Go to the location to obtain the generated ",(0,s.jsx)(n.strong,{children:"Linux.vhd"})," image file."]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"step-5-registering-the-image-file-as-a-private-image",children:"Step 5: Registering the Image File as a Private Image"}),"\n",(0,s.jsx)(n.p,{children:"Upload the image file to an OBS bucket and register it as a private image."}),"\n",(0,s.jsx)(n.h4,{id:"constraints",children:"Constraints"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Only an unencrypted image file or an image file encrypted using SSE-KMS can be uploaded to an OBS bucket."}),"\n",(0,s.jsx)(n.li,{children:"When uploading an image file, you must select an OBS bucket with the storage class of Standard."}),"\n"]}),"\n",(0,s.jsx)(n.h4,{id:"procedure-5",children:"Procedure"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["Use OBS Browser+ to upload the image file. For details, see ",(0,s.jsx)(n.a,{href:"https://support.huaweicloud.com/intl/en-us/browsertg-obs/obs_03_1006.html",children:"OBS Browser+ Best Practices"}),"."]}),"\n",(0,s.jsxs)(n.p,{children:["For how to download OBS Browser+, see ",(0,s.jsx)(n.a,{href:"https://support.huaweicloud.com/intl/en-us/browsertg-obs/obs_03_1003.html",children:"https://support.huaweicloud.com/intl/en-us/browsertg-obs/obs_03_1003.html"}),"."]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["Register the external image file as a private image. For details, see ",(0,s.jsx)(n.a,{href:"https://support.huaweicloud.com/intl/en-us/usermanual-ims/ims_01_0211.html",children:"Registering an Image File as a Private Image (Linux)"}),"."]}),"\n"]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(a,{...e})}):a(e)}},28453:(e,n,i)=>{i.d(n,{R:()=>l,x:()=>o});var s=i(96540);const t={},r=s.createContext(t);function l(e){const n=s.useContext(r);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:l(e.components),s.createElement(r.Provider,{value:n},e.children)}}}]);