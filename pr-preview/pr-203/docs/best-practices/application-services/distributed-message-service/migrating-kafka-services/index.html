<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-best-practices/application-services/distributed-message-service/migrating-kafka-services" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.7.0">
<title data-rh="true">Migrating Kafka Services | Architecture Center</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://opentelekomcloud.github.io/docs-next/pr-preview/pr-203/img/open-telekom-cloud-social-card.png"><meta data-rh="true" name="twitter:image" content="https://opentelekomcloud.github.io/docs-next/pr-preview/pr-203/img/open-telekom-cloud-social-card.png"><meta data-rh="true" property="og:url" content="https://opentelekomcloud.github.io/docs-next/pr-preview/pr-203/docs/best-practices/application-services/distributed-message-service/migrating-kafka-services"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Migrating Kafka Services | Architecture Center"><meta data-rh="true" name="description" content="This solution will demonstrate how you can migrate Kafka services to connect message producers and consumers to a new Kafka instance and can even migrate persisted message data to a new Kafka instance."><meta data-rh="true" property="og:description" content="This solution will demonstrate how you can migrate Kafka services to connect message producers and consumers to a new Kafka instance and can even migrate persisted message data to a new Kafka instance."><link data-rh="true" rel="icon" href="/docs-next/pr-preview/pr-203/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://opentelekomcloud.github.io/docs-next/pr-preview/pr-203/docs/best-practices/application-services/distributed-message-service/migrating-kafka-services"><link data-rh="true" rel="alternate" href="https://opentelekomcloud.github.io/docs-next/pr-preview/pr-203/docs/best-practices/application-services/distributed-message-service/migrating-kafka-services" hreflang="en"><link data-rh="true" rel="alternate" href="https://opentelekomcloud.github.io/docs-next/pr-preview/pr-203/docs/best-practices/application-services/distributed-message-service/migrating-kafka-services" hreflang="x-default"><link rel="preconnect" href="https://analytics.example.de">
<script async defer="defer" src="https://analytics.example.de/script.js" data-website-id="00000" data-host-url="https://analytics.example.de" data-auto-track data-do-not-track data-cache data-domains="opentelekomcloud.github.io"></script><link rel="stylesheet" href="/docs-next/pr-preview/pr-203/assets/css/styles.035f7a1e.css">
<script src="/docs-next/pr-preview/pr-203/assets/js/runtime~main.f0b330da.js" defer="defer"></script>
<script src="/docs-next/pr-preview/pr-203/assets/js/main.225bccfd.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();null!==e?t(e):window.matchMedia("(prefers-color-scheme: dark)").matches?t("dark"):(window.matchMedia("(prefers-color-scheme: light)").matches,t("light"))}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/docs-next/pr-preview/pr-203/"><div class="navbar__logo"><img src="/docs-next/pr-preview/pr-203/img/logo_headline_kombination_m_s_m.png" alt="Open Telekom Cloud Non-Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/docs-next/pr-preview/pr-203/img/logo_headline_kombination_m_w_m.png" alt="Open Telekom Cloud Non-Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs-next/pr-preview/pr-203/docs/best-practices/">Best Practices</a><a class="navbar__item navbar__link" href="/docs-next/pr-preview/pr-203/docs/blueprints/">Blueprints</a></div><div class="navbar__items navbar__items--right"><a href="https://auth.otc.t-systems.com/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link navbar--terminal-link" aria-label="Open Telekom Cloud Console"></a><a href="https://github.com/opentelekomcloud/docs-next" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link navbar--github-link" aria-label="GitHub"></a><div class="toggle_vylO colorModeToggle_x44X"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite" aria-pressed="false"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_dCNk"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs-next/pr-preview/pr-203/docs/best-practices/">Best Practices</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a href="https://docs.otc.t-systems.com/application-operations-management/index.html" target="_blank" rel="noopener noreferrer" class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true">Application Services</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a href="https://docs.otc.t-systems.com/application-operations-management/index.html" target="_blank" rel="noopener noreferrer" class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0">Application Operations Management</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs-next/pr-preview/pr-203/docs/best-practices/application-services/api-gateway/selectively-exposing-cce-workloads-with-a-dedicated-gateway">API Gateway (APIG)</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" tabindex="0" href="/docs-next/pr-preview/pr-203/docs/best-practices/application-services/distributed-message-service/migrating-kafka-services">Distributed Message Service</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs-next/pr-preview/pr-203/docs/best-practices/application-services/distributed-message-service/migrating-kafka-services">Migrating Kafka Services</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs-next/pr-preview/pr-203/docs/best-practices/application-services/distributed-message-service/improving-kafka-message-processing-efficiency">Improving Kafka Message Processing Efficiency</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs-next/pr-preview/pr-203/docs/best-practices/application-services/distributed-message-service/optimizing-consumer-polling">Optimizing Consumer Polling</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs-next/pr-preview/pr-203/docs/best-practices/application-services/distributed-message-service/configuring-message-accumulation-monitoring">Configuring Message Accumulation Monitoring</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a href="https://docs.otc.t-systems.com/distributed-message-service/index.html" target="_blank" rel="noopener noreferrer" class="menu__link menuExternalLink_NmtK" tabindex="0">📚 Go to Help Center<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a href="https://docs.otc.t-systems.com/simple-message-notification/index.html" target="_blank" rel="noopener noreferrer" class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0">Simple Message Notification</a></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a href="https://docs.otc.t-systems.com/cloud-search-service/index.html" target="_blank" rel="noopener noreferrer" class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false">Big Data &amp; Data Analysis</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a href="https://docs.otc.t-systems.com/auto-scaling/index.html" target="_blank" rel="noopener noreferrer" class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false">Computing</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a href="https://docs.otc.t-systems.com/application-service-mesh/index.html" target="_blank" rel="noopener noreferrer" class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false">Containers</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs-next/pr-preview/pr-203/docs/best-practices/databases/distributed-cache-service/using-nginx-for-public-access-to-single-node-master-standby-or-proxy-cluster-dcs-redis-instances">Databases</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a href="https://docs.otc.t-systems.com/application-performance-management/index.html" target="_blank" rel="noopener noreferrer" class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false">Management &amp; Deployment</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a href="https://docs.otc.t-systems.com/direct-connect/index.html" target="_blank" rel="noopener noreferrer" class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false">Networking</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a href="https://docs.otc.t-systems.com/anti-ddos/index.html" target="_blank" rel="noopener noreferrer" class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false">Security Services</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a href="https://docs.otc.t-systems.com/cloud-backup-recovery/index.html" target="_blank" rel="noopener noreferrer" class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false">Storage</a></div></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/docs-next/pr-preview/pr-203/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Application Services</span><meta itemprop="position" content="1"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Distributed Message Service</span><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Migrating Kafka Services</span><meta itemprop="position" content="3"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Migrating Kafka Services</h1></header>
<p>This solution will demonstrate how you can migrate Kafka services to connect message producers and consumers to a new Kafka instance and can even migrate persisted message data to a new Kafka instance.</p>
<p>Kafka services can be migrated in the following two scenarios:</p>
<ul>
<li>
<p>Migrating services to the cloud without downtime</p>
<p>Services that have high requirements on continuity must be smoothly
migrated to the cloud because they cannot afford a long downtime.</p>
</li>
<li>
<p>Re-deploying services in the cloud</p>
<p>A Kafka instance deployed within an AZ is not capable of cross-AZ
disaster recovery. For higher reliability, you can re-deploy
services to an instance that is deployed across AZs.</p>
</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="prerequisites">Prerequisites<a href="#prerequisites" class="hash-link" aria-label="Direct link to Prerequisites" title="Direct link to Prerequisites">​</a></h2>
<ol>
<li>
<p>Configure the network environment.</p>
<p>A Kafka instance can be accessed within a VPC or over a public
network. For public network access, the producer and consumer must
have public access permissions, and the following security group
rules must be configured:</p>
<ul>
<li><strong>Inbound</strong>: <code>TCP/9094</code>, <code>0.0.0.0/0</code> -&gt; Access Kafka through the public network (<strong>without</strong> SSL encryption)</li>
<li><strong>Inbound</strong>: <code>TCP/9095</code>, <code>0.0.0.0/0</code> -&gt; Access Kafka through the public network (<strong>with</strong> SSL encryption)</li>
</ul>
</li>
<li>
<p>Create a Kafka instance.</p>
<p>The specifications of the new instance cannot be lower than the
original specifications. For details, see <a href="https://docs.otc.t-systems.com/distributed-message-service/umn/creating_an_instance.html" target="_blank" rel="noopener noreferrer">Creating an Instance</a>.</p>
</li>
<li>
<p>Create a topic.</p>
<p>Create a topic with the same configurations as the original Kafka
instance, including the topic name, number of replicas, number of
partitions, message aging time, and whether to enable synchronous
replication and flushing. For details, see <a href="https://docs.otc.t-systems.com/cloud-eye/umn/using_the_alarm_function/creating_alarm_notification_topics/creating_a_topic.html" target="_blank" rel="noopener noreferrer">Creating a Topic</a>.</p>
</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="migration-scheme-1-migrating-the-production-first">Migration Scheme 1: Migrating the Production First<a href="#migration-scheme-1-migrating-the-production-first" class="hash-link" aria-label="Direct link to Migration Scheme 1: Migrating the Production First" title="Direct link to Migration Scheme 1: Migrating the Production First">​</a></h2>
<p>Migrate the message production service to the new Kafka instance. After
migration, the original Kafka instance will no longer produce messages.
After all messages of the original Kafka instance are consumed, migrate
the message consumption service to the new Kafka instance to consume
messages of this instance.</p>
<ol>
<li>Change the Kafka connection address of the producer to that of the
new Kafka instance.</li>
<li>Restart the production service so that the producer can send new
messages to the new Kafka instance.</li>
<li>Check the consumption progress of each consumer group in the
original Kafka instance until all data in the original Kafka
instance is consumed.</li>
<li>Change the Kafka connection addresses of the consumers to that of
the new Kafka instance.</li>
<li>Restart the consumption service so that consumers can consume
messages from the new Kafka instance.</li>
<li>Check whether consumers consume messages properly from the new Kafka
instance.</li>
<li>The migration is completed.</li>
</ol>
<p>This is a common migration scheme. It is simple and easy to control on
the service side. During the migration, the message sequence is ensured,
so this scheme is <strong>suitable for scenarios with strict requirements on
the message sequence</strong>. However, latency may occur because there is a
period when you have to wait for all data to be consumed.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="migration-scheme-2-migrating-the-production-later">Migration Scheme 2: Migrating the Production Later<a href="#migration-scheme-2-migrating-the-production-later" class="hash-link" aria-label="Direct link to Migration Scheme 2: Migrating the Production Later" title="Direct link to Migration Scheme 2: Migrating the Production Later">​</a></h2>
<p>Use multiple consumers for the consumption service. Some consume
messages from the original Kafka instance, and others consume messages
from the new Kafka instances. Then, migrate the production service to
the new Kafka instance so that all messages can be consumed in time.</p>
<ol>
<li>
<p>Start new consumer clients, set the Kafka connection addresses to
that of the new Kafka instance, and consume data from the new Kafka
instance.</p>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><p>Original consumer clients must continue running. Messages are
consumed from both the original and new Kafka instances.</p></div></div>
</li>
<li>
<p>Change the Kafka connection address of the producer to that of the
new Kafka instance.</p>
</li>
<li>
<p>Restart the producer client to migrate the production service to the
new Kafka instance.</p>
</li>
<li>
<p>After the production service is migrated, check whether the
consumption service connected to the new Kafka instance is normal.</p>
</li>
<li>
<p>After all data in the original Kafka is consumed, close the original
consumption clients.</p>
</li>
<li>
<p>The migration is completed.</p>
</li>
</ol>
<p>In this scheme, the migration process is controlled by services. For a
certain period of time, the consumption service consumes messages from
both the original and new Kafka instances. Before the migration, message
consumption from the new Kafka instance has already started, so there is
no latency. However, early on in the migration, data is consumed from
both the original and new Kafka instances, so the messages may not be
consumed in the order that they are produced. This scheme is <strong>suitable
for services that require low latency but do not require strict message
sequence</strong>.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="how-do-i-migrate-persisted-data-along-with-services">How Do I Migrate Persisted Data Along with Services?<a href="#how-do-i-migrate-persisted-data-along-with-services" class="hash-link" aria-label="Direct link to How Do I Migrate Persisted Data Along with Services?" title="Direct link to How Do I Migrate Persisted Data Along with Services?">​</a></h2>
<p>You can migrate consumed data from the original instance to a new
instance by using the open-source tool <a href="https://github.com/miguecoll/kafka-mirror-maker" target="_blank" rel="noopener noreferrer">MirrorMaker</a>. This
tool mirrors the original Kafka producer and consumer into new ones and
migrates data to the new Kafka instance. For details, see
<a href="#using-mirrormaker-to-synchronize-data-across-clusters">Using MirrorMaker to Synchronize Data Across Clusters</a>.</p>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><p>Each Open Telekom Cloud Kafka instance stores data in three
replicas. Therefore, the storage space of the new instance should be
three times that of the original single-replica message storage.</p></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="using-mirrormaker-to-synchronize-data-across-clusters">Using MirrorMaker to Synchronize Data Across Clusters<a href="#using-mirrormaker-to-synchronize-data-across-clusters" class="hash-link" aria-label="Direct link to Using MirrorMaker to Synchronize Data Across Clusters" title="Direct link to Using MirrorMaker to Synchronize Data Across Clusters">​</a></h2>
<p>In the following scenarios, <a href="https://cwiki.apache.org/confluence/pages/viewpage.action?pageId=27846330" target="_blank" rel="noopener noreferrer">MirrorMaker</a> can be used to synchronize data
between different Kafka clusters to ensure the availability and
reliability of the clusters:</p>
<ul>
<li>Backup and disaster recovery: An enterprise has multiple data
centers. To prevent service unavailability caused by a fault in one
data center, cluster data is synchronously backed up in multiple
data centers.</li>
<li>Cluster migration: As enterprises migrate services to the cloud,
data in on-premises clusters must be synchronized with that in cloud
clusters to ensure service continuity.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="solution-design">Solution Design<a href="#solution-design" class="hash-link" aria-label="Direct link to Solution Design" title="Direct link to Solution Design">​</a></h3>
<p>MirrorMaker can be used to mirror data from the source cluster to the
target cluster. As shown in figure below,
in essence, MirrorMaker first consumes data from the source cluster and
then produces the consumed data to the target cluster. For more
information about MirrorMaker, see <a href="https://kafka.apache.org/documentation/?spm=a2c4g.11186623.0.0.c82870aav6G9no#basic_ops_mirror_maker" target="_blank" rel="noopener noreferrer">Mirroring data between
clusters</a>.</p>
<center><p><img decoding="async" loading="lazy" alt="Figure 1 How MirrorMakerworks" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAn8AAABhCAYAAACnDcc5AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAf/klEQVR4nO3dd3yV9d3/8dd1VvYehEwChBk2YY8wFcRVcYtWbbG2to7eWmt7t6E/a1vb3tW7Lqi9qVSpCoKgIApCIOwVZgDDSiAJ2Ts5OeO6fn9cJBCSQAJJDnA+z8cjD5Nrfq7DZc473+/1/R4FIW5gB/PsyaqqJru6DiGE+zAYDKkDuppTXV2HEFfL5OoChLgWqqomK4ryW1fXIYRwH6qqAqS6uAwhrprB1QUIIYQQQojOI+FPCCGEEMKNSPgTQgghhHAjEv6EEEIIIdyIhD8hhBBCCDci4U8IIYQQwo1I+BNCCCGEcCMS/oQQQggh3IiEPyGEEEIINyLhTwghhBDCjUj4E0IIIYRwIxL+hBCiAxzYsZGSgjxXlyGEEE1I+BNCtLsl7/+Ft1KeIS/7ZIvbLFv4Bm+lPMO5s6cAOHPyGAv/+iuKzp3trDJxOuy8lfIMC/74Ig67rdltbHVW5r/2c9599bk2HXvTV0soLshtjzKFEKJdSfgTQnQIo9HIod1pza4rKTxHfs7pRst8fP3pEt0NTy+fTqiuMafdxncH9zS77tiBnaiqs5MrEkKIjiPhTwjRISLjenI8Ix1rTXWTdYd2pRHVrVejZcHhXZl5/w/xDQhq9niqqoKmNV3uvLpgdvF+kXE9Wwyqh3ZvblJrZ2vp2oUQ4mqYXF2AEOLmFNWtF8UFuRzZt50hY6Y0LLfbbBw9sJOx0+4i+3hGw/Kc05ks/9ebPPFfr+Ht68+powdYs3QhDz79CutXfkhB7hme+uVf+GT+n0hIHIqmaezfvoGBIyaSNHEGxzPS2b3pa0qL8vHx8ydx+HiGjpkCigLAx+/9scl+Q8dOBSAhcRjrVy6mIDeb8MjYhprysk9QVlxIv6FjyDn9XcNyW531/PZZVFeW4+Xty8CRyQ3Hu5Smaaz59J9Ulpdw12M/w+LhSc7pTLau/Zyi/Fx8/QNImjiDPoNGArR47cr5axFCiGsh4U8I0WH6DB7F4T2bGTJ6ckMI++7gLjy9vInqlnDZfY1mM06HnXXLFzFi0kzCIqJRDAZMZjOHd28hpkcf7pv7Czy9fDh+OJ21yz9gwox7ieneh/ycLDZ8sZg6aw2jp9wB0Ox+9YJCI+gS3Y1Duzcz+Y6HGpYf3JVGQuJQzGaPRrWZLR5Ex/diRPJMvLx9yT5xhLXLFxEeGUt0fNNWwo2rPqGk6Bz3PP4cFg9PSgryWPnh20yYcS+9BiSRm5XJ6o8X4OsXSHT33i1euxBCtAf5bSKE6BAaGonDxlJWUsTZUxdazQ7tTiNx+PgrtmIpiv7racy0O4nt0RcvH7/zyxX8g0KYNOsB/AKCMFss7Ny4mr6DR9F/2Fj8g0JISBzK8Am3sn/7Buy2uhb3u7jaxGHjyDy0G1udFYDa6ipOZKQzMGkC0LjLVVEUEoePIzgsAi8fX3oPTCK8a0yjlsx6OzasIut4BnfOeQZPb18A9m3fQER0PP2HjcVssRCX0J+4hP5kpG+77LULIUR7kJY/IUSH8Q8KJbZ7Hw7t3kx0996cO3uKksJ8+g0ZTZ21plXHCA6LaLIsKCyioSXRYbdTUpDH0DGNu1yjuiXo6wrP0SUqrsl+l0pIHMbmrz/j2P6dDBgxgYz0rYR0iSI8Ko6i/JxG22qqyp7NazlxJJ06ay0mk5nK8hJCukQ22i5j71bOnDzG+Bmz8fUPbFhedO4sxfk5LPjjixcd00mXqG5XvHYhhLhWEv6EEB2q//CxfL10IdaaKg7v3kJC4lA8vX1aHf6uRNNUAAxGY6Plxkt+vhKT2UzvQSPISN/KgKTxHN6zlaSJtza7bfq29ezfsYE7HnmGsK7RAHy+6O9olwzKqKooY9DIZHZsWEV87wH4B4Y01Nxn8Cgm3f5gm2oUQoj2IN2+QogOFd97IF7evmSkbyfz8F4GJE1o1+ObLR74B4Y0mVOwIDcbk9lMUGiXVh8rcdg4CvPOcnBXGjZrDb0ShzW7XfaJI8T27NcQ/ABUp6PJdiOSZzLu1nsI7RLJN5/9Sx+1CwSHdSU3+0STsCiEEJ3hqlr+HklbmKxCcjvXIjqIAVI/HP94qqvrEO7JYDDQb8hodm1cTXBYREMXbHsaOm4aaV8tISwyhrie/SgpPMeO1NUMGjkJi4dnq48THN6VrrE92LrucxKHj8doMje7nZ9/ELnZJygvKQT0T/PIz8nGPyi0ybaKojDt7sf4z3t/YOeGVYyacjsDkibw2f/9D+tXfMTg0ZOxeHhSlJ+Dt48fXaK7XdVrIISrJKYcSVZRk11dh2gdA4bUqwp/evBTftvO9YgOouoPq6e6uAzhxvoNG8vutK/bvdWvXuLwcSiKQvqWdWxc9Qk+foEMGpncaIqZthxr7fJFDEga3+I2oybP4ptlH7D47Vfx8dfPlZA4tMU5B/0Cg5k48z7WLV9EdPfeRMf3YtZDP2Jn6mqWvP9njEYTQWERjJg4o831CuFqevCTTHCjUFG5qkmjHkpbmCL/0DcSbd7i8Y+nuLqKjrA/py5FUeReFEJ0Hk3T5g2K8khxdR3Xi34ph1MkE9xItHnyzJ8QQgghhBuR8CeEEEII4UYk/AkhhBBCuBEJf0IIIYQQbkTCnxBCCCGEG5HwJ4QQQgjhRiT8CSGEEEK4EQl/QgghhBBuRMKfEEIIIYQbkfAnhBBCCOFGTAA/yvwqWTW0/kOZ7da6ZM3e/GdYio7nrLPjtNlcXYYQQoib0PB3tWQVklu7vcNanozT3oEVictRbdWotpo27WMC0INf6z+Xz+zpCZ5tK060HxvVEv6EEEJ0CBWSUWh1JjB5BXRkOeIKHFW0OfxJt68QQgghhBuR8CeEEEII4UZMri5AiOvJ8g/eJOdUpqvLEJcRFZ/A3Y896+oyGsg9c/273u4ZIVxNwp8QF8k5lcmPX/+bq8sQl/HOS8+7uoRG5J65/l1v94wQribdvkIIIYQQbkTCnxBCCCGEG5HwJ4QQQgjhRiT8CSGEEEK4EQl/QgghhBBuRMKfEEIIIYQbkfAnhBBCCOFGJPwBJsVAsn8cISYvV5cihBBCCBfp6gcPDwTF1YV0sFZN8hzj4c/s4D7Eewbi1FTy7dVsKM9iR1VuR9fXKTwNJh4M7Ud+XhXFjlpXlyOEEEJct/4yHSbFt7x+zjLIKOy8etpT/zB4YTR8fAicqqur6ThXDH8+BjMvdB3B4Zoi3sjbCRrEegRgMRg7o74b0hi/KJJ8I3kzb5erSxFCCCHa1V+2wls79e9n9YL7E/XAV+9MhWvqAlh6H7y+BXbmuK6Gi/1qAhRWw4I9rq6ksSuGv95eIXgbzCwqPIhNcwJwsq6swwszKgpOTevw83SEIJMXHsq1heMb+fqvd58ueJ2Y7r0ZPfVOV5cibhByz4ib0VNPPbVL07R1CxYs+GVb9jtXdeH7klpQNTh9DbFAARRFP861igu8vrpsY/yh9Bo7FE0GcLRzK+QVw1+tagegl1cwh2qab8f1MZqZHdyXQd7hGBWF49ZSlhYfJc+u3yET/GO5K6gXL2Sta9inv3cYP4sYzvOn11Gj2rkvpC8RZh/WV2Rxf0hfShxW/pa3k2iLH/eG9CXeMxCb6iTTWsI/C/bj0FQm+scyLSCeQJMnZ20VfFyUwem68havRUFhZlAPxvlF42e0UGCvYUVpJiespU22/XPcZFaXnmBDRVbDspejRnPSWsanxUfwNph5JCyRBM8gLIqRbFsF/y48yGCfLswK7IlBUZjffQYaGj89tRa75qSXVzD3BPchyuJHmcPKl2XH2V6p/3nS0vWL9leQm01xQS57Nq9l2Lhp8oYurkjuGXEz0jRtODBg7ty5LwN/bGsIbImPBf57AvQLhzBvKLXCxwdh0X59va8FNj4OT38Jt/eGyfHwzGo4kA9PD9dbE3094FiRvu3qTPhgn75vhC+8NBaSoqDOCSuPwtu79AEMa+aAQYF3ZunbLky/0EJ5KX8P+PkYmBAHRgWOFcOrm5pu1y0QPrsf7lsCJ0r0ZRYjbPsB/PxrSD0NCSF6TX1CweqAPbnwyrfw11tgeJRe65ND9et7/HP9GLP7wZxBEO4D3xXrrZWHC/R1i2fDN8f1a3looP7avb+3Pf5lLrhi+DtWW8L+mgJ+3GUY6ytOs67sFGXOuob1RkXh+YgR1GoO3ji3E4emcXtQT16MGsW8M2mUX7Tt5dg0JzEe/kwLiGd+fjolDishJi9ejBzFruo8Pjx7CItiJM7DH4emMt4vhjuDe/HOuT2csVUwLSCeZ7sm8eszG6l22ps9x70hfUjy7cq/Cg+SZ6si2uJHqcPaypeqsSkB3Yi2+PH7s1uwak56egZR6bSxvjyLEJM3sRZ/3jind5PbNSeRFl+ejUji4+IMdlbmkuAVzNNdhlLmsHK0trjZ6xcdx+lwALBv+wZ5QxetIveMuEl5nP/v8/UhcDe07o27BbV22JWrd3WW1sLoGPjdZP05wN25UKf/r8Qr4+Gjg/Dmdiiz6gFqQhz88ls9aPUNg/+55cL2HiZ4bxbsyYPbPtKD5d9uBbsK7+2CB5fCV4/Ac2v0AGZzNl+f0QDv3AY2VQ+gVTYY2hWKaiAhuO3X++JYKKiGZ78CTxMM7KK3Yv5yHXxwN2zJ1sNbfevd3X3hJyPg+TV68Ht4ILx9G9z5Hyi36td7Tz/YcRYe+Uxf1t6uGP5UNN7L38sU/25MD4xnkn8caZVnWFp8FIemMsi7C1EefrySndoQpBYWHOAPsckk+8exovS7VhWiAQYUFuSnU32+tXFWUE8qnDY+KjyMht4enGOrBGB6YHfWl5/m+PlWu1Wlx5kc0I2h3hGkVZ5pcnxfo4VJ/nF8UHSQw+dbMEvOD+7wNVpaVeOlLIoRs8FImb2uUauoU1PR0KhTL9x5UwK6cdJaRlqFXtuhmkIO1RQy1i+ao7XFzV7/Zc994AyW/U2vswW/nTt37m/bcGk3jLfn/fSa9q9/Q9+/PZWc08fboyTRCd5KecZl576Z75lD27ZQePYMk+59wNWltLudqavZmbq6vQ53M/5OrQ+Bzw3KeKVof//XrvpAqgafZVz4eXUmPDQAxsbq4a++B3NVJiw5rH8f4Anf6wspqZCepy/bcVYPQvW9wZPj9Zay17foyyvq4D+H4LFB8O4uPXQC2BxQc5m30fGx0CcMbl8MeXqk4Ow1PqcYcP7VK6nVWwNBbwVUNT30XVzPY4PgPwdh3zn95/f36K/P5HhYfgQ0DXIq4PebLlx7e2vVaF9V01hbfooNFVmM84thdkgf/IwW/pG/j24eAZQ6rI1a0Gyak9N15cR6+LepmAqnrVHwifcMJNNa0hD86lkUI+Fmb24J7M7UgAtDjkyKQqDJs9ljx1n8MSgKx2qL21RTS1Irskj0DuN3MRPYV53PV2UnyK5r+e6JsfgTZfHjjW7TGpYZFIXT1gsPSlx6/ZdjGxiDbWBMK6vV5i0e/3hKKze+oezPqUtRFKVNv4QvDg5Gkxmnw87AUcmMmXpnp4SK7KNH2Jv6LUW5OSgGA6FdIxk+9RaievTs8HPfLJ5JeatTz+fqe+Zi7778cxRFwWAw4OXrR/cBAxl1620YTa36dX5Z1ppqbNabs9dhRPJMRiTPbJdjaZo2b1CUR0q7HMyF5s6de/GbqxXw1DTtzf39XrMCVx1uDQo8PgSmxOvdt3UOfQqVzJLG25266ImrvqH6fnvzWj5u7xAwG+GbOY3PZTLoX601oAvkVlwIftfq7zvgr9NhzSOw8hgs3AfFNc1v62mCmAB4bLDe4lfPbNCDbb1TZR0X/KCV4a+eQ1NJrchCRePh0P58ZDiMQVFwak2fRHRqKkbl2qYRNLewv0HRH+f8d+EhdrZyuhlTO49OrnTa+EPOVvp5hXJLYHd+ETmaN/J2kWktaXZ7AwrbqnL4sPBQu9Yhrk79G/ig82/gnSUzfS8bly9hzG13cOucx9E0jbzTp7B4eFx55xuIpqoohptrGlFX3TPNufvpn9IlJpby4iLWLv4329esYuysxjVpmoaiXE+Pvjd2M94jN6iG0PePf/zjZYCh7y5IuZYDzhkEDw6An6zSn9sDeHeWHtRa4mXW/9tSVy3o+5+tgLs/vpbq9Gf22jNYHcyHWYthRoIe6ibFw8Of6V3ZlzKev+X/30ZY48KOg6v6U7FO1bs9VDRybJVMCeiGv9GDivPP9xlQiPbwb5gH0Ko6mkwNY2lFMCy01xDnEdBkuVV1UOaw0sszuNXhr9BeDdDQUnklzdVsbmYEb0ZtERm1RfwicjTDfCPItJagojUE1Hq59ip6egahoDRpyRSdKzwylujuvTv9DVx1OklbuYzxd36P3sOSGpZ3TxzQ8H1FSTGbli3lXPZpzBYPEseMY9ikKaAo7N2wjsKzZwmJjOTU4UPUVFQwfOp0+o8ag91mI3XpJ+RnZ6FpGj0HDWH0zFls/XIFdVYrk2bfD0BVeRmLfj+PJ+e9hoeXF1+8/x7RPRMoLyoiL+s0qsPBtIfmcPpIBllHDlNbVcWYWXfSc9BgAIryctm0bAmVpaV4+/kx6d4HCI2MIj87izWLFjLxe7PZvPJz+iSNYPiU6Z36+nYkV90zl6UoBISGEZ84kJzjmQB8+f58Ynr3Ie/USXJPnuD7v/kdOccz2bb6C8qLivALCmLkrbcR3z8RALutjrTPl5F99AgGkxFVVekap/emnD5ymC0rP+fhX/yq4ZQf/en3jJl1B/H9B+Cw29i88nNOHjyAoijE9O7D1Acepq6mho3Ll5B36hRGk4mRt84kYfBQAOa/8iK3zPk+u9d+jaePD7OefKqTXzRxMUVRdquq+m196Gsvo6Jha/aF4Ad6y9bl1I8gjg+80GpWPwq43slSeCARuvhCflWTQ+A8/9ZqvMK5zpTrA0eCvfRu2supPt8Z53VRWvJsJjnZnLDiKKw7CesehWGR8O1Jfa7Ai+uptunPBw6LvM7DXy+vYMb5xZBefY5Cew0hZm/uCu7FgZoCrKqDvVXnuC2wJ0+GD+KT4iPYVAdTA+PxVExsLNdHyp6pq8CsGEjy7cruqjz6e4fxQGh/4PJDsjdWZPNc1xHcF9KXjRXZaECkxZd91fmsr8jirqBe5Nur2VeTjwGFnp5BHKgpoNJpa3KsXFsVmdYS7g3pi01TybVVEm72Od9lXYsGdPcMIquughrVTnZdBUN9IthYkY1RURpG42bW6i17cR4BODWVIkctYSZvgs1eDWG32F7LRP9YengG4dBUztmrSK3I4qXIUTwaNoB15aewqg6iLH5UOm2c6oSpc8QF9819ySXnzT+Thc1qpeegIc2uV51OvvznfHoPTWLmEz+koriYL95/F4uHBwPGjsdoNJF1NIMeAwdx789eIPfkCX37YUmcOLCP8uKihjfqqrKmI9ibYzSZOLx9G7c98UOSw7uwaflSVsx/m0n3PsCI6bdyOuMQG5Z8Qs9Bg3HYbaz65wKGJE9m4LgJHN29kzWLFvLwS69gNJqoqarkxMED3P/CS5gtV/cc7fXKVfdMSxx2O6qqUpSbw9FdO+g3cjQABpOJ9I3rmfbgHG599HHKCgtY8++F3Pro40T37EX2saOsWfR/3POT5wiNimLTsqVYa6p5+OVfY7ZY2P7VKsqLWjc776bln1FTWcEjL/8ak9lMaUE+AOuXfIzBYODRV35DWVERS//3r4RHxxAQGobRZGLPt2u5Zc7j+AUFddjrI1pn/vz5SVfequ3yq2BwhN69CXpg6x8OOZfpZj1aqHcDPzdKH3WraTB3uD7at963J+HpJHh9Gvxtm95t29UPQrz1dTV2vbVteg/ILtcHiJxopjNu7Qn40XB4bQq8uUMflJIYDpuy9MEfAMMj9WcPi2v0gSCzeukDVmIDICX5/DiF8wFmZDScLYeyOhgZpXdN1099k1sJY2L07mA/Cxwq0CeQ/kkSZJXpzwcaFRjcFdKyrhxG28sVw1+d6kQBZof0JdDoQY1qZ191PstKjunrNSd/zdvBfSF9eSlyFApw3FrK67nbGkYF59mrWF5yjPtD+vFQaH8O1RTyfn46/xU5CovB2OJzbkdri3k/fx8zg3ow0T+WGtXOoZoi9lXn803ZSVRN06eRCe5FjWrndF05mdaSZsMfwLv5e7kvpC9Phg/CrBjIt1WzpOQoBfZq1pefZkZgDxTgy9LjLC/9jifCBvJ63GRKHVa+KM3EiKGhNbC7ZyDTA+IJMHpSpdrYUZXLpopsALZV5TDQJ5znuyZR4bTxzrk9nLSW8da5PdwelMAvo0Zj11TO2ar5suzmemBctKymogIPL68Wn806eyKTuppahk6agmIwEBgWxsBxE8nYuZ0BY8eDohARF98QHiO6xeOw26kqKyMwLJzS/HwObkmjb9JI/IJaN2RNURT6jRxNUHgXAMKiYyjOy204R3hMHLXVVdisVvJOncRht+m1AH2GJZH2+TIKc3MwGAygaUz83r2YzOZrfanEFXzz0QfY62z4+PvTJ2kkQyZOAvRWkj7DRjQ8P3p0905iEnoTk9AbgLg+fYnt3Yeje3YyKvw2Mvenc89Pnm0I6yZL6/7t7DYb36Xv4e6nf4rFU3/OOqRrJDarldNHDjP7p8+jGAwEhYcT2aMnpw4fYvD5GkdMnyHB7yb3zi54dQosuU9v5fr4IHxz4vLP5WnoU6f890RYeJc+4OG93foo3PopbyttMHclPD8a/ncGGAx6AFxx9MJx/rxFXz+1B3yVqQ+auFSpVR/l+8IYeP8OfbRwRqE+FcvePD30vTkDnlmlD1CZl6qPRN70hB5S/5AGf595oat6ZgKMi9WDak4lpGy4EDr/sRd+Pxk+nq0/xzdnGSzap7cIzu4Hz4yEyjo9FO7Nu47CX1ZdOf8s2H/ZbUodVubnp192mzVlJ1lTdrLRsqdOftXw/YqS71hR0nRk8O7qPHZXN30CVAPWlp9ibfmpy573YtVOOwsLDjS77tPiI3xafKTh5yJ7Da/nbm9cS9WFOjaUZ7GhPIvmWFVHs5/uUT/CtzktXX9zFLNxI2iprdoYMECrtxUdx+LlRV1tLarTicHY9BGCqtJSfPz9Gz0HFRgaRlV58y3DhvPbqU4HEXHduOWRx9i5dg271q5hwt2zG7ra2uLSZ8QunMNJdUU5Drud//zljw3rTRYz1ppqvH39QFEk+HWSmd//AV1i45pdd3GAqywrxTcwsNH6gNAwKoqLqS4vR3U68Q8JafP5ayr0fQPDwhovr6xEU1XWLl5Efb+O3VZHWFR0s/WJG9/ig/rXxQqq9ZDWEqcKw+Y3XZ5VDj+4aD9vM/h5NA5EWeX6VC4tWXO8dd2px4rhqS+aX/eDS2rfegbuuuQ5w+n/vvD9bze0fJ7MYn2OwEt9eED/as4TK1o+XrOM5jZmAkPqtQ8PE53O7OmRuvAmHb17M4uI7YbBYOD4gX30GjKsyXpvP3/KS4r1P3PPh7DqinJ8AwKbbNuc2D59ie3Tl8x9e0ld+ik9Bg7GYDShOi/zBHUbePr44uMfwEMvNp0Htij3OvksJdGIt58/ZYUFjZZVV5TjGxiI6Xxrn7WmBg8v7yb7Go0mVLX5e8fi6QXoYe/ifb18fEBRuOOHP24SOoW4ksnxesPOd8V6K+EPh+rduNvOurqy65vJMyD1wPOBKW3ZR4ZaCdFJzB4ejJg+g42fLSFjxzZqq/Tu1PzsLHJOHCc6oRcenl7sWb8OTVWpKi9j/+ZN9Bs56orHtlZXU1er/3nsFxTc8DBtQGgoRTlnUZ1OHHY7O9bUz3PW9kFH0T0TsFmt7E/bqAdKTaP43GXmZRAu13vIcHKOZ3I2U+9VOJd1iqwjGfQZNgIf/wCCu0SQnroep8NBSf45Tuzfh3Z+9gb/kBCqKyr050c1jUNbN1NRWoKmgZevL127xbNjzSpsViuaqlJeVIiHtzfRPRPY9tUXDVPGVJaW3rTTx4j25WXWp4hZfA98dA+EesOPv9QHSYj2JS1/QnSiwRMn4RsYyIHNaWz5cgVoGgEhoQyakExUj57M+sFTbFq+lPSN67F4eJI4ZhwDRo+74nHzTp8kbcUyVFXF29ePqQ88gsFgIGHwEE4c3M+Hf3oV34Aghk+bznfpe3DaHeDVttotnp7MenIum1cuZ+fXqzFZLIRFRnPLo9+/uhdDdLjQqCimPjiHtJXLqSorxS8omKkPPEJoVBQAUx+aw/qPP+L93/ySiLhudOufSOFZffL4gJBQBo1PZulbb+Dt50ff4SOJiO2G06E/oz3toUfZuOxTPng1BbPFQnziACZ+716mPvgIacs/Y9Fr8zAYjPgFBzPpnvsbzilES1Z9p3+JjqcAzD2xKgXaNlGucCVt3oIet6W4uorrwdVM8nw5b6U8w49f/1t7HU50gHdeer7TJ3m+HLlnrn/tfc/cLJM8t2Tou1oKytVP8iw6mca8vU8rKW3ZRbp9hRBCCCHciIQ/IYQQQgg3IuFPCCGEEMKNSPgTQgghhHAjEv6EEEIIIdyIhD8hhBBCCDci4U8IIYQQwo1I+BNCCCGEcCMmAINqSFUNqqtrEa1kUA2prq5BCCHEzckAqWrbPwFSuIgBUtu6jwngvYQZqVzFzkIIIYS4uex+WklFMsFNTbp9hRBCCCHciIQ/IYQQQgg3IuFPCCGEEMKNmFxdgBDXk6j4BN556XlXlyEuIyo+wdUlNCL3zPXvertnhHA1CX9CXOTux551dQniBiP3jBDiRiPdvkIIIYQQbkTCnxBCCCGEG5HwJ4QQQgjhRiT8CSGEEEK4EQl/QgghhBBuRMKfEEIIIYQbkfAnhBBCCOFGJPwJIYQQQrgRCX9CCCGEEG5Ewp8QQgghhBuR8CeEEEII4UYk/AkhhBBCuBEJf0IIIYQQbkTCnxBCCCGEGzG5ugAhroXBYEhVVdXVZQgh3IjBYEh1dQ1CCCGEEEII0Sr/H1ln1nGe8ZwYAAAAAElFTkSuQmCC" width="639" height="97" class="img_ev3q"></p></center>
<div class="theme-admonition theme-admonition-warning admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>Restrictions</div><div class="admonitionContent_BuS1"><ul>
<li>The IP addresses and port numbers of the nodes in the source cluster
cannot be the same as those of the nodes in the target cluster.
Otherwise, data will be replicated infinitely in a topic.</li>
<li>Use MirrorMaker to synchronize data between at least two clusters.
If there is only one cluster, data will be replicated infinitely in
a topic.</li>
</ul></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="installing-and-configuring-mirrormaker">Installing and Configuring MirrorMaker<a href="#installing-and-configuring-mirrormaker" class="hash-link" aria-label="Direct link to Installing and Configuring MirrorMaker" title="Direct link to Installing and Configuring MirrorMaker">​</a></h3>
<ol>
<li>
<p>Create an ECS that can communicate with the source and target
clusters. For details, see the <a href="https://docs.otc.t-systems.com/elastic-cloud-server/index.html" target="_blank" rel="noopener noreferrer">ECS
documentation</a>.</p>
</li>
<li>
<p>Log in to the ECS, install JDK, and add the following contents to
<strong>.bash_profile</strong> in the home directory to configure the
environment variables <code>JAVA\_HOME</code> and <code>PATH</code>. In this command,
<strong>/opt/java/jdk1.8.0_151</strong> is the JDK installation path. Change it
to the path where you install JDK.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(220, 13%, 18%);--prism-color:hsl(220, 14%, 71%)"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="background-color:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token builtin class-name" style="color:hsl(29, 54%, 61%)">export</span><span class="token plain"> </span><span class="token assign-left variable" style="color:hsl(207, 82%, 66%)">JAVA_HOME</span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain">/opt/java/jdk1.8.0_151</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain"></span><span class="token builtin class-name" style="color:hsl(29, 54%, 61%)">export</span><span class="token plain"> </span><span class="token assign-left variable environment constant" style="color:hsl(29, 54%, 61%)">PATH</span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token variable" style="color:hsl(207, 82%, 66%)">$JAVA_HOME</span><span class="token plain">/bin:</span><span class="token environment constant" style="color:hsl(29, 54%, 61%)">$PATH</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Run the <code>source .bash\_profile</code> command for the modification to
take effect.</p>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><p>Use Oracle JDK instead of ECS&#x27;s default JDK (for example, OpenJDK),
because ECS&#x27;s default JDK may not be suitable. Obtain Oracle JDK
1.8.111 or later from <a href="https://www.oracle.com/java/technologies/downloads/#java8" target="_blank" rel="noopener noreferrer">Oracle&#x27;s official website</a>.</p></div></div>
</li>
<li>
<p>Download the binary software package of Kafka 3.3.1.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(220, 13%, 18%);--prism-color:hsl(220, 14%, 71%)"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="background-color:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token function" style="color:hsl(207, 82%, 66%)">wget</span><span class="token plain"> https://archive.apache.org/dist/kafka/3.3.1/kafka_2.12-3.3.1.tgz</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Decompress the binary software package.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(220, 13%, 18%);--prism-color:hsl(220, 14%, 71%)"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="background-color:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token function" style="color:hsl(207, 82%, 66%)">tar</span><span class="token plain"> </span><span class="token parameter variable" style="color:hsl(207, 82%, 66%)">-zxvf</span><span class="token plain"> kafka_2.12-3.3.1.tgz</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Go to the binary software package directory and specify the IP
addresses and ports of the source and target clusters and other
parameters in the <strong>connect-mirror-maker.properties</strong> configuration
file in the <strong>config</strong> directory.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(220, 13%, 18%);--prism-color:hsl(220, 14%, 71%)"><div class="codeBlockTitle_Ktv7">connect-mirror-maker.properties</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="background-color:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token comment" style="color:hsl(220, 10%, 40%)"># Specify two clusters.</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">clusters </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> A, B</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">A.bootstrap.servers </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> A_host1:A_port, A_host2:A_port, A_host3:A_port</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">B.bootstrap.servers </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> B_host1:B_port, B_host2:B_port, B_host3:B_port</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain"></span><span class="token comment" style="color:hsl(220, 10%, 40%)"># Specify the data synchronization direction. The data can be synchronized unidirectionally or bidirectionally.</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">A-</span><span class="token operator" style="color:hsl(207, 82%, 66%)">&gt;</span><span class="token plain">B.enabled </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> </span><span class="token boolean" style="color:hsl(29, 54%, 61%)">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain"></span><span class="token comment" style="color:hsl(220, 10%, 40%)"># Specify the topics to be synchronized. Regular expressions are supported. By default, all topics are replicated, for example, foo-.*.</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">A-</span><span class="token operator" style="color:hsl(207, 82%, 66%)">&gt;</span><span class="token plain">B.topics </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> .*</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain"></span><span class="token comment" style="color:hsl(220, 10%, 40%)"># If the following two configurations are enabled, clusters A and B replicate data with each other.</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain"></span><span class="token comment" style="color:hsl(220, 10%, 40%)">#B-&gt;A.enabled = true</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain"></span><span class="token comment" style="color:hsl(220, 10%, 40%)">#B-&gt;A.topics = .*</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain"></span><span class="token comment" style="color:hsl(220, 10%, 40%)"># Specify the number of replicas. If multiple topics need to be synchronized and their replica quantities are different, create topics with the same name and replica quantity before starting MirrorMaker.</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain"></span><span class="token assign-left variable" style="color:hsl(207, 82%, 66%)">replication.factor</span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token number" style="color:hsl(29, 54%, 61%)">3</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain"></span><span class="token comment" style="color:hsl(220, 10%, 40%)"># Specify the consumer offset synchronization direction (unidirectionally or bidirectionally).</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">A-</span><span class="token operator" style="color:hsl(207, 82%, 66%)">&gt;</span><span class="token plain">B.sync.group.offsets.enabled</span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain">true</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain"></span><span class="token comment" style="color:hsl(220, 10%, 40%)">############################# Internal Topic Settings  #############################</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain"></span><span class="token comment" style="color:hsl(220, 10%, 40%)"># The replication factor for mm2 internal topics &quot;heartbeats&quot;, &quot;B.checkpoints.internal&quot; and</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain"></span><span class="token comment" style="color:hsl(220, 10%, 40%)"># &quot;mm2-offset-syncs.B.internal&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain"></span><span class="token comment" style="color:hsl(220, 10%, 40%)"># In the test environment, the value can be 1. In the production environment, it is recommended that the value be greater than 1, for example, 3.</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain"></span><span class="token assign-left variable" style="color:hsl(207, 82%, 66%)">checkpoints.topic.replication.factor</span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token number" style="color:hsl(29, 54%, 61%)">3</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain"></span><span class="token assign-left variable" style="color:hsl(207, 82%, 66%)">heartbeats.topic.replication.factor</span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token number" style="color:hsl(29, 54%, 61%)">3</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">offset-syncs.topic.replication.factor</span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token number" style="color:hsl(29, 54%, 61%)">3</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain"></span><span class="token comment" style="color:hsl(220, 10%, 40%)"># The replication factor for connect internal topics &quot;mm2-configs.B.internal&quot;, &quot;mm2-offsets.B.internal&quot; and</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain"></span><span class="token comment" style="color:hsl(220, 10%, 40%)"># &quot;mm2-status.B.internal&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain"></span><span class="token comment" style="color:hsl(220, 10%, 40%)"># In the test environment, the value can be 1. In the production environment, it is recommended that the value be greater than 1, for example, 3.</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain"></span><span class="token assign-left variable" style="color:hsl(207, 82%, 66%)">offset.storage.replication.factor</span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token number" style="color:hsl(29, 54%, 61%)">3</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain"></span><span class="token assign-left variable" style="color:hsl(207, 82%, 66%)">status.storage.replication.factor</span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token number" style="color:hsl(29, 54%, 61%)">3</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain"></span><span class="token assign-left variable" style="color:hsl(207, 82%, 66%)">config.storage.replication.factor</span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token number" style="color:hsl(29, 54%, 61%)">3</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain"></span><span class="token comment" style="color:hsl(220, 10%, 40%)"># customize as needed</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain"></span><span class="token comment" style="color:hsl(220, 10%, 40%)"># replication.policy.separator = _</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain"></span><span class="token comment" style="color:hsl(220, 10%, 40%)"># sync.topic.acls.enabled = false</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain"></span><span class="token comment" style="color:hsl(220, 10%, 40%)"># emit.heartbeats.interval.seconds = 5</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>In the binary software package directory, start MirrorMaker to
synchronize data.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(220, 13%, 18%);--prism-color:hsl(220, 14%, 71%)"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="background-color:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">./bin/connect-mirror-maker.sh config/connect-mirror-maker.properties</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>(Optional) If a topic is created in the source cluster after
MirrorMaker has been started, and the topic data needs to be
synchronized, restart MirrorMaker.</p>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><p>To periodically synchronize new topics without restarting MirrorMaker.
<code>refresh.topics.interval.seconds</code> is mandatory. Other parameters are optional.</p></div></div>
</li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="mirrormaker-configuration-properties">MirrorMaker Configuration Properties<a href="#mirrormaker-configuration-properties" class="hash-link" aria-label="Direct link to MirrorMaker Configuration Properties" title="Direct link to MirrorMaker Configuration Properties">​</a></h3>
<table><thead><tr><th>Parameter</th><th>Default Value</th><th>Description</th></tr></thead><tbody><tr><td>sync.topic.configs.enabled</td><td>true</td><td>Whether to monitor the source cluster for configuration changes.</td></tr><tr><td>sync.topic.acls.enabled</td><td>true</td><td>Whether to monitor the source cluster for ACL changes.</td></tr><tr><td>emit.heartbeats.enabled</td><td>true</td><td>Whether to let the connector send heartbeats periodically.</td></tr><tr><td>emit.heartbeats.interval.seconds</td><td>5 seconds</td><td>Heartbeat frequency.</td></tr><tr><td>emit.checkpoints.enabled</td><td>true</td><td>Whether to let the connector periodically send the consumer offset information.</td></tr><tr><td>emit.checkpoints.interval.seconds</td><td>5 seconds</td><td>Checkpoint frequency.</td></tr><tr><td>refresh.topics.enabled</td><td>true</td><td>Whether to let the connector periodically check for new topics.</td></tr><tr><td>refresh.topics.interval.seconds</td><td>5 seconds</td><td>Frequency of checking for new topics in the source cluster.</td></tr><tr><td>refresh.groups.enabled</td><td>true</td><td>Whether to let the connector periodically check for new consumer groups.</td></tr><tr><td>refresh.groups.interval.seconds</td><td>5 seconds</td><td>Frequency of checking for new consumer groups in the source cluster.</td></tr><tr><td>replication.policy.class</td><td>org.apache.kafka.connect.mirror.DefaultReplicationPolicy</td><td>Use LegacyReplicationPolicy to imitate MirrorMaker of an earlier version.</td></tr><tr><td>heartbeats.topic.retention.ms</td><td>One day</td><td>Used when heartbeat topics are created for the first time.</td></tr><tr><td>checkpoints.topic.retention.ms</td><td>One day</td><td>Used when checkpoint topics are created for the first time.</td></tr><tr><td>offset.syncs.topic.retention.ms</td><td>max long</td><td>Used when offset sync topics are created for the first time.</td></tr></tbody></table>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="verifying-data-synchronization">Verifying Data Synchronization<a href="#verifying-data-synchronization" class="hash-link" aria-label="Direct link to Verifying Data Synchronization" title="Direct link to Verifying Data Synchronization">​</a></h3>
<ol>
<li>
<p>View the topic list in the target cluster to check whether there are
source topics.</p>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><p>Topic names in the target cluster have a prefix (for example,
<code>A.</code>) added to the source topic name. This is a MirrorMaker 2
configuration for preventing cyclic topic backup.</p></div></div>
</li>
<li>
<p>Produce and consume messages in the source cluster, view the
consumption progress in the target cluster, and check whether data
has been synchronized from the source cluster to the target cluster.</p>
<p>If the target cluster is a Open Telekom Cloud Kafka instance, view
the consumption progress on the <em>Consumer Groups</em> page.</p>
</li>
</ol></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-tags-row"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/docs-next/pr-preview/pr-203/docs/tags/kafka">kafka</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/docs-next/pr-preview/pr-203/docs/tags/mirror-maker">mirror-maker</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/docs-next/pr-preview/pr-203/docs/tags/migration">migration</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/docs-next/pr-preview/pr-203/docs/tags/dms">dms</a></li></ul></div></div><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/opentelekomcloud/docs-next/tree/main/docs/best-practices/application-services/distributed-message-service/migrating-kafka-services.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs-next/pr-preview/pr-203/docs/best-practices/application-services/api-gateway/selectively-exposing-cce-workloads-with-a-dedicated-gateway"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Selectively Exposing CCE Workloads with a Dedicated Gateway</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs-next/pr-preview/pr-203/docs/best-practices/application-services/distributed-message-service/improving-kafka-message-processing-efficiency"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Improving Kafka Message Processing Efficiency</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#prerequisites" class="table-of-contents__link toc-highlight">Prerequisites</a></li><li><a href="#migration-scheme-1-migrating-the-production-first" class="table-of-contents__link toc-highlight">Migration Scheme 1: Migrating the Production First</a></li><li><a href="#migration-scheme-2-migrating-the-production-later" class="table-of-contents__link toc-highlight">Migration Scheme 2: Migrating the Production Later</a></li><li><a href="#how-do-i-migrate-persisted-data-along-with-services" class="table-of-contents__link toc-highlight">How Do I Migrate Persisted Data Along with Services?</a></li><li><a href="#using-mirrormaker-to-synchronize-data-across-clusters" class="table-of-contents__link toc-highlight">Using MirrorMaker to Synchronize Data Across Clusters</a><ul><li><a href="#solution-design" class="table-of-contents__link toc-highlight">Solution Design</a></li><li><a href="#installing-and-configuring-mirrormaker" class="table-of-contents__link toc-highlight">Installing and Configuring MirrorMaker</a></li><li><a href="#mirrormaker-configuration-properties" class="table-of-contents__link toc-highlight">MirrorMaker Configuration Properties</a></li><li><a href="#verifying-data-synchronization" class="table-of-contents__link toc-highlight">Verifying Data Synchronization</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="align-items-center" style="margin:0 0 0 32px"><div class="col-10 text-right"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://docs.otc.t-systems.com/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Help Center</a></li><li class="footer__item"><a href="https://www.open-telekom-cloud.com/en/products-services/roadmap" target="_blank" rel="noopener noreferrer" class="footer__link-item">Portfolio Roadmap</a></li><li class="footer__item"><a href="https://www.open-telekom-cloud.com/en/products-services/core-services/certifications" target="_blank" rel="noopener noreferrer" class="footer__link-item">Core Services Certifications</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://community.open-telekom-cloud.com/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Community Forums</a></li><li class="footer__item"><a href="https://www.youtube.com/watch?v=U-x2gEy3968&amp;list=PLS60dhorR-hgQ5n5L1boEQh0oVD-_k75p" target="_blank" rel="noopener noreferrer" class="footer__link-item">Webinars<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">Developers</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://docs.otc.t-systems.com/developer/sdk.html" target="_blank" rel="noopener noreferrer" class="footer__link-item">SDKs</a></li><li class="footer__item"><a href="https://docs.otc.t-systems.com/developer/drivers.html" target="_blank" rel="noopener noreferrer" class="footer__link-item">Drivers &amp; Tools</a></li><li class="footer__item"><a href="https://registry.terraform.io/providers/opentelekomcloud/opentelekomcloud/latest/docs" target="_blank" rel="noopener noreferrer" class="footer__link-item">Terraform Provider</a></li><li class="footer__item"><a href="https://docs.otc.t-systems.com/ansible-collection-cloud/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Ansible Collections</a></li><li class="footer__item"><a href="https://designer.otc-service.com/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Cloud Create</a></li></ul></div><div class="col footer__col"><div class="footer__title">API</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://docs.otc.t-systems.com/developer/api.html" target="_blank" rel="noopener noreferrer" class="footer__link-item">REST API</a></li><li class="footer__item"><a href="https://docs.otc.t-systems.com/developer/api_guidelines/index.html" target="_blank" rel="noopener noreferrer" class="footer__link-item">REST API Usage Guidelines</a></li><li class="footer__item"><a href="https://docs.otc.t-systems.com/regions-and-endpoints/index.html" target="_blank" rel="noopener noreferrer" class="footer__link-item">Endpoints</a></li><li class="footer__item"><a href="https://status.otc-service.com/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Status Dashboard</a></li></ul></div></div></div></div></div><scale-telekom-footer type="minimal"><scale-telekom-footer-content><span slot="notice">© T-Systems International GmbH 2025 (0.1.PR203-77-7f803d8-ephemeral)</span><ul slot="navigation"><li><a href="https://open-telekom-cloud.com/en/contact"> Contact </a></li><li><a href="https://open-telekom-cloud.com/en/data-protection"> Data privacy </a></li><li><a href="https://open-telekom-cloud.com/en/disclaimer-of-liability"> Disclaimer of liabilities </a></li><li><a href="https://open-telekom-cloud.com/en/imprint"> Imprint </a></li></ul></scale-telekom-footer-content></scale-telekom-footer></footer></div>
</body>
</html>