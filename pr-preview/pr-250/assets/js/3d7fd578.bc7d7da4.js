"use strict";(self.webpackChunkdocs_next=self.webpackChunkdocs_next||[]).push([[21613],{31820:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>d,contentTitle:()=>c,default:()=>h,frontMatter:()=>a,metadata:()=>t,toc:()=>l});const t=JSON.parse('{"id":"best-practices/networking/elastic-load-balancing/routing-traffic-to-backend-servers-in-the-same-vpc-as-the-load-balancer","title":"Routing Traffic to Backend Servers in the Same VPC as the Load Balancer","description":"You can route traffic to backend servers in the VPC where the load balancer is running.","source":"@site/docs/best-practices/networking/elastic-load-balancing/routing-traffic-to-backend-servers-in-the-same-vpc-as-the-load-balancer.md","sourceDirName":"best-practices/networking/elastic-load-balancing","slug":"/best-practices/networking/elastic-load-balancing/routing-traffic-to-backend-servers-in-the-same-vpc-as-the-load-balancer","permalink":"/docs-next/pr-preview/pr-250/docs/best-practices/networking/elastic-load-balancing/routing-traffic-to-backend-servers-in-the-same-vpc-as-the-load-balancer","draft":false,"unlisted":false,"editUrl":"https://github.com/opentelekomcloud/docs-next/tree/main/docs/best-practices/networking/elastic-load-balancing/routing-traffic-to-backend-servers-in-the-same-vpc-as-the-load-balancer.md","tags":[{"inline":true,"label":"vpc","permalink":"/docs-next/pr-preview/pr-250/docs/tags/vpc"},{"inline":true,"label":"elb","permalink":"/docs-next/pr-preview/pr-250/docs/tags/elb"},{"inline":true,"label":"load-balancing","permalink":"/docs-next/pr-preview/pr-250/docs/tags/load-balancing"}],"version":"current","frontMatter":{"id":"routing-traffic-to-backend-servers-in-the-same-vpc-as-the-load-balancer","title":"Routing Traffic to Backend Servers in the Same VPC as the Load Balancer","tags":["vpc","elb","load-balancing"]},"sidebar":"bestPracticesSidebar","previous":{"title":"Using Advanced Forwarding for Application Iteration","permalink":"/docs-next/pr-preview/pr-250/docs/best-practices/networking/elastic-load-balancing/using-advanced-forwarding-for-application-iteration"},"next":{"title":"Routing Traffic to Backend Servers in Different VPCs from the Load Balancer","permalink":"/docs-next/pr-preview/pr-250/docs/best-practices/networking/elastic-load-balancing/routing-traffic-to-backend-servers-in-different-vpcs-from-the-load-balancer"}}');var r=s(74848),i=s(28453);const a={id:"routing-traffic-to-backend-servers-in-the-same-vpc-as-the-load-balancer",title:"Routing Traffic to Backend Servers in the Same VPC as the Load Balancer",tags:["vpc","elb","load-balancing"]},c="Routing Traffic to Backend Servers in the Same VPC as the Load Balancer",d={},l=[{value:"Solution Design",id:"solution-design",level:2},{value:"Prerequisites",id:"prerequisites",level:3},{value:"Procedure",id:"procedure",level:3},{value:"Creating a VPC",id:"creating-a-vpc",level:2},{value:"Creating an ECS",id:"creating-an-ecs",level:2},{value:"Creating a Dedicated Load Balancer and Adding an HTTP Listener and a Backend Server Group to the Load Balancer",id:"creating-a-dedicated-load-balancer-and-adding-an-http-listener-and-a-backend-server-group-to-the-load-balancer",level:2},{value:"Adding the ECS to the Backend Server Group",id:"adding-the-ecs-to-the-backend-server-group",level:2},{value:"Verifying Traffic Routing",id:"verifying-traffic-routing",level:2}];function o(e){const n={a:"a",admonition:"admonition",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",header:"header",img:"img",li:"li",ol:"ol",p:"p",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,i.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"routing-traffic-to-backend-servers-in-the-same-vpc-as-the-load-balancer",children:"Routing Traffic to Backend Servers in the Same VPC as the Load Balancer"})}),"\n",(0,r.jsx)(n.p,{children:"You can route traffic to backend servers in the VPC where the load balancer is running."}),"\n",(0,r.jsx)(n.h2,{id:"solution-design",children:"Solution Design"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["A dedicated load balancer ",(0,r.jsx)(n.code,{children:"ELB-Test"})," is running in a VPC named\n",(0,r.jsx)(n.code,{children:"vpc-Test"})," (",(0,r.jsx)(n.code,{children:"10.1.0.0/16"}),")."]}),"\n",(0,r.jsxs)(n.li,{children:["The backend server ",(0,r.jsx)(n.code,{children:"ECS-Test"})," is also running in ",(0,r.jsx)(n.code,{children:"vpc-Test"}),"\n(",(0,r.jsx)(n.code,{children:"10.1.0.0/16"}),")."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"ECS-Test"})," needs to be added to the backend server group\nassociated with ",(0,r.jsx)(n.code,{children:"ELB-Test"}),"."]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{src:"https://arch-assets-dev.obs.eu-de.otc.t-systems.com/static/img/docs/best-practices/networking/elastic-load-balancing/en-us_image_0000001625619218.png",alt:"Figure 1 Adding a backend server in the same VPC as the load\nbalancer"})}),"\n",(0,r.jsx)(n.admonition,{title:"Advantages",type:"note",children:(0,r.jsx)(n.p,{children:"You can add servers in the same VPC as the load balancer to the backend\nserver group of the load balancer and then route incoming traffic to the\nservers."})}),"\n",(0,r.jsx)(n.h3,{id:"prerequisites",children:"Prerequisites"}),"\n",(0,r.jsx)(n.admonition,{type:"note",children:(0,r.jsxs)(n.p,{children:["To calculate the fees you can visit Open Telekom Cloud ",(0,r.jsx)(n.a,{href:"https://open-telekom-cloud.com/en/prices/price-calculator",children:"Price\ncalculator"}),"."]})}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Resource Type"}),(0,r.jsx)(n.th,{children:"Resource Name"}),(0,r.jsx)(n.th,{children:"Description"}),(0,r.jsx)(n.th,{children:"Quantity"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"VPC"}),(0,r.jsx)(n.td,{children:"vpc-Test"}),(0,r.jsxs)(n.td,{children:["The VPC where ELB-Test and ECS-Test are running: ",(0,r.jsx)(n.code,{children:"10.1.0.0/16"})]}),(0,r.jsx)(n.td,{children:"1"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"ELB"}),(0,r.jsx)(n.td,{children:"ELB-Test"}),(0,r.jsx)(n.td,{children:"The dedicated load balancer named ELB-Test"}),(0,r.jsx)(n.td,{children:"1"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"EIP"}),(0,r.jsx)(n.td,{children:"EIP-Test"}),(0,r.jsx)(n.td,{children:"The EIP bound to ELB-Test"}),(0,r.jsx)(n.td,{children:"1"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"ECS"}),(0,r.jsx)(n.td,{children:"ECS-Test"}),(0,r.jsx)(n.td,{children:"The ECS works in vpc-Test"}),(0,r.jsx)(n.td,{children:"1"})]})]})]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Table 1"})," Resource planning"]}),"\n",(0,r.jsx)(n.h3,{id:"procedure",children:"Procedure"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{src:"https://arch-assets-dev.obs.eu-de.otc.t-systems.com/static/img/docs/best-practices/networking/elastic-load-balancing/en-us_image_0000001674059073.png",alt:"Figure 2 Process for adding backend servers in the same VPC as the\nload balancer"})}),"\n",(0,r.jsx)(n.h2,{id:"creating-a-vpc",children:"Creating a VPC"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"Log in to the management console."}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["Under ",(0,r.jsx)(n.em,{children:"Networking"}),", select ",(0,r.jsx)(n.em,{children:"Virtual Private Cloud"}),". On the\n",(0,r.jsx)(n.em,{children:"Virtual Private Cloud"})," page displayed, click ",(0,r.jsx)(n.em,{children:"Create VPC"}),"."]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["Configure the parameters as follows and click ",(0,r.jsx)(n.em,{children:"Create Now"}),". For\ndetails on how to create a VPC, see the ",(0,r.jsx)(n.a,{href:"https://docs.otc.t-systems.com/virtual-private-cloud/umn/vpc_and_subnet/vpc/creating_a_vpc.html",children:"Virtual Private Cloud User\nGuide"}),"."]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Name"}),": ",(0,r.jsx)(n.code,{children:"vpc-Test"})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"IPv4 CIDR Block"}),": ",(0,r.jsx)(n.code,{children:"10.1.0.0/16"})]}),"\n",(0,r.jsx)(n.li,{children:"Configure other parameters as required."}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{src:"https://arch-assets-dev.obs.eu-de.otc.t-systems.com/static/img/docs/best-practices/networking/elastic-load-balancing/en-us_image_0000001625459326.png",alt:"Figure 3 Creating\nvpc-Test"})}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"creating-an-ecs",children:"Creating an ECS"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["Under ",(0,r.jsx)(n.em,{children:"Computing"}),", click ",(0,r.jsx)(n.em,{children:"Elastic Cloud Server"}),"."]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["In the upper right corner, click ",(0,r.jsx)(n.em,{children:"Create ECS"}),"."]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["Configure the parameters as required. For details, see ",(0,r.jsx)(n.a,{href:"https://docs.otc.t-systems.com/elastic-cloud-server/umn/getting_started/creating_an_ecs/overview.html",children:"Elastic\nCloud Server User\nGuide"}),"."]}),"\n",(0,r.jsxs)(n.p,{children:["Select ",(0,r.jsx)(n.em,{children:"vpc-Test"})," for VPC and set ",(0,r.jsx)(n.em,{children:"Name"})," to ",(0,r.jsx)(n.code,{children:"ECS-Test"}),"."]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{src:"https://arch-assets-dev.obs.eu-de.otc.t-systems.com/static/img/docs/best-practices/networking/elastic-load-balancing/en-us_image_0000001625299518.png",alt:"Figure 6 Creating\nECS-Test"})}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"Deploy Nginx on the ECS."}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{src:"https://arch-assets-dev.obs.eu-de.otc.t-systems.com/static/img/docs/best-practices/networking/elastic-load-balancing/en-us_image_0000001625619246.png",alt:"Figure 7 Deploying Nginx on\nECS-Test"})}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"creating-a-dedicated-load-balancer-and-adding-an-http-listener-and-a-backend-server-group-to-the-load-balancer",children:"Creating a Dedicated Load Balancer and Adding an HTTP Listener and a Backend Server Group to the Load Balancer"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["Under ",(0,r.jsx)(n.em,{children:"Networking"}),", click ",(0,r.jsx)(n.em,{children:"Elastic Load Balance"}),"."]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["In the upper right corner, click ",(0,r.jsx)(n.em,{children:"Create Elastic Load Balancer"}),"."]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["Configure the parameters as follows. For details, see ",(0,r.jsx)(n.a,{href:"https://docs.otc.t-systems.com/elastic-load-balancing/umn/load_balancer/creating_a_dedicated_load_balancer.html",children:"Elastic Load\nBalance User\nGuide"}),"."]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Type"}),": ",(0,r.jsx)(n.code,{children:"Dedicated"})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"IP as a Backend"}),": ",(0,r.jsx)(n.code,{children:"Enable"})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"VPC"}),": ",(0,r.jsx)(n.code,{children:"vpc-Test"})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Name"}),": ",(0,r.jsx)(n.code,{children:"ELB-Test"})]}),"\n",(0,r.jsx)(n.li,{children:"Configure other parameters as required."}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{src:"https://arch-assets-dev.obs.eu-de.otc.t-systems.com/static/img/docs/best-practices/networking/elastic-load-balancing/en-us_image_0000001673939093.png",alt:"Figure 8 Creating a dedicated load balancer named\nELB-Test"})}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["Add an HTTP listener and a backend server group to the created\ndedicated load balancer. For details, see ",(0,r.jsx)(n.a,{href:"https://docs.otc.t-systems.com/elastic-load-balancing/umn/listener/adding_an_http_listener.html",children:"Elastic Load Balance User\nGuide"}),"."]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"adding-the-ecs-to-the-backend-server-group",children:"Adding the ECS to the Backend Server Group"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["Locate the dedicated load balancer and click its name ",(0,r.jsx)(n.em,{children:"ELB-Test"}),"."]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["On the ",(0,r.jsx)(n.em,{children:"Listeners"})," tab page, locate the HTTP listener added to the\ndedicated load balancer and click its name."]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["In the ",(0,r.jsx)(n.em,{children:"Backend Server Groups"})," tab on the right, click ",(0,r.jsx)(n.em,{children:"Add\nBackend Server"}),", configure the parameters, and click ",(0,r.jsx)(n.em,{children:"OK"}),". For\ndetails, see ",(0,r.jsx)(n.em,{children:"Elastic Load Balance User Guide"}),"."]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Backend Server"}),": ",(0,r.jsx)(n.code,{children:"ECS-Test"})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Backend Port"}),": the port enabled for Nginx on ",(0,r.jsx)(n.code,{children:"ECS-Test"})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Weight"}),": Configure this parameter as required."]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{src:"https://arch-assets-dev.obs.eu-de.otc.t-systems.com/static/img/docs/best-practices/networking/elastic-load-balancing/en-us_image_0000001674059081.png",alt:"Figure 9 Adding IP as backend\nservers"})}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"verifying-traffic-routing",children:"Verifying Traffic Routing"}),"\n",(0,r.jsx)(n.admonition,{type:"note",children:(0,r.jsx)(n.p,{children:"EIP is not necessary as long as you don't want to access the ELB\nexternally, you can always access the ELB from its private IP."})}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["Locate the dedicated load balancer ",(0,r.jsx)(n.em,{children:"ELB-Test"})," and click ",(0,r.jsx)(n.em,{children:"More"}),"\nin the ",(0,r.jsx)(n.em,{children:"Operation"})," column."]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["Select ",(0,r.jsx)(n.em,{children:"Bind IPv4 EIP"})," to bind an EIP to ",(0,r.jsx)(n.code,{children:"ELB-Test"}),"."]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{src:"https://arch-assets-dev.obs.eu-de.otc.t-systems.com/static/img/docs/best-practices/networking/elastic-load-balancing/en-us_image_0000001674259073.png",alt:"Figure 10 EIP bound to the load\nbalancer"})}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["Enter ",(0,r.jsx)(n.code,{children:"http://<EIP>"})," in the address box of your browser to\naccess the dedicated load balancer. If the following page is\ndisplayed, the load balancer routes the request to ",(0,r.jsx)(n.code,{children:"ECS-Test"}),",\nwhich processes the request and returns the requested page."]}),"\n",(0,r.jsx)(n.admonition,{type:"note",children:(0,r.jsx)(n.p,{children:"In case of unhealthy connection of the backend server group, check\nif the ECS subnet and ELB subnet are associated with the above\ncreated route tables."})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{src:"https://arch-assets-dev.obs.eu-de.otc.t-systems.com/static/img/docs/best-practices/networking/elastic-load-balancing/en-us_image_0000001625459334.png",alt:"Figure 11 Verifying traffic\nrouting"})}),"\n"]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(o,{...e})}):o(e)}},28453:(e,n,s)=>{s.d(n,{R:()=>a,x:()=>c});var t=s(96540);const r={},i=t.createContext(r);function a(e){const n=t.useContext(i);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:a(e.components),t.createElement(i.Provider,{value:n},e.children)}}}]);