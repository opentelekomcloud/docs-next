"use strict";(self.webpackChunkdocs_next=self.webpackChunkdocs_next||[]).push([[28180],{71086:(e,t,s)=>{s.r(t),s.d(t,{assets:()=>c,contentTitle:()=>o,default:()=>l,frontMatter:()=>r,metadata:()=>n,toc:()=>d});const n=JSON.parse('{"id":"best-practices/databases/document-database-service/from-ecs-hosted-mongodb-to-dds","title":"From ECS-hosted MongoDB to DDS","description":"DRS helps you migrate data from MongoDB databases on ECSs to DDS instances on the current cloud. With DRS, you can migrate databases online with zero downtime and your services and databases can remain operational during migration.","source":"@site/docs/best-practices/databases/document-database-service/from-ecs-hosted-mongodb-to-dds.md","sourceDirName":"best-practices/databases/document-database-service","slug":"/best-practices/databases/document-database-service/from-ecs-hosted-mongodb-to-dds","permalink":"/docs-next/pr-preview/pr-250/docs/best-practices/databases/document-database-service/from-ecs-hosted-mongodb-to-dds","draft":false,"unlisted":false,"editUrl":"https://github.com/opentelekomcloud/docs-next/tree/main/docs/best-practices/databases/document-database-service/from-ecs-hosted-mongodb-to-dds.md","tags":[{"inline":true,"label":"dds","permalink":"/docs-next/pr-preview/pr-250/docs/tags/dds"},{"inline":true,"label":"migration","permalink":"/docs-next/pr-preview/pr-250/docs/tags/migration"},{"inline":true,"label":"mongodb","permalink":"/docs-next/pr-preview/pr-250/docs/tags/mongodb"},{"inline":true,"label":"ecs","permalink":"/docs-next/pr-preview/pr-250/docs/tags/ecs"},{"inline":true,"label":"drs","permalink":"/docs-next/pr-preview/pr-250/docs/tags/drs"}],"version":"current","frontMatter":{"id":"from-ecs-hosted-mongodb-to-dds","title":"From ECS-hosted MongoDB to DDS","tags":["dds","migration","mongodb","ecs","drs"]},"sidebar":"bestPracticesSidebar","previous":{"title":"Connecting a Redis Client to DCS Through CCE","permalink":"/docs-next/pr-preview/pr-250/docs/best-practices/databases/distributed-cache-service/connecting-a-redis-client-to-dcs-through-cce"},"next":{"title":"From On-Premises MongoDB to DDS","permalink":"/docs-next/pr-preview/pr-250/docs/best-practices/databases/document-database-service/from-on-premises-mongodb-to-dds"}}');var a=s(74848),i=s(28453);const r={id:"from-ecs-hosted-mongodb-to-dds",title:"From ECS-hosted MongoDB to DDS",tags:["dds","migration","mongodb","ecs","drs"]},o="From ECS-hosted MongoDB to DDS",c={},d=[{value:"Solution Design",id:"solution-design",level:2},{value:"Source and destination databases are in the same VPC",id:"source-and-destination-databases-are-in-the-same-vpc",level:3},{value:"Source and destination databases are in different VPCs",id:"source-and-destination-databases-are-in-different-vpcs",level:3},{value:"Procedure",id:"procedure",level:3},{value:"Migration Suggestions",id:"migration-suggestions",level:4},{value:"Notes on Migration",id:"notes-on-migration",level:4},{value:"Prerequisites",id:"prerequisites",level:2},{value:"Migrating the Database",id:"migrating-the-database",level:2}];function h(e){const t={a:"a",admonition:"admonition",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,i.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(t.header,{children:(0,a.jsx)(t.h1,{id:"from-ecs-hosted-mongodb-to-dds",children:"From ECS-hosted MongoDB to DDS"})}),"\n",(0,a.jsx)(t.p,{children:"DRS helps you migrate data from MongoDB databases on ECSs to DDS instances on the current cloud. With DRS, you can migrate databases online with zero downtime and your services and databases can remain operational during migration."}),"\n",(0,a.jsx)(t.h2,{id:"solution-design",children:"Solution Design"}),"\n",(0,a.jsx)(t.p,{children:"This section describes how to use DRS to migrate data from an ECS\ndatabase to a DDS instance on the current cloud. The following network\nscenarios are supported:"}),"\n",(0,a.jsx)(t.h3,{id:"source-and-destination-databases-are-in-the-same-vpc",children:"Source and destination databases are in the same VPC"}),"\n",(0,a.jsx)(t.p,{children:(0,a.jsx)(t.img,{src:"https://arch-assets-dev.obs.eu-de.otc.t-systems.com/static/img/docs/best-practices/databases/document-database-service/en-us_image_0295762707.png",alt:"Figure 1 Source and destination databases in the same VPC"})}),"\n",(0,a.jsx)(t.h3,{id:"source-and-destination-databases-are-in-different-vpcs",children:"Source and destination databases are in different VPCs"}),"\n",(0,a.jsx)(t.p,{children:(0,a.jsx)(t.img,{src:"https://arch-assets-dev.obs.eu-de.otc.t-systems.com/static/img/docs/best-practices/databases/document-database-service/en-us_image_0180865321.png",alt:"Figure 2 Source and destination databases in the same region and different VPCs"})}),"\n",(0,a.jsx)(t.h3,{id:"procedure",children:"Procedure"}),"\n",(0,a.jsx)(t.p,{children:(0,a.jsx)(t.img,{src:"https://arch-assets-dev.obs.eu-de.otc.t-systems.com/static/img/docs/best-practices/databases/document-database-service/en-us_image_0000001213229532.png",alt:"Figure 3 Flowchart"})}),"\n",(0,a.jsx)(t.h4,{id:"migration-suggestions",children:"Migration Suggestions"}),"\n",(0,a.jsx)(t.admonition,{type:"important",children:(0,a.jsxs)(t.ul,{children:["\n",(0,a.jsx)(t.li,{children:"Database migration is closely impacted by a wide range of\nenvironmental and operational factors. To ensure the migration goes\nsmoothly, perform a test run before the actual migration to help you\ndetect and resolve any potential issues in advance. Recommendations\non how to minimize any potential impacts on your data base are\nprovided in this section."}),"\n",(0,a.jsxs)(t.li,{children:["It is ",(0,a.jsx)(t.strong,{children:"strongly recommended"})," that you start your migration task during\noff-peak hours. A less active database is easier to migrate\nsuccessfully. If the data is fairly static, there is less likely to\nbe any severe performance impacts during the migration."]}),"\n"]})}),"\n",(0,a.jsx)(t.h4,{id:"notes-on-migration",children:"Notes on Migration"}),"\n",(0,a.jsx)(t.admonition,{type:"important",children:(0,a.jsxs)(t.p,{children:["For details, see\n",(0,a.jsx)(t.a,{href:"https://docs.otc.t-systems.com/data-replication-service/umn/real-time_migration/to_the_cloud/index.html#drs-online-migration",children:"precautions"}),"\non using specific migration tasks in ",(0,a.jsx)(t.em,{children:"Data Replication Service Real-Time\nMigration"}),"."]})}),"\n",(0,a.jsx)(t.h2,{id:"prerequisites",children:"Prerequisites"}),"\n",(0,a.jsxs)(t.ol,{children:["\n",(0,a.jsxs)(t.li,{children:["\n",(0,a.jsx)(t.p,{children:"Permissions:"}),"\n",(0,a.jsxs)(t.p,{children:[(0,a.jsx)(t.strong,{children:"Table 1"})," below, lists the permissions required for the source and destination\ndatabases when migrating data from a MongoDB database on an ECS to\nDDS on the current cloud."]}),"\n",(0,a.jsxs)(t.table,{children:[(0,a.jsx)(t.thead,{children:(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.th,{children:"Database"}),(0,a.jsx)(t.th,{children:"Full Migration Permission"}),(0,a.jsx)(t.th,{children:"Full+Incremental Migration Permission"})]})}),(0,a.jsxs)(t.tbody,{children:[(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{children:"Source"}),(0,a.jsxs)(t.td,{children:[(0,a.jsx)(t.strong,{children:"Replica set"}),": The source database user must have the read permission for the database to be migrated. ",(0,a.jsx)("br",{})," ",(0,a.jsx)(t.strong,{children:"Single node"}),": The source database user must have the read permission for the database to be migrated. ",(0,a.jsx)("br",{})," ",(0,a.jsx)(t.strong,{children:"Cluster"}),": The source database user must have the read permission for the databases to be migrated and the config database. To migrate accounts and roles of the source database, the source database user must have the read permission for the ",(0,a.jsx)(t.code,{children:"system.users"})," and ",(0,a.jsx)(t.code,{children:"system.roles"})," system tables of the admin database."]}),(0,a.jsxs)(t.td,{children:[(0,a.jsx)(t.strong,{children:"Replica set"}),": The source database user must have the read permission for the databases to be migrated and the local database. ",(0,a.jsx)("br",{})," ",(0,a.jsx)(t.strong,{children:"Single node"}),": The source database user must have the ",(0,a.jsx)(t.code,{children:"read"})," permission for the databases to be migrated and the local database. ",(0,a.jsx)("br",{})," ",(0,a.jsx)(t.strong,{children:"Cluster"}),": The source mongos node user must have the ",(0,a.jsx)(t.code,{children:"readAnyDatabase"})," permission for the databases to be migrated and the config database. The source shard node user must have the ",(0,a.jsx)(t.code,{children:"readAnyDatabase"})," permission for the ",(0,a.jsx)(t.strong,{children:"admin"})," database and the ",(0,a.jsx)(t.code,{children:"read"})," permission for the ",(0,a.jsx)(t.strong,{children:"local"})," database. To migrate accounts and roles of the source database, the source database user must have the read permission for the ",(0,a.jsx)(t.code,{children:"system.users"})," and ",(0,a.jsx)(t.code,{children:"system.roles"})," system tables of the ",(0,a.jsx)(t.strong,{children:"admin"})," database."]})]}),(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{children:"Destination"}),(0,a.jsxs)(t.td,{children:["The destination database user must have the ",(0,a.jsx)(t.code,{children:"dbAdminAnyDatabase"})," permission for the ",(0,a.jsx)(t.strong,{children:"admin"})," database and the ",(0,a.jsx)(t.code,{children:"readWrite"})," permission for the ",(0,a.jsx)(t.strong,{children:"destination"})," database. If the destination database is a cluster instance, the migration account must have the read permission for the config database."]}),(0,a.jsx)(t.td,{})]})]})]}),"\n",(0,a.jsxs)(t.p,{children:[(0,a.jsx)(t.strong,{children:"Table 1"})," Migration permissions"]}),"\n",(0,a.jsxs)(t.ul,{children:["\n",(0,a.jsxs)(t.li,{children:["\n",(0,a.jsx)(t.p,{children:"Source database permissions:"}),"\n",(0,a.jsx)(t.p,{children:"The source MongoDB database user must have all the required\npermissions listed in the table above.\nIf the permissions are insufficient, create a user that has all\nof the permissions on the source database."}),"\n"]}),"\n",(0,a.jsxs)(t.li,{children:["\n",(0,a.jsx)(t.p,{children:"Destination database permissions:"}),"\n",(0,a.jsx)(t.p,{children:"The initial account of the DDS instance has the required\npermissions."}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,a.jsxs)(t.li,{children:["\n",(0,a.jsx)(t.p,{children:"Network settings"}),"\n",(0,a.jsxs)(t.ul,{children:["\n",(0,a.jsx)(t.li,{children:"The source database and destination DDS DB instance must be in\nthe same region."}),"\n",(0,a.jsxs)(t.li,{children:["The source database and destination DDS DB instance can be\neither in the same VPC or different VPCs.","\n",(0,a.jsxs)(t.ul,{children:["\n",(0,a.jsxs)(t.li,{children:["\n",(0,a.jsx)(t.p,{children:"If the source and destination databases are in different\nVPCs, the subnets of the source and destination databases\nare required to be in different CIDR blocks. You need to\ncreate a VPC peering connection between the two VPCs."}),"\n",(0,a.jsxs)(t.p,{children:["For details, see ",(0,a.jsx)(t.a,{href:"https://docs.otc.t-systems.com/virtual-private-cloud/umn/vpc_peering_connection/vpc_peering_connection_overview.html",children:"VPC Peering Connection\nOverview"}),"\nin the ",(0,a.jsx)(t.em,{children:"Virtual Private Cloud User Guide"}),"."]}),"\n"]}),"\n",(0,a.jsxs)(t.li,{children:["\n",(0,a.jsx)(t.p,{children:"If the source and destination databases are in the same VPC,\nthe networks are interconnected by default."}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,a.jsxs)(t.li,{children:["\n",(0,a.jsx)(t.p,{children:"Security rules"}),"\n",(0,a.jsxs)(t.ul,{children:["\n",(0,a.jsx)(t.li,{children:"In the same VPC, the network is connected by default. You do not\nneed to set a security group."}),"\n",(0,a.jsx)(t.li,{children:"In different VPCs, establish a VPC peering connection between\nthe two VPCs. You do not need to set a security group."}),"\n"]}),"\n"]}),"\n",(0,a.jsxs)(t.li,{children:["\n",(0,a.jsx)(t.p,{children:"Other"}),"\n",(0,a.jsx)(t.p,{children:"You need to export the user information of the MongoDB database\nfirst and manually add it to the destination DDS DB instance because\nthe user information will not be migrated."}),"\n"]}),"\n"]}),"\n",(0,a.jsx)(t.h2,{id:"migrating-the-database",children:"Migrating the Database"}),"\n",(0,a.jsxs)(t.ol,{children:["\n",(0,a.jsxs)(t.li,{children:["\n",(0,a.jsx)(t.p,{children:"Create a migration task."}),"\n",(0,a.jsxs)(t.ol,{children:["\n",(0,a.jsxs)(t.li,{children:["\n",(0,a.jsxs)(t.p,{children:["Log in to the management console and choose ",(0,a.jsx)(t.em,{children:"Databases"})," ->\n",(0,a.jsx)(t.em,{children:"Data Replication Service"})," to go to the ",(0,a.jsx)(t.em,{children:"DRS console"}),"."]}),"\n"]}),"\n",(0,a.jsxs)(t.li,{children:["\n",(0,a.jsxs)(t.p,{children:["On the ",(0,a.jsx)(t.em,{children:"Online Migration Management"})," page, click ",(0,a.jsx)(t.em,{children:"Create\nMigration Task"}),"."]}),"\n"]}),"\n",(0,a.jsxs)(t.li,{children:["\n",(0,a.jsxs)(t.p,{children:["On the ",(0,a.jsx)(t.em,{children:"Create Replication Instance"})," page, configure the task\ndetails, recipient, and replication instance and click ",(0,a.jsx)(t.em,{children:"Next"}),"."]}),"\n",(0,a.jsx)(t.p,{children:(0,a.jsx)(t.img,{src:"https://arch-assets-dev.obs.eu-de.otc.t-systems.com/static/img/docs/best-practices/databases/document-database-service/en-us_image_0232589882.png",alt:"Figure 4 Replication instance information"})}),"\n",(0,a.jsxs)(t.table,{children:[(0,a.jsx)(t.thead,{children:(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.th,{children:"Parameter"}),(0,a.jsx)(t.th,{children:"Description"})]})}),(0,a.jsxs)(t.tbody,{children:[(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{children:"Project"}),(0,a.jsx)(t.td,{children:"The project corresponds to the current region and can be changed."})]}),(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{children:"Task Name"}),(0,a.jsx)(t.td,{children:"The task name consists of 4 to 50 characters, starts with a letter, and can contain only letters (case-insensitive), digits, hyphens (-), and underscores (_)."})]}),(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{children:"Description"}),(0,a.jsx)(t.td,{children:"The description consists of a maximum of 256 characters and cannot contain the following special characters: =<>&'\\\""})]})]})]}),"\n",(0,a.jsxs)(t.p,{children:[(0,a.jsx)(t.strong,{children:"Table 2"})," Task settings"]}),"\n",(0,a.jsxs)(t.table,{children:[(0,a.jsx)(t.thead,{children:(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.th,{children:"Parameter"}),(0,a.jsx)(t.th,{children:"Description"})]})}),(0,a.jsxs)(t.tbody,{children:[(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{children:"Data Flow"}),(0,a.jsx)(t.td,{children:"To the cloud"})]}),(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{children:"Source DB Engine"}),(0,a.jsx)(t.td,{children:"Select MongoDB."})]}),(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{children:"Destination DB Engine"}),(0,a.jsx)(t.td,{children:"Select DDS."})]}),(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{children:"Network Type"}),(0,a.jsx)(t.td,{children:"Select VPC."})]}),(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{children:"Destination DB Instance"}),(0,a.jsx)(t.td,{children:"The DDS DB instance you purchased."})]}),(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{children:"Migration Type"}),(0,a.jsxs)(t.td,{children:["Select Full+Incremental as an example: ",(0,a.jsx)("br",{})," ",(0,a.jsx)(t.strong,{children:"Full"}),": This migration type is suitable for scenarios where a service interruption is acceptable. All objects and data in non-system databases are migrated to the destination database at one time. The objects include tables, views, and stored procedures. ",(0,a.jsx)("br",{})," If you perform a full migration, you are advised to stop operations on the source database. Otherwise, data generated in the source database during the migration will not be synchronized to the destination database. ",(0,a.jsx)("br",{})," ",(0,a.jsx)(t.strong,{children:"Full+Incremental"}),": This migration type allows you to migrate data without interrupting services. After a full migration initializes the destination database, an incremental migration initiates and parses logs to ensure data consistency between the source and destination databases.    Note  If you select the Full+Incremental migration type, data generated during the full migration will be synchronized to the destination database with zero downtime, ensuring that both the source and destination databases remain accessible."]})]}),(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{children:"Source DB Instance Type"}),(0,a.jsx)(t.td,{children:"If you select Full+Incremental for Migration Type, set this parameter based on the source database. Non-cluster is selected as an example.  If the source database is a cluster instance, set this parameter to Cluster. If the source database is a replica set or a single node instance, set this parameter to Non-cluster."})]}),(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{children:"Obtain Incremental Data"}),(0,a.jsxs)(t.td,{children:["This parameter is available for configuration if Source DB Instance Type is set to Cluster. You can determine how to capture data changes during the incremental synchronization.  ",(0,a.jsx)("br",{}),"  - ",(0,a.jsx)(t.strong,{children:"oplog"}),": For MongoDB 3.2 or later, DRS directly connects to each shard of the source DB instance to extract data. If you select this mode, you must disable the balancer of the source instance. When testing the connection, you need to enter the connection information of each shard node of the source instance. ",(0,a.jsx)("br",{})," - ",(0,a.jsx)(t.strong,{children:"changeStream"}),": This method is recommended. For MongoDB 4.0 and later, DRS connects to mongos nodes of the source instance to extract data. If you select this method, you must enable the WiredTiger storage engine of the source instance.   Only whitelisted users can use changeStream. To use this function, submit a service ticket. In the upper right corner of the management console, choose ",(0,a.jsx)(t.em,{children:"Service Tickets"})," -> ",(0,a.jsx)(t.em,{children:"Create Service Ticket"})," to submit a service ticket."]})]}),(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{children:"Source Shard Quantity"}),(0,a.jsx)(t.td,{children:"If Source DB Instance Type is set to Cluster and Obtain Incremental Data is set to oplog, enter the number of source shard nodes. The default minimum number of source DB instances is 2 and the maximum number is 32. You can set this parameter based on the number of source database shards."})]})]})]}),"\n",(0,a.jsxs)(t.p,{children:[(0,a.jsx)(t.strong,{children:"Table 3"})," Replication instance information"]}),"\n"]}),"\n",(0,a.jsxs)(t.li,{children:["\n",(0,a.jsxs)(t.p,{children:["On the ",(0,a.jsx)(t.em,{children:"Configure Source and Destination Databases"})," page, wait\nuntil the replication instance is created. Then, specify source\nand destination database information and click ",(0,a.jsx)(t.em,{children:"Test\nConnection"})," for both the source and destination databases to\ncheck whether they have been connected to the replication\ninstance. After the connection tests are successful, select the\ncheck box before the agreement and click ",(0,a.jsx)(t.em,{children:"Next"}),"."]}),"\n",(0,a.jsx)(t.p,{children:(0,a.jsx)(t.img,{src:"https://arch-assets-dev.obs.eu-de.otc.t-systems.com/static/img/docs/best-practices/databases/document-database-service/en-us_image_0232605869.png",alt:"Figure 5 Source and destination database details"})}),"\n",(0,a.jsxs)(t.table,{children:[(0,a.jsx)(t.thead,{children:(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.th,{children:"Parameter"}),(0,a.jsx)(t.th,{children:"Description"})]})}),(0,a.jsxs)(t.tbody,{children:[(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{children:"Source Database Type"}),(0,a.jsx)(t.td,{children:"Select Self-built on ECS."})]}),(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{children:"VPC"}),(0,a.jsxs)(t.td,{children:["A dedicated virtual network in which the source database is located. It isolates networks for different services. You can select an existing VPC or create a VPC. For details on how to create a VPC, see ",(0,a.jsx)(t.a,{href:"https://docs.otc.t-systems.com/virtual-private-cloud/umn/vpc_and_subnet/vpc/creating_a_vpc.html",children:"Creating a VPC"}),"."]})]}),(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{children:"Subnet"}),(0,a.jsxs)(t.td,{children:["A subnet provides dedicated network resources that are logically isolated from other networks, improving network security. The subnet must be in the AZ where the source database resides. You need to enable DHCP for creating the source database subnet. For details on how to create a VPC, see the ",(0,a.jsx)(t.a,{href:"https://docs.otc.t-systems.com/virtual-private-cloud/umn/vpc_and_subnet/vpc/creating_a_vpc.html",children:"Creating a VPC"})," section in the Virtual Private Cloud User Guide."]})]}),(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{children:"IP Address or Domain Name"}),(0,a.jsx)(t.td,{children:"The IP address or domain name of the source database."})]}),(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{children:"Port"}),(0,a.jsx)(t.td,{children:"The port of the source database. Range: 1 - 65535"})]}),(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{children:"Database Username"}),(0,a.jsx)(t.td,{children:"A username for the source database."})]}),(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{children:"Database Password"}),(0,a.jsx)(t.td,{children:"The password for the database username."})]}),(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{children:"SSL Connection"}),(0,a.jsx)(t.td,{children:"To improve data security during the migration, you are advised to enable SSL to encrypt migration links and upload a CA certificate."})]})]})]}),"\n",(0,a.jsxs)(t.p,{children:[(0,a.jsx)(t.strong,{children:"Table 4"})," Source database information"]}),"\n",(0,a.jsxs)(t.table,{children:[(0,a.jsx)(t.thead,{children:(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.th,{children:"Parameter"}),(0,a.jsx)(t.th,{children:"Description"})]})}),(0,a.jsxs)(t.tbody,{children:[(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{children:"DB Instance Name"}),(0,a.jsx)(t.td,{children:"The DDS DB instance you have selected during the migration task creation is displayed by default and cannot be changed."})]}),(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{children:"Database Username"}),(0,a.jsx)(t.td,{children:"The username for accessing the destination DDS DB instance."})]}),(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{children:"Database Password"}),(0,a.jsx)(t.td,{children:"The password for the database username."})]})]})]}),"\n",(0,a.jsxs)(t.p,{children:[(0,a.jsx)(t.strong,{children:"Table 5"})," Destination database information"]}),"\n"]}),"\n",(0,a.jsxs)(t.li,{children:["\n",(0,a.jsxs)(t.p,{children:["On the ",(0,a.jsx)(t.em,{children:"Set Task"})," page, select migration objects and click\n",(0,a.jsx)(t.em,{children:"Next"}),"."]}),"\n",(0,a.jsx)(t.p,{children:(0,a.jsx)(t.img,{src:"https://arch-assets-dev.obs.eu-de.otc.t-systems.com/static/img/docs/best-practices/databases/document-database-service/en-us_image_0000001198097583.png",alt:"Figure 6 Migration object"})}),"\n",(0,a.jsxs)(t.table,{children:[(0,a.jsx)(t.thead,{children:(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.th,{children:"Parameter"}),(0,a.jsx)(t.th,{children:"Description"})]})}),(0,a.jsxs)(t.tbody,{children:[(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{children:"Migrate Account"}),(0,a.jsxs)(t.td,{children:["There are accounts that can be migrated completely and accounts that cannot be migrated. You can choose whether to migrate the accounts. Accounts that cannot be migrated or accounts that are not selected will not exist in the destination database. Ensure that your services will not be affected by these accounts.  Yes If you choose to migrate accounts, see ",(0,a.jsx)(t.a,{href:"https://docs.otc.t-systems.com/data-replication-service/umn/real-time_migration/task_management/managing_objects/migrating_accounts.html",children:"Migrating Accounts"})," in Data Replication Service User Guide to migrate database users and roles. No During the migration, accounts and roles are not migrated."]})]}),(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{children:"Migrate Object"}),(0,a.jsx)(t.td,{children:"You can choose to migrate all objects, tables, or databases based on your service requirements.  All: All objects in the source database are migrated to the destination database. After the migration, the object names will remain the same as those in the source database and cannot be modified. Tables: The selected table-level objects will be migrated. Databases: The selected database-level objects will be migrated.  If the source database is changed, click  in the upper right corner before selecting migration objects to ensure that the objects to be selected are from the changed source database.   Note   If you choose not to migrate all of the databases, the migration may fail because the objects, such as stored procedures and views, in the database to be migrated may have dependencies on other objects that are not migrated. To ensure a successful migration, you are advised to migrate all of the databases. When you select an object, the spaces before and after the object name are not displayed. If there are two or more consecutive spaces in the middle of the object name, only one space is displayed. The search function can help you quickly select the required database objects."})]})]})]}),"\n",(0,a.jsxs)(t.p,{children:[(0,a.jsx)(t.strong,{children:"Table 6"})," Migration object"]}),"\n"]}),"\n",(0,a.jsxs)(t.li,{children:["\n",(0,a.jsxs)(t.p,{children:["On the ",(0,a.jsx)(t.em,{children:"Check Task"})," page, check the migration task."]}),"\n",(0,a.jsxs)(t.ul,{children:["\n",(0,a.jsxs)(t.li,{children:["\n",(0,a.jsxs)(t.p,{children:["If any check fails, review the cause and rectify the fault.\nAfter the fault is rectified, click ",(0,a.jsx)(t.em,{children:"Check Again"}),"."]}),"\n",(0,a.jsx)(t.admonition,{type:"note",children:(0,a.jsxs)(t.p,{children:["For details about how to handle check failures, see\n",(0,a.jsx)(t.a,{href:"https://docs.otc.t-systems.com/data-replication-service/umn/troubleshooting/solutions_to_failed_check_items/networks/checking_whether_the_source_database_is_connected.html",children:"Checking Whether the Source Database Is\nConnected"}),"\nin ",(0,a.jsx)(t.em,{children:"Data Replication Service User Guide"}),"."]})}),"\n"]}),"\n",(0,a.jsxs)(t.li,{children:["\n",(0,a.jsxs)(t.p,{children:["If all check items are successful, click ",(0,a.jsx)(t.em,{children:"Next"}),"."]}),"\n",(0,a.jsx)(t.p,{children:(0,a.jsx)(t.img,{src:"https://arch-assets-dev.obs.eu-de.otc.t-systems.com/static/img/docs/best-practices/databases/document-database-service/en-us_image_0000001152137438.png",alt:"Figure 7 Task Check"})}),"\n"]}),"\n"]}),"\n",(0,a.jsx)(t.p,{children:"You can proceed to the next step only when all check items are\nsuccessful. If any alarms are generated, view and confirm the\nalarm details first before proceeding to the next step."}),"\n"]}),"\n",(0,a.jsxs)(t.li,{children:["\n",(0,a.jsxs)(t.p,{children:["On the displayed page, specify ",(0,a.jsx)(t.em,{children:"Start Time"})," and confirm that\nthe configured information is correct and click ",(0,a.jsx)(t.em,{children:"Submit"})," to\nsubmit the task."]}),"\n",(0,a.jsx)(t.p,{children:(0,a.jsx)(t.img,{src:"https://arch-assets-dev.obs.eu-de.otc.t-systems.com/static/img/docs/best-practices/databases/document-database-service/en-us_image_0000001199158158.png",alt:"Figure 8 Task startup settings"})}),"\n",(0,a.jsxs)(t.table,{children:[(0,a.jsx)(t.thead,{children:(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.th,{children:"Parameter"}),(0,a.jsx)(t.th,{children:"Description"})]})}),(0,a.jsx)(t.tbody,{children:(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{children:"Start Time"}),(0,a.jsx)(t.td,{children:"Set Start Time to Start upon task creation or Start at a specified time based on site requirements. The Start at a specified time option is recommended.   Note  The migration task may affect the performance of the source and destination databases. You are advised to start the task in off-peak hours and reserve two to three days for data verification."})]})})]}),"\n",(0,a.jsxs)(t.p,{children:[(0,a.jsx)(t.strong,{children:"Table 7"})," Task startup settings"]}),"\n"]}),"\n",(0,a.jsxs)(t.li,{children:["\n",(0,a.jsxs)(t.p,{children:["After the task is submitted, go back to the ",(0,a.jsx)(t.em,{children:"Online Migration\nManagement"})," page to view the task status."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,a.jsxs)(t.li,{children:["\n",(0,a.jsx)(t.p,{children:"Manage the migration task."}),"\n",(0,a.jsx)(t.p,{children:"The migration task contains two phases: full migration and\nincremental migration. You can manage them in different phases."}),"\n",(0,a.jsxs)(t.ul,{children:["\n",(0,a.jsxs)(t.li,{children:[(0,a.jsx)(t.strong,{children:"Full migration"}),"\n",(0,a.jsxs)(t.ul,{children:["\n",(0,a.jsxs)(t.li,{children:["Viewing the migration progress: Click the target full\nmigration task, and on the ",(0,a.jsx)(t.em,{children:"Migration Progress"})," tab, you\ncan see the migration progress of the structure, data,\nindexes, and migration objects. When the progress reaches\n100%, the migration is complete."]}),"\n",(0,a.jsx)(t.li,{children:"Viewing migration details: In the migration details, you can\nview the migration progress of a specific object. If the\nnumber of objects is the same as that of migrated objects,\nthe migration is complete. You can view the migration\nprogress of each object in detail. Currently, this function\nis available only to whitelisted users. You can submit a\nservice ticket to apply for this function."}),"\n"]}),"\n"]}),"\n",(0,a.jsxs)(t.li,{children:[(0,a.jsx)(t.strong,{children:"Incremental Migration"})," Permission","\n",(0,a.jsxs)(t.ul,{children:["\n",(0,a.jsxs)(t.li,{children:["\n",(0,a.jsxs)(t.p,{children:["Viewing the synchronization delay: After the full migration\nis complete, an incremental migration starts. On the\n",(0,a.jsx)(t.em,{children:"Online Migration Management"})," page, click the target\nmigration task. On the displayed page, click ",(0,a.jsx)(t.em,{children:"Migration\nProgress"})," to view the synchronization delay of the\nincremental migration. If the synchronization delay is 0s,\nthe destination database is being synchronized with the\nsource database in real time. You can also view the data\nconsistency on the ",(0,a.jsx)(t.em,{children:"Migration Comparison"})," tab."]}),"\n",(0,a.jsx)(t.p,{children:(0,a.jsx)(t.img,{src:"https://arch-assets-dev.obs.eu-de.otc.t-systems.com/static/img/docs/best-practices/databases/document-database-service/en-us_image_0000001243756137.png",alt:"Figure 9 Viewing the synchronization delay"})}),"\n"]}),"\n",(0,a.jsxs)(t.li,{children:["\n",(0,a.jsxs)(t.p,{children:["Viewing the migration results: On the ",(0,a.jsx)(t.em,{children:"Online Migration\nManagement"})," page, click the target migration task. On the\ndisplayed page, click ",(0,a.jsx)(t.em,{children:"Migration Comparison"})," and perform a\nmigration comparison in accordance with the comparison\nprocess, which should help you determine an appropriate time\nfor migration to minimize service downtime."]}),"\n",(0,a.jsx)(t.p,{children:(0,a.jsx)(t.img,{src:"https://arch-assets-dev.obs.eu-de.otc.t-systems.com/static/img/docs/best-practices/databases/document-database-service/en-us_image_0000001213070166.png",alt:"Figure 10 Database comparison\nprocess"})}),"\n",(0,a.jsxs)(t.p,{children:["For details, see ",(0,a.jsx)(t.a,{href:"https://docs.otc.t-systems.com/data-replication-service/umn/real-time_migration/task_management/step_4_compare_migration_items.html",children:"Comparing Migration\nItems"}),"\nin ",(0,a.jsx)(t.em,{children:"Data Replication Service User Guide"}),"."]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,a.jsxs)(t.li,{children:["\n",(0,a.jsx)(t.p,{children:"Cut over services."}),"\n",(0,a.jsxs)(t.p,{children:["You are advised to start the cutover process during off-peak hours.\nAt least one complete data comparison is performed during off-peak\nhours. To obtain accurate comparison results, start data comparison\nat a specified time point during off-peak hours. If it is needed,\nselect ",(0,a.jsx)(t.em,{children:"Start at a specified time"})," for ",(0,a.jsx)(t.em,{children:"Comparison Time"}),". Due to\nslight time difference and continuous operations on data,\ninconsistent comparison results may be generated, reducing the\nreliability and validity of the results."]}),"\n",(0,a.jsxs)(t.ol,{children:["\n",(0,a.jsxs)(t.li,{children:["\n",(0,a.jsx)(t.p,{children:"Interrupt services first. If the workload is not heavy, you may\nnot need to interrupt the services."}),"\n"]}),"\n",(0,a.jsxs)(t.li,{children:["\n",(0,a.jsx)(t.p,{children:"Run the following statement on the source database and check\nwhether any new sessions execute SQL statements within the next\n1 to 5 minutes. If there are no new statements executed, the\nservice has been stopped."}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{children:"db.currentOp()\n"})}),"\n",(0,a.jsx)(t.admonition,{type:"note",children:(0,a.jsx)(t.p,{children:"The process list queried by the preceding statement includes the\nconnection of the DRS replication instance. If no additional\nsession executes SQL statements, the service has been stopped."})}),"\n"]}),"\n",(0,a.jsxs)(t.li,{children:["\n",(0,a.jsxs)(t.p,{children:["On the ",(0,a.jsx)(t.em,{children:"Migration Progress"})," page, view the synchronization\ndelay. When the delay is displayed as 0s and remains stable for\na period, then you can perform a data-level comparison between\nthe source and destination databases. For details about the time\nrequired, refer to the results of the previous comparison."]}),"\n",(0,a.jsxs)(t.ul,{children:["\n",(0,a.jsx)(t.li,{children:"If there is enough time, compare all objects."}),"\n",(0,a.jsx)(t.li,{children:"If there is not enough time, use the data-level comparison\nto compare the tables that are frequently used and that\ncontain key business data or inconsistent data."}),"\n"]}),"\n"]}),"\n",(0,a.jsxs)(t.li,{children:["\n",(0,a.jsx)(t.p,{children:"Determine an appropriate time to cut the services over to the\ndestination database. After services are restored and available,\nthe migration is complete."}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,a.jsxs)(t.li,{children:["\n",(0,a.jsx)(t.p,{children:"Stop or delete the migration task."}),"\n",(0,a.jsxs)(t.ol,{children:["\n",(0,a.jsx)(t.li,{children:"Stopping the migration task. After databases and services are\nmigrated to the destination database, to prevent operations on\nthe source database from being synchronized to the destination\ndatabase to overwrite data, you can stop the migration task.\nThis operation only deletes the replication instance, and the\nmigration task is still displayed in the task list. You can view\nor delete the task. DRS will not charge for this task after you\nstop it."}),"\n",(0,a.jsx)(t.li,{children:"Delete the migration task. After the migration task is complete,\nyou can delete it. After the migration task is deleted, it will\nno longer be displayed in the task list."}),"\n"]}),"\n"]}),"\n"]})]})}function l(e={}){const{wrapper:t}={...(0,i.R)(),...e.components};return t?(0,a.jsx)(t,{...e,children:(0,a.jsx)(h,{...e})}):h(e)}},28453:(e,t,s)=>{s.d(t,{R:()=>r,x:()=>o});var n=s(96540);const a={},i=n.createContext(a);function r(e){const t=n.useContext(i);return n.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function o(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:r(e.components),n.createElement(i.Provider,{value:t},e.children)}}}]);