"use strict";(self.webpackChunkdocs_next=self.webpackChunkdocs_next||[]).push([[97870],{28254:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>c,contentTitle:()=>o,default:()=>h,frontMatter:()=>d,metadata:()=>i,toc:()=>a});const i=JSON.parse('{"id":"best-practices/networking/domain-name-service/configuring-private-domain-names-for-ecss","title":"Configuring Private Domain Names for ECSs","description":"If one of your ECSs is not working normally and you need to use the backup ECS to handle requests, but you have not configured private zones for the two ECSs, you need to change the private IP address in the code for the faulty ECS. This will interrupt your services and cause you to publish your website again, which is time- and labor-consuming.","source":"@site/docs/best-practices/networking/domain-name-service/configuring-private-domain-names-for-ecss.md","sourceDirName":"best-practices/networking/domain-name-service","slug":"/best-practices/networking/domain-name-service/configuring-private-domain-names-for-ecss","permalink":"/docs-next/pr-preview/pr-250/docs/best-practices/networking/domain-name-service/configuring-private-domain-names-for-ecss","draft":false,"unlisted":false,"editUrl":"https://github.com/opentelekomcloud/docs-next/tree/main/docs/best-practices/networking/domain-name-service/configuring-private-domain-names-for-ecss.md","tags":[{"inline":true,"label":"dns","permalink":"/docs-next/pr-preview/pr-250/docs/tags/dns"},{"inline":true,"label":"ecs","permalink":"/docs-next/pr-preview/pr-250/docs/tags/ecs"}],"version":"current","frontMatter":{"id":"configuring-private-domain-names-for-ecss","title":"Configuring Private Domain Names for ECSs","tags":["dns","ecs"]},"sidebar":"bestPracticesSidebar","previous":{"title":"Auditing and Analyzing Logins and Logouts with Functiongraph","permalink":"/docs-next/pr-preview/pr-250/docs/best-practices/management-and-deployment/cloud-trace/auditing-and-analyzing-logins-and-logouts-with-functiongraph"},"next":{"title":"Using Advanced Forwarding for Application Iteration","permalink":"/docs-next/pr-preview/pr-250/docs/best-practices/networking/elastic-load-balancing/using-advanced-forwarding-for-application-iteration"}}');var r=s(74848),t=s(28453);const d={id:"configuring-private-domain-names-for-ecss",title:"Configuring Private Domain Names for ECSs",tags:["dns","ecs"]},o="Configuring Private Domain Names for ECSs",c={},a=[{value:"Solution Design",id:"solution-design",level:2},{value:"Prerequisites",id:"prerequisites",level:2},{value:"Configuring Private Zones",id:"configuring-private-zones",level:2},{value:"Summary",id:"summary",level:3},{value:"Procedure",id:"procedure",level:3}];function l(e){const n={a:"a",admonition:"admonition",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",header:"header",img:"img",li:"li",ol:"ol",p:"p",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,t.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"configuring-private-domain-names-for-ecss",children:"Configuring Private Domain Names for ECSs"})}),"\n",(0,r.jsx)(n.p,{children:"If one of your ECSs is not working normally and you need to use the backup ECS to handle requests, but you have not configured private zones for the two ECSs, you need to change the private IP address in the code for the faulty ECS. This will interrupt your services and cause you to publish your website again, which is time- and labor-consuming."}),"\n",(0,r.jsx)(n.p,{children:"Assume that you have configured private zones for the ECSs and have\nincluded their private domain names in the code. If one ECS is\nmalfunctioning, you only need to change the DNS records to direct\ntraffic to a normal ECS. Your services will not be interrupted, and you\ndo not need to publish the website again."}),"\n",(0,r.jsx)(n.h2,{id:"solution-design",children:"Solution Design"}),"\n",(0,r.jsx)(n.p,{children:"The figure below shows the networking of\na website where ECSs and RDS instances are deployed in a VPC."}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"ECS0"}),": primary service node"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"ECS1"}),": public service node -> ",(0,r.jsx)(n.strong,{children:"ECS2"}),": backup service node"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"RDS1"}),": service database -> ",(0,r.jsx)(n.strong,{children:"RDS2"}),": backup database"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{src:"https://arch-assets-dev.obs.eu-de.otc.t-systems.com/static/img/docs/best-practices/networking/domain-name-service/en-us_image_0000001394829705.png",alt:"Figure 1 Networking example"})}),"\n",(0,r.jsx)(n.admonition,{type:"note",children:(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Higher efficiency and security"}),": You can use private domain names\nto access ECSs in the VPCs, without going through the Internet."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Easier management"}),": Compared with IP addresses, domain names are\neasier to modify in the code. When an ECS is changed, you only need\nto change the DNS records without modifying the code."]}),"\n"]})}),"\n",(0,r.jsx)(n.h2,{id:"prerequisites",children:"Prerequisites"}),"\n",(0,r.jsx)(n.p,{children:"This table lists private zones and record sets planned for the cloud\nservers."}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Resource"}),(0,r.jsx)(n.th,{children:"Private Zone"}),(0,r.jsx)(n.th,{children:"Associated"}),(0,r.jsx)(n.th,{children:"Private IP"}),(0,r.jsx)(n.th,{children:"Record Set Type"}),(0,r.jsx)(n.th,{children:"Description"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"ECS1"}),(0,r.jsx)(n.td,{children:"api.ecs.com"}),(0,r.jsx)(n.td,{children:"VPC_001"}),(0,r.jsx)(n.td,{children:"192.168.2.8"}),(0,r.jsx)(n.td,{children:"A"}),(0,r.jsx)(n.td,{children:"Public service node"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"ECS2"}),(0,r.jsx)(n.td,{children:"api.ecs.com"}),(0,r.jsx)(n.td,{children:"VPC_001"}),(0,r.jsx)(n.td,{children:"192.168.3.8"}),(0,r.jsx)(n.td,{children:"A"}),(0,r.jsx)(n.td,{children:"Backup for the public service node"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"RDS1"}),(0,r.jsx)(n.td,{children:"db.com"}),(0,r.jsx)(n.td,{children:"VPC_001"}),(0,r.jsx)(n.td,{children:"192.168.2.5"}),(0,r.jsx)(n.td,{children:"A"}),(0,r.jsx)(n.td,{children:"Service database"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"RDS2"}),(0,r.jsx)(n.td,{children:"db.com"}),(0,r.jsx)(n.td,{children:"VPC_001"}),(0,r.jsx)(n.td,{children:"192.168.3.5"}),(0,r.jsx)(n.td,{children:"A"}),(0,r.jsx)(n.td,{children:"Backup database"})]})]})]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Table 1"})," Private zones and record sets for each server"]}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Region"}),(0,r.jsx)(n.th,{children:"Service"}),(0,r.jsx)(n.th,{children:"Resource"}),(0,r.jsx)(n.th,{children:"Description"}),(0,r.jsx)(n.th,{children:"Quantity"}),(0,r.jsx)(n.th,{children:"Monthly Price"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"eu-de"}),(0,r.jsx)(n.td,{children:"VPC"}),(0,r.jsx)(n.td,{children:"VPC_001"}),(0,r.jsxs)(n.td,{children:["The DNS server addresses must be the same as the private DNS server addresses of Open Telekom Cloud. For details, see ",(0,r.jsx)(n.a,{href:"https://www.open-telekom-cloud.com/en/support/release-notes/secondary-dns",children:"Availability of secondary DNS"})]}),(0,r.jsx)(n.td,{children:"1"}),(0,r.jsx)(n.td,{children:"Free"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{}),(0,r.jsx)(n.td,{children:"ECS"}),(0,r.jsx)(n.td,{children:"ECS0 ECS1 ECS2"}),(0,r.jsxs)(n.td,{children:["Private domain name: ",(0,r.jsx)(n.code,{children:"api.ecs.com"})," ",(0,r.jsx)("br",{})," Associated VPC: ",(0,r.jsx)(n.code,{children:"VPC_001"})," ",(0,r.jsx)("br",{})," ECS1: public service node ",(0,r.jsx)("br",{})," Private IP address: ",(0,r.jsx)(n.code,{children:"192.168.2.8"})," ",(0,r.jsx)("br",{})," ECS2: backup service node Private IP address: ",(0,r.jsx)(n.code,{children:"192.168.3.8"})]}),(0,r.jsx)(n.td,{children:"3"}),(0,r.jsxs)(n.td,{children:["For details, see ",(0,r.jsx)(n.a,{href:"https://open-telekom-cloud.com/en/prices/price-calculator",children:"ECS Product Pricing Details"}),"."]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{}),(0,r.jsx)(n.td,{children:"RDS"}),(0,r.jsx)(n.td,{children:"RDS1 RDS2"}),(0,r.jsxs)(n.td,{children:["Private domain name: ",(0,r.jsx)(n.code,{children:"db.com"})," ",(0,r.jsx)("br",{})," Associated VPC: ",(0,r.jsx)(n.code,{children:"VPC_001"})," ",(0,r.jsx)("br",{})," RDS1: service database ",(0,r.jsx)("br",{})," Private IP address: ",(0,r.jsx)(n.code,{children:"192.168.2.5"})," ",(0,r.jsx)("br",{})," RDS2: backup database ",(0,r.jsx)("br",{})," Private IP address: ",(0,r.jsx)(n.code,{children:"192.168.3.5"})]}),(0,r.jsx)(n.td,{children:"2"}),(0,r.jsxs)(n.td,{children:["For details, see ",(0,r.jsx)(n.a,{href:"https://open-telekom-cloud.com/en/prices/price-calculator",children:"RDS Product Pricing Details"}),"."]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{}),(0,r.jsx)(n.td,{children:"DNS"}),(0,r.jsx)(n.td,{children:"api.ecs.com db.com"}),(0,r.jsxs)(n.td,{children:[(0,r.jsx)(n.strong,{children:"api.ecs.com"}),": Associated VPC: ",(0,r.jsx)(n.code,{children:"VPC_001"})," ",(0,r.jsx)("br",{})," Record set type: ",(0,r.jsx)(n.code,{children:"A"})," Value: ",(0,r.jsx)(n.code,{children:"192.168.2.8"})," ",(0,r.jsx)("br",{})," ",(0,r.jsx)(n.strong,{children:"db.com"}),": Associated VPC: ",(0,r.jsx)(n.code,{children:"VPC_001"})," Record set type: ",(0,r.jsx)(n.code,{children:"A"})," Value: ",(0,r.jsx)(n.code,{children:"192.168.2.5"})]}),(0,r.jsx)(n.td,{children:"2"}),(0,r.jsx)(n.td,{children:"Free"})]})]})]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Table 2"})," Resource planning"]}),"\n",(0,r.jsx)(n.h2,{id:"configuring-private-zones",children:"Configuring Private Zones"}),"\n",(0,r.jsx)(n.h3,{id:"summary",children:"Summary"}),"\n",(0,r.jsx)(n.p,{children:"The figure below shows the process for configuring private zones:"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{src:"https://arch-assets-dev.obs.eu-de.otc.t-systems.com/static/img/docs/best-practices/networking/domain-name-service/en-us_image_0173959206.png",alt:"Figure 2 Process for configuring private\nzones"})}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsx)(n.li,{children:"(Optional) Create a VPC and a subnet on the VPC console. This\noperation is required when you are configuring private domain names\nfor servers during website deployment."}),"\n",(0,r.jsx)(n.li,{children:"Create private zones and associate them with the VPC and add a\nrecord set to each private zone on the DNS console."}),"\n",(0,r.jsx)(n.li,{children:"(Optional) Change the DNS server addresses of the VPC subnet on the\nVPC console. This operation is required when you are configuring\nprivate domain names for servers where your website is running."}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"procedure",children:"Procedure"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"(Optional) Create a VPC and a subnet."}),"\n",(0,r.jsx)(n.p,{children:"Before configuring private domain names for the ECSs and databases\nrequired by your website, you need to create a VPC and a subnet."}),"\n",(0,r.jsx)(n.p,{children:"a.  Log in to the management console."}),"\n",(0,r.jsxs)(n.p,{children:["b.  Click ",(0,r.jsx)(n.img,{src:"https://arch-assets-dev.obs.eu-de.otc.t-systems.com/static/img/docs/best-practices/networking/domain-name-service/en-us_image_0131021386.png",alt:"image1"})," in\nthe upper left corner and select the desired region and project."]}),"\n",(0,r.jsxs)(n.p,{children:["c.  Choose ",(0,r.jsx)(n.em,{children:"Network"})," -> ",(0,r.jsx)(n.em,{children:"Virtual Private Cloud"}),"."]}),"\n",(0,r.jsxs)(n.p,{children:["d.  In the navigation pane on the left, choose ",(0,r.jsx)(n.em,{children:"Virtual Private\nCloud"}),"."]}),"\n",(0,r.jsxs)(n.p,{children:["e.  Click ",(0,r.jsx)(n.em,{children:"Create VPC"})," and configure the parameters based on\n",(0,r.jsx)(n.code,{children:"Table 3 <dns_bestprac_0002__table65603559163645>"})]}),"\n",(0,r.jsxs)(n.p,{children:["f.  Click ",(0,r.jsx)(n.em,{children:"Create Now"}),"."]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"Create private zones."}),"\n",(0,r.jsx)(n.p,{children:"Create private zones for the domain names used by ECS1 and RDS1."}),"\n",(0,r.jsxs)(n.p,{children:["a.  Choose ",(0,r.jsx)(n.em,{children:"Network"})," -> ",(0,r.jsx)(n.em,{children:"Domain Name Service"}),"."]}),"\n",(0,r.jsx)(n.p,{children:"The DNS console is displayed."}),"\n",(0,r.jsxs)(n.p,{children:["b.  In the navigation pane on the left, choose ",(0,r.jsx)(n.em,{children:"Private Zones"}),"."]}),"\n",(0,r.jsxs)(n.p,{children:["c. Click ",(0,r.jsx)(n.em,{children:"Create Private Zone"}),"."]}),"\n",(0,r.jsx)(n.p,{children:"d.  Configure the parameters based on"}),"\n",(0,r.jsxs)(n.p,{children:["e.  Click ",(0,r.jsx)(n.em,{children:"OK"}),". Then check the private zone created for ",(0,r.jsx)(n.code,{children:"api.ecs.com"}),"."]}),"\n",(0,r.jsxs)(n.p,{children:["You can view details about this private zone on the ",(0,r.jsx)(n.em,{children:"Private\nZones"})," page."]}),"\n",(0,r.jsxs)(n.admonition,{type:"note",children:[(0,r.jsx)(n.p,{children:"Click the domain name to view SOA and NS record sets\nautomatically generated for the zone."}),(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"The SOA record set identifies the base DNS information about\nthe domain name."}),"\n",(0,r.jsx)(n.li,{children:"The NS record set defines authoritative DNS servers for the\ndomain name."}),"\n"]})]}),"\n",(0,r.jsxs)(n.p,{children:["f.  Repeat steps to create a private zone for ",(0,r.jsx)(n.code,{children:"db.com"}),"."]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"Add a record set to each private zone."}),"\n",(0,r.jsx)(n.p,{children:"Add record sets to translate private domain names to private IP\naddresses of ECS1 and RDS1."}),"\n",(0,r.jsx)(n.p,{children:"a.  Click the domain name."}),"\n",(0,r.jsx)(n.p,{children:"The record set page is displayed."}),"\n",(0,r.jsxs)(n.p,{children:["b.  Click ",(0,r.jsx)(n.em,{children:"Add Record Set"}),"."]}),"\n",(0,r.jsx)(n.p,{children:"c.  Configure the parameters"}),"\n",(0,r.jsxs)(n.p,{children:["d.  Click ",(0,r.jsx)(n.em,{children:"OK"}),". An A record set is added for ",(0,r.jsx)(n.code,{children:"api.ecs.com"}),"."]}),"\n",(0,r.jsxs)(n.p,{children:["e.  Repeat steps to add an A record set for ",(0,r.jsx)(n.code,{children:"db.com"}),"."]}),"\n",(0,r.jsxs)(n.p,{children:["Set the record set value of ",(0,r.jsx)(n.code,{children:"db.com"})," to ",(0,r.jsx)(n.code,{children:"192.168.2.5"}),"."]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"(Optional) Change the DNS server addresses of the VPC subnet."}),"\n",(0,r.jsx)(n.p,{children:"After you configure private domain names for nodes in the website\napplication, you need to change the DNS servers of the VPC subnet to\nthose provided by the DNS service so that the domain names can be\nresolved."}),"\n",(0,r.jsxs)(n.p,{children:["For details, see ",(0,r.jsx)(n.a,{href:"https://support.huaweicloud.com/intl/en-us/dns_faq/dns_faq_005.html",children:"How Do I Change Default DNS Servers of an ECS to\nHuawei Cloud Private DNS\nServers?"})]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"Switch to the backup ECS."}),"\n",(0,r.jsxs)(n.p,{children:["When ECS1 becomes faulty, you can switch services to ECS2 by\nchanging the value of the record set added to private zone\n",(0,r.jsx)(n.code,{children:"api.ecs.com"}),"."]}),"\n",(0,r.jsx)(n.p,{children:"a.  Log in to the management console."}),"\n",(0,r.jsxs)(n.p,{children:["b.  Click ",(0,r.jsx)(n.img,{src:"https://arch-assets-dev.obs.eu-de.otc.t-systems.com/static/img/docs/best-practices/networking/domain-name-service/en-us_image_0131021386.png",alt:"image1"})," in\nthe upper left and select ",(0,r.jsx)(n.em,{children:"eu-de"}),"."]}),"\n",(0,r.jsxs)(n.p,{children:["c.  Choose ",(0,r.jsx)(n.em,{children:"Network"})," -> ",(0,r.jsx)(n.em,{children:"Domain Name Service"}),"."]}),"\n",(0,r.jsx)(n.p,{children:"The DNS console is displayed."}),"\n",(0,r.jsxs)(n.p,{children:["d.  In the navigation pane on the left, choose ",(0,r.jsx)(n.em,{children:"Private Zones"}),"."]}),"\n",(0,r.jsxs)(n.p,{children:["e.  In the private zone list, click the name of the zone\n",(0,r.jsx)(n.code,{children:"api.ecs.com"}),"."]}),"\n",(0,r.jsxs)(n.p,{children:["f.  Locate the A record set and click ",(0,r.jsx)(n.em,{children:"Modify"})," under\n",(0,r.jsx)(n.em,{children:"Operation"}),"."]}),"\n",(0,r.jsxs)(n.p,{children:["g.  Change the value to ",(0,r.jsx)(n.code,{children:"192.168.3.8"}),"."]}),"\n",(0,r.jsxs)(n.p,{children:["h.  Click ",(0,r.jsx)(n.em,{children:"OK"}),"."]}),"\n",(0,r.jsx)(n.p,{children:"Traffic to ECS1 will be directed to ECS2 by the private DNS server."}),"\n"]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(l,{...e})}):l(e)}},28453:(e,n,s)=>{s.d(n,{R:()=>d,x:()=>o});var i=s(96540);const r={},t=i.createContext(r);function d(e){const n=i.useContext(t);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:d(e.components),i.createElement(t.Provider,{value:n},e.children)}}}]);