"use strict";(self.webpackChunkdocs_next=self.webpackChunkdocs_next||[]).push([[27784],{88049:(e,s,n)=>{n.r(s),n.d(s,{assets:()=>d,contentTitle:()=>r,default:()=>h,frontMatter:()=>a,metadata:()=>t,toc:()=>o});const t=JSON.parse('{"id":"best-practices/databases/distributed-cache-service/using-elb-for-public-access-to-dcs","title":"Using ELB for Public Access to DCS","description":"Currently, DCS Redis 4.0, 5.0, and 6.0 instances cannot be bound with elastic IP addresses (EIPs) and cannot be accessed over public networks directly. This section describes how to access a single-node, master/standby, read/write splitting, or Proxy Cluster instance or a node in a Redis Cluster instance through public networks by enabling cross-VPC backend on a load balancer.","source":"@site/docs/best-practices/databases/distributed-cache-service/using-elb-for-public-access-to-dcs.md","sourceDirName":"best-practices/databases/distributed-cache-service","slug":"/best-practices/databases/distributed-cache-service/using-elb-for-public-access-to-dcs","permalink":"/docs-next/pr-preview/pr-250/docs/best-practices/databases/distributed-cache-service/using-elb-for-public-access-to-dcs","draft":false,"unlisted":false,"editUrl":"https://github.com/opentelekomcloud/docs-next/tree/main/docs/best-practices/databases/distributed-cache-service/using-elb-for-public-access-to-dcs.md","tags":[{"inline":true,"label":"dcs","permalink":"/docs-next/pr-preview/pr-250/docs/tags/dcs"},{"inline":true,"label":"redis","permalink":"/docs-next/pr-preview/pr-250/docs/tags/redis"},{"inline":true,"label":"elb","permalink":"/docs-next/pr-preview/pr-250/docs/tags/elb"}],"version":"current","frontMatter":{"id":"using-elb-for-public-access-to-dcs","title":"Using ELB for Public Access to DCS","tags":["dcs","redis","elb"]},"sidebar":"bestPracticesSidebar","previous":{"title":"Using SSH Tunneling for Public Access to a DCS Instance","permalink":"/docs-next/pr-preview/pr-250/docs/best-practices/databases/distributed-cache-service/using-ssh-tunneling-for-public-access-to-a-dcs-instance"},"next":{"title":"Connecting a Redis Client to DCS Through CCE","permalink":"/docs-next/pr-preview/pr-250/docs/best-practices/databases/distributed-cache-service/connecting-a-redis-client-to-dcs-through-cce"}}');var c=n(74848),i=n(28453);const a={id:"using-elb-for-public-access-to-dcs",title:"Using ELB for Public Access to DCS",tags:["dcs","redis","elb"]},r="Using ELB for Public Access to DCS",d={},o=[{value:"Solution Design",id:"solution-design",level:2},{value:"Prerequisites",id:"prerequisites",level:2},{value:"Connecting to the DCS Instance Through ELB",id:"connecting-to-the-dcs-instance-through-elb",level:2}];function l(e){const s={a:"a",admonition:"admonition",code:"code",em:"em",h1:"h1",h2:"h2",header:"header",img:"img",li:"li",ol:"ol",p:"p",strong:"strong",ul:"ul",...(0,i.R)(),...e.components};return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(s.header,{children:(0,c.jsx)(s.h1,{id:"using-elb-for-public-access-to-dcs",children:"Using ELB for Public Access to DCS"})}),"\n",(0,c.jsx)(s.p,{children:"Currently, DCS Redis 4.0, 5.0, and 6.0 instances cannot be bound with elastic IP addresses (EIPs) and cannot be accessed over public networks directly. This section describes how to access a single-node, master/standby, read/write splitting, or Proxy Cluster instance or a node in a Redis Cluster instance through public networks by enabling cross-VPC backend on a load balancer."}),"\n",(0,c.jsx)(s.admonition,{type:"note",children:(0,c.jsxs)(s.ul,{children:["\n",(0,c.jsx)(s.li,{children:"Due to cluster node address translation, you cannot access a Redis\nCluster as a whole. You can only access individual nodes in the\ncluster."}),"\n",(0,c.jsx)(s.li,{children:"Do not use public network access in the production environment.\nClient access exceptions caused by poor public network performance\nwill not be included in the SLA."}),"\n"]})}),"\n",(0,c.jsx)(s.h2,{id:"solution-design",children:"Solution Design"}),"\n",(0,c.jsx)(s.p,{children:"The following figure shows the process for accessing DCS through ELB."}),"\n",(0,c.jsx)(s.p,{children:(0,c.jsx)(s.img,{src:"https://arch-assets-dev.obs.eu-de.otc.t-systems.com/static/img/docs/best-practices/databases/distributed-cache-service/en-us_image_0000001231321333.png",alt:"Figure 1 Process for accessing DCS through ELB"})}),"\n",(0,c.jsx)(s.h2,{id:"prerequisites",children:"Prerequisites"}),"\n",(0,c.jsxs)(s.ol,{children:["\n",(0,c.jsxs)(s.li,{children:[(0,c.jsx)(s.a,{href:"https://docs.otc.t-systems.com/virtual-private-cloud/umn/vpc_and_subnet/vpc/creating_a_vpc.html#en-us-topic-0013935842",children:"Create a VPC"}),"\nor use an existing one."]}),"\n",(0,c.jsxs)(s.li,{children:[(0,c.jsx)(s.a,{href:"https://docs.otc.t-systems.com/distributed-cache-service/umn/getting_started/creating_an_instance/creating_a_dcs_redis_instance.html#dcs-ug-0326008",children:"Create a DCS Redis instance"}),".\nRecord the IP address and port number of the instance."]}),"\n",(0,c.jsxs)(s.li,{children:[(0,c.jsx)(s.a,{href:"https://docs.otc.t-systems.com/elastic-load-balancing/umn/load_balancer/creating_a_dedicated_load_balancer.html",children:"Create a dedicated load balancer"}),"."]}),"\n"]}),"\n",(0,c.jsx)(s.admonition,{type:"note",children:(0,c.jsxs)(s.ul,{children:["\n",(0,c.jsx)(s.li,{children:"A shared load balancer does not support cross-VPC backend\nservers. Therefore, it cannot be bound to a DCS instance."}),"\n",(0,c.jsxs)(s.li,{children:["For ",(0,c.jsx)(s.em,{children:"Specification"}),", select ",(0,c.jsx)(s.em,{children:"Network load balancing\n(TCP/UDP)"}),"."]}),"\n",(0,c.jsxs)(s.li,{children:["To access the DCS instance over public networks, enable ",(0,c.jsx)(s.em,{children:"IP as\na Backend"})," when creating a ",(0,c.jsx)(s.strong,{children:"dedicated"})," load balancer."]}),"\n"]})}),"\n",(0,c.jsxs)(s.ol,{children:["\n",(0,c.jsxs)(s.li,{children:["\n",(0,c.jsxs)(s.p,{children:[(0,c.jsx)(s.a,{href:"https://docs.otc.t-systems.com/elastic-load-balancing/umn/listener/adding_a_tcp_listener.html",children:"Add a TCP listener"}),"\nto the dedicated load balancer."]}),"\n",(0,c.jsx)(s.admonition,{type:"note",children:(0,c.jsxs)(s.ul,{children:["\n",(0,c.jsxs)(s.li,{children:["When adding a backend server, click the ",(0,c.jsx)(s.em,{children:"IP as Backend\nServers"})," tab and then click ",(0,c.jsx)(s.em,{children:"Add IP as Backend Sever"}),"."]}),"\n",(0,c.jsxs)(s.li,{children:["In the ",(0,c.jsx)(s.em,{children:"Backend Server IP Address Column"}),", enter the IP address\nand in the Backend Port Column, enter the port number of your\nDCS instance."]}),"\n",(0,c.jsxs)(s.li,{children:["A Redis Cluster DCS instance contains multiple master/replica\npairs. When configuring an IP as Backend server, you can add the\nIP address and port number of ",(0,c.jsx)(s.strong,{children:"any"})," master or replica node."]}),"\n",(0,c.jsxs)(s.li,{children:["If you enable ",(0,c.jsx)(s.em,{children:"Health Check"}),", you do not need to manually\nconfigure the port. By default, the service port of the backend\nserver will be used."]}),"\n"]})}),"\n"]}),"\n",(0,c.jsxs)(s.li,{children:["\n",(0,c.jsxs)(s.p,{children:[(0,c.jsx)(s.a,{href:"https://docs.otc.t-systems.com/virtual-private-cloud/umn/vpc_peering_connection/creating_a_vpc_peering_connection_with_a_vpc_in_another_account.html#en-us-topic-0046655038",children:"Create a VPC peering connection"}),".\nFor the local VPC, select the VPC where your load balancer is located. For the peer VPC, select the VPC where your DCS instance is\nlocated."]}),"\n",(0,c.jsx)(s.admonition,{type:"note",children:(0,c.jsx)(s.p,{children:"Even if your load balancer and DCS instance are in the same VPC, you\nstill need to create a VPC peering connection. For the local VPC,\nselect the VPC where your load balancer and DCS instance are\nlocated. For the peer VPC, select another VPC."})}),"\n"]}),"\n",(0,c.jsxs)(s.li,{children:["\n",(0,c.jsxs)(s.p,{children:["Click the name of the VPC peering connection to go to its details\npage. Obtain ",(0,c.jsx)(s.em,{children:"Local VPC CIDR Block"})," and ",(0,c.jsx)(s.em,{children:"Peer VPC CIDR Block"}),"."]}),"\n",(0,c.jsx)(s.p,{children:(0,c.jsx)(s.img,{src:"https://arch-assets-dev.obs.eu-de.otc.t-systems.com/static/img/docs/best-practices/databases/distributed-cache-service/en-us_image_0000001616102745.png",alt:"image1"})}),"\n"]}),"\n",(0,c.jsxs)(s.li,{children:["\n",(0,c.jsx)(s.p,{children:"Configure local and peer routes for the VPC peering connection."}),"\n",(0,c.jsxs)(s.p,{children:["a.  On the ",(0,c.jsx)(s.em,{children:"Local Routes"})," and ",(0,c.jsx)(s.em,{children:"Peer Routes"})," tab pages, click the\nlink to go to the ",(0,c.jsx)(s.em,{children:"Route Tables"})," page."]}),"\n",(0,c.jsx)(s.p,{children:(0,c.jsx)(s.img,{src:"https://arch-assets-dev.obs.eu-de.otc.t-systems.com/static/img/docs/best-practices/databases/distributed-cache-service/en-us_image_0000001565366900.png",alt:"image2"})}),"\n",(0,c.jsxs)(s.p,{children:["b.  Local route: On the summary page of local routes, click ",(0,c.jsx)(s.em,{children:"Add\nRoute"}),". In the displayed ",(0,c.jsx)(s.em,{children:"Add Route"})," dialog box, set\n",(0,c.jsx)(s.em,{children:"Destination"})," to the value of ",(0,c.jsx)(s.em,{children:"Peer VPC CIDR Block"})," of the\nVPC peering connection, set ",(0,c.jsx)(s.em,{children:"Next Hop Type"})," to ",(0,c.jsx)(s.em,{children:"VPC peering\nconnection"}),", set ",(0,c.jsx)(s.em,{children:"Next Hop"})," to the VPC peering connection\ncreated in ",(0,c.jsx)(s.code,{children:"5 <dcs-bp-211201001__li782011051412>"}),", and click\n",(0,c.jsx)(s.em,{children:"OK"}),"."]}),"\n",(0,c.jsxs)(s.p,{children:["c.  Peer route: On the summary page of peer routes, click ",(0,c.jsx)(s.em,{children:"Add\nRoute"}),". In the displayed ",(0,c.jsx)(s.em,{children:"Add Route"})," dialog box, set\n",(0,c.jsx)(s.em,{children:"Destination"})," to the value of ",(0,c.jsx)(s.em,{children:"Local VPC CIDR Block"})," of the\nVPC peering connection, set ",(0,c.jsx)(s.em,{children:"Next Hop Type"})," to ",(0,c.jsx)(s.em,{children:"VPC peering\nconnection"}),", set ",(0,c.jsx)(s.em,{children:"Next Hop"})," to the VPC peering connection\ncreated in ",(0,c.jsx)(s.code,{children:"5 <dcs-bp-211201001__li782011051412>"}),", and click\n",(0,c.jsx)(s.em,{children:"OK"}),"."]}),"\n",(0,c.jsx)(s.admonition,{type:"note",children:(0,c.jsx)(s.p,{children:"If the load balancer and the DCS instance are in the same VPC,\nyou do not need to add a peer route.\n:::"})}),"\n"]}),"\n",(0,c.jsxs)(s.li,{children:["\n",(0,c.jsxs)(s.p,{children:["Perform a health check on the IP address of the DCS instance. If the\nhealth check result is ",(0,c.jsx)(s.code,{children:"Healthy"}),", the added cross-VPC backend IP\naddress can be used."]}),"\n",(0,c.jsxs)(s.p,{children:["a.  In the navigation pane of ",(0,c.jsx)(s.em,{children:"Network Console"}),", choose ",(0,c.jsx)(s.em,{children:"Elastic\nLoad Balance"})," -> ",(0,c.jsx)(s.em,{children:"Load Balancers"}),".\nb.  Click the name of the created Elastic Load Balancer.\nc.  On the ",(0,c.jsx)(s.em,{children:"Backend Server Server Groups"})," -> ",(0,c.jsx)(s.em,{children:"IP as Backend\nServers"})," tab page, view the health check result of the DCS\ninstance IP address."]}),"\n",(0,c.jsx)(s.p,{children:(0,c.jsx)(s.img,{src:"https://arch-assets-dev.obs.eu-de.otc.t-systems.com/static/img/docs/best-practices/databases/distributed-cache-service/en-us_image_0000001260455881.png",alt:"image3"})}),"\n"]}),"\n"]}),"\n",(0,c.jsx)(s.h2,{id:"connecting-to-the-dcs-instance-through-elb",children:"Connecting to the DCS Instance Through ELB"}),"\n",(0,c.jsxs)(s.ul,{children:["\n",(0,c.jsxs)(s.li,{children:["\n",(0,c.jsxs)(s.p,{children:["Connecting to a node in a Redis Cluster DCS instance through ELB\na.  View the basic information of the load balancer created in\n",(0,c.jsx)(s.code,{children:"3 <dcs-bp-211201001__li185984400426>"}),"."]}),"\n",(0,c.jsx)(s.p,{children:(0,c.jsx)(s.img,{src:"https://arch-assets-dev.obs.eu-de.otc.t-systems.com/static/img/docs/best-practices/databases/distributed-cache-service/en-us_image_0000001229563929.png",alt:"image4"})}),"\n",(0,c.jsxs)(s.p,{children:["b.  ",(0,c.jsx)(s.a,{href:"https://docs.otc.t-systems.com/elastic-cloud-server/umn/getting_started/creating_an_ecs/index.html#en-us-topic-0021831611",children:"Create an\nECS"}),",\nlog in to it, and install the Redis client by referring to\n",(0,c.jsx)(s.a,{href:"https://docs.otc.t-systems.com/distributed-cache-service/umn/getting_started/accessing_an_instance/accessing_a_dcs_redis_instance_through_redis-cli.html#dcs-ug-0326009",children:"redis-cli"}),"."]}),"\n",(0,c.jsxs)(s.p,{children:["c.  On the Redis client, connect to the DCS instance using the IP\naddress and port number configured in\n",(0,c.jsx)(s.code,{children:"4 <dcs-bp-211201001__li2180434205513>"}),". If you use the EIP and\nport number of the load balancer, an error will be reported."]}),"\n",(0,c.jsx)(s.p,{children:(0,c.jsx)(s.img,{src:"https://arch-assets-dev.obs.eu-de.otc.t-systems.com/static/img/docs/best-practices/databases/distributed-cache-service/en-us_image_0000001229643735.png",alt:"image5"})}),"\n"]}),"\n",(0,c.jsxs)(s.li,{children:["\n",(0,c.jsxs)(s.p,{children:["Connecting to a single-node, master/standby, read/write splitting,\nor Proxy Cluster DCS instance through ELB\na.  View the IPv4 EIP and port number of the load balancer created\nin ",(0,c.jsx)(s.code,{children:"3 <dcs-bp-211201001__li185984400426>"}),"."]}),"\n",(0,c.jsx)(s.p,{children:(0,c.jsx)(s.img,{src:"https://arch-assets-dev.obs.eu-de.otc.t-systems.com/static/img/docs/best-practices/databases/distributed-cache-service/en-us_image_0000001229563929.png",alt:"image6"})}),"\n",(0,c.jsx)(s.p,{children:(0,c.jsx)(s.img,{src:"https://arch-assets-dev.obs.eu-de.otc.t-systems.com/static/img/docs/best-practices/databases/distributed-cache-service/en-us_image_0000001229645007.png",alt:"image7"})}),"\n",(0,c.jsxs)(s.p,{children:["b.  ",(0,c.jsx)(s.a,{href:"https://docs.otc.t-systems.com/elastic-cloud-server/umn/getting_started/creating_an_ecs/index.html#en-us-topic-0021831611",children:"Create an\nECS"}),",\nlog in to it, and install the Redis client by referring to\n",(0,c.jsx)(s.a,{href:"https://docs.otc.t-systems.com/distributed-cache-service/umn/getting_started/accessing_an_instance/accessing_a_dcs_redis_instance_through_redis-cli.html#dcs-ug-0326009",children:"redis-cli"}),"."]}),"\n",(0,c.jsxs)(s.p,{children:["c.  Use ",(0,c.jsx)(s.strong,{children:"redis-cli"})," to access the load balancer using its EIP and port\nnumber (which is ",(0,c.jsx)(s.code,{children:"80"}),")."]}),"\n",(0,c.jsx)(s.p,{children:(0,c.jsx)(s.img,{src:"https://arch-assets-dev.obs.eu-de.otc.t-systems.com/static/img/docs/best-practices/databases/distributed-cache-service/en-us_image_0000001229765759.png",alt:"image8"})}),"\n",(0,c.jsx)(s.p,{children:"d.  Write a key through ELB."}),"\n",(0,c.jsx)(s.p,{children:(0,c.jsx)(s.img,{src:"https://arch-assets-dev.obs.eu-de.otc.t-systems.com/static/img/docs/best-practices/databases/distributed-cache-service/en-us_image_0000001229765989.png",alt:"image9"})}),"\n",(0,c.jsxs)(s.p,{children:["e.  Log in to the DCS console. On the ",(0,c.jsx)(s.em,{children:"Cache Manager"})," page, choose\n",(0,c.jsx)(s.em,{children:"More"})," -> ",(0,c.jsx)(s.em,{children:"Connect to Redis"})," in the row that contains the\nDCS instance created in ",(0,c.jsx)(s.code,{children:"2 <dcs-bp-211201001__li145661168417>"}),".\nCheck whether the key written in\n",(0,c.jsx)(s.code,{children:"4 <dcs-bp-211201001__li352815512015>"})," exists."]}),"\n",(0,c.jsx)(s.p,{children:(0,c.jsx)(s.img,{src:"https://arch-assets-dev.obs.eu-de.otc.t-systems.com/static/img/docs/best-practices/databases/distributed-cache-service/en-us_image_0000001183928408.png",alt:"image10"})}),"\n"]}),"\n"]})]})}function h(e={}){const{wrapper:s}={...(0,i.R)(),...e.components};return s?(0,c.jsx)(s,{...e,children:(0,c.jsx)(l,{...e})}):l(e)}},28453:(e,s,n)=>{n.d(s,{R:()=>a,x:()=>r});var t=n(96540);const c={},i=t.createContext(c);function a(e){const s=t.useContext(i);return t.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function r(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(c):e.components||c:a(e.components),t.createElement(i.Provider,{value:s},e.children)}}}]);