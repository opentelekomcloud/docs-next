<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-blueprints/by-use-case/security/microsoft/deploy-active-directory-federation-services-on-ecs" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.9.1">
<title data-rh="true">Deploy Active Directory Federation Services on ECS | Architecture Center</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://opentelekomcloud.github.io/docs-next/pr-preview/pr-330/img/open-telekom-cloud-social-card.png"><meta data-rh="true" name="twitter:image" content="https://opentelekomcloud.github.io/docs-next/pr-preview/pr-330/img/open-telekom-cloud-social-card.png"><meta data-rh="true" property="og:url" content="https://opentelekomcloud.github.io/docs-next/pr-preview/pr-330/docs/blueprints/by-use-case/security/microsoft/deploy-active-directory-federation-services-on-ecs"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Deploy Active Directory Federation Services on ECS | Architecture Center"><meta data-rh="true" name="description" content="In this guide, we&#x27;ll walk you through deploying Microsoft Active Directory Federation Service (AD FS) on ECS. We&#x27;ll cover everything from installing Active Directory Domain Services &amp; Active Directory Certificate Services, preparing SSL certificates, configuring DNS zones till installing and configuring an AD FS farm."><meta data-rh="true" property="og:description" content="In this guide, we&#x27;ll walk you through deploying Microsoft Active Directory Federation Service (AD FS) on ECS. We&#x27;ll cover everything from installing Active Directory Domain Services &amp; Active Directory Certificate Services, preparing SSL certificates, configuring DNS zones till installing and configuring an AD FS farm."><link data-rh="true" rel="icon" href="/docs-next/pr-preview/pr-330/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://opentelekomcloud.github.io/docs-next/pr-preview/pr-330/docs/blueprints/by-use-case/security/microsoft/deploy-active-directory-federation-services-on-ecs"><link data-rh="true" rel="alternate" href="https://opentelekomcloud.github.io/docs-next/pr-preview/pr-330/docs/blueprints/by-use-case/security/microsoft/deploy-active-directory-federation-services-on-ecs" hreflang="en"><link data-rh="true" rel="alternate" href="https://opentelekomcloud.github.io/docs-next/pr-preview/pr-330/docs/blueprints/by-use-case/security/microsoft/deploy-active-directory-federation-services-on-ecs" hreflang="x-default"><link rel="preconnect" href="https://analytics.example.de">
<script async defer="defer" src="https://analytics.example.de/script.js" data-website-id="00000" data-host-url="https://analytics.example.de" data-auto-track="true" data-do-not-track="true" data-cache="true" data-domains="opentelekomcloud.github.io" data-exclude-search="false" data-exclude-hash="false"></script><link rel="stylesheet" href="/docs-next/pr-preview/pr-330/assets/css/styles.a3f3a85d.css">
<script src="/docs-next/pr-preview/pr-330/assets/js/runtime~main.671839f9.js" defer="defer"></script>
<script src="/docs-next/pr-preview/pr-330/assets/js/main.152574bb.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",t||(window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light")),document.documentElement.setAttribute("data-theme-choice",t||"system")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/docs-next/pr-preview/pr-330/"><div class="navbar__logo"><img src="/docs-next/pr-preview/pr-330/img/logo_headline_kombination_m_s_m.png" alt="Open Telekom Cloud Non-Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/docs-next/pr-preview/pr-330/img/logo_headline_kombination_m_w_m.png" alt="Open Telekom Cloud Non-Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div></a><a class="navbar__item navbar__link" href="/docs-next/pr-preview/pr-330/docs/best-practices/">Best Practices</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs-next/pr-preview/pr-330/docs/blueprints/">Blueprints</a><a class="navbar__item navbar__link" href="/docs-next/pr-preview/pr-330/templates">Templates</a><a class="navbar__item navbar__link" href="/docs-next/pr-preview/pr-330/webinars">Webinars</a></div><div class="navbar__items navbar__items--right"><a href="https://auth.otc.t-systems.com/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link navbar--terminal-link" aria-label="Open Telekom Cloud Console"></a><a href="https://status.otc-service.com/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link navbar--sd-link" aria-label="GitHub"></a><div class="toggle_vylO colorModeToggle_x44X"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="light mode" aria-label="Switch between dark and light mode (currently light mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_dCNk"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs-next/pr-preview/pr-330/docs/blueprints/"><span title="Blueprints" class="linkLabel_WmDU">Blueprints</span></a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--active" href="/docs-next/pr-preview/pr-330/docs/blueprints/by-use-case/"><span title="By Use Case" class="categoryLinkLabel_W154">By Use Case</span></a><button aria-label="Collapse sidebar category &#x27;By Use Case&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex="0" href="/docs-next/pr-preview/pr-330/docs/blueprints/by-use-case/ai/"><span title="AI &amp; LLMs" class="categoryLinkLabel_W154">AI &amp; LLMs</span></a><button aria-label="Expand sidebar category &#x27;AI &amp; LLMs&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex="0" href="/docs-next/pr-preview/pr-330/docs/blueprints/by-use-case/analytics/"><span title="Analytics" class="categoryLinkLabel_W154">Analytics</span></a><button aria-label="Expand sidebar category &#x27;Analytics&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex="0" href="/docs-next/pr-preview/pr-330/docs/blueprints/by-use-case/collaboration/"><span title="Collaboration" class="categoryLinkLabel_W154">Collaboration</span></a><button aria-label="Expand sidebar category &#x27;Collaboration&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex="0" href="/docs-next/pr-preview/pr-330/docs/blueprints/by-use-case/devops/"><span title="DevOps" class="categoryLinkLabel_W154">DevOps</span></a><button aria-label="Expand sidebar category &#x27;DevOps&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex="0" href="/docs-next/pr-preview/pr-330/docs/blueprints/by-use-case/networking/"><span title="Networking" class="categoryLinkLabel_W154">Networking</span></a><button aria-label="Expand sidebar category &#x27;Networking&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex="0" href="/docs-next/pr-preview/pr-330/docs/blueprints/by-use-case/observability/"><span title="Observability" class="categoryLinkLabel_W154">Observability</span></a><button aria-label="Expand sidebar category &#x27;Observability&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--active" tabindex="0" href="/docs-next/pr-preview/pr-330/docs/blueprints/by-use-case/security/"><span title="Security" class="categoryLinkLabel_W154">Security</span></a><button aria-label="Collapse sidebar category &#x27;Security&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex="0" href="/docs-next/pr-preview/pr-330/docs/blueprints/by-use-case/security/authentik/authentik"><span title="Authentik" class="categoryLinkLabel_W154">Authentik</span></a><button aria-label="Expand sidebar category &#x27;Authentik&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex="0" href="/docs-next/pr-preview/pr-330/docs/blueprints/by-use-case/security/keycloak/keycloak"><span title="Keycloak" class="categoryLinkLabel_W154">Keycloak</span></a><button aria-label="Expand sidebar category &#x27;Keycloak&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--active" tabindex="0" href="/docs-next/pr-preview/pr-330/docs/blueprints/by-use-case/security/microsoft/microsoft"><span title="Microsoft" class="categoryLinkLabel_W154">Microsoft</span></a><button aria-label="Collapse sidebar category &#x27;Microsoft&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs-next/pr-preview/pr-330/docs/blueprints/by-use-case/security/microsoft/active-directory-as-identity-provider-iam"><span title="Active Directory as Identity Provider for IAM" class="linkLabel_WmDU">Active Directory as Identity Provider for IAM</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs-next/pr-preview/pr-330/docs/blueprints/by-use-case/security/microsoft/azure-entraid-as-identity-provider-iam"><span title="Azure Entra ID as Identity Provider for IAM" class="linkLabel_WmDU">Azure Entra ID as Identity Provider for IAM</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs-next/pr-preview/pr-330/docs/blueprints/by-use-case/security/microsoft/deploy-active-directory-federation-services-on-ecs"><span title="Deploy Active Directory Federation Services on ECS" class="linkLabel_WmDU">Deploy Active Directory Federation Services on ECS</span></a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex="0" href="/docs-next/pr-preview/pr-330/docs/blueprints/by-use-case/security/zitadel/zitadel"><span title="ZITADEL" class="categoryLinkLabel_W154">ZITADEL</span></a><button aria-label="Expand sidebar category &#x27;ZITADEL&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs-next/pr-preview/pr-330/docs/blueprints/by-use-case/security/cce-vault"><span title="Secrets management with CCE and Hashicorp Vault" class="linkLabel_WmDU">Secrets management with CCE and Hashicorp Vault</span></a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex="0" href="/docs-next/pr-preview/pr-330/docs/blueprints/by-use-case/sovereignty/"><span title="Sovereignty" class="categoryLinkLabel_W154">Sovereignty</span></a><button aria-label="Expand sidebar category &#x27;Sovereignty&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex="0" href="/docs-next/pr-preview/pr-330/docs/blueprints/by-use-case/storage/"><span title="Storage" class="categoryLinkLabel_W154">Storage</span></a><button aria-label="Expand sidebar category &#x27;Storage&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" href="/docs-next/pr-preview/pr-330/docs/blueprints/by-industry/"><span title="By Industry" class="categoryLinkLabel_W154">By Industry</span></a><button aria-label="Expand sidebar category &#x27;By Industry&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Alpn" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/docs-next/pr-preview/pr-330/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_xK9p"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs-next/pr-preview/pr-330/docs/blueprints/by-use-case/"><span itemprop="name">By Use Case</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs-next/pr-preview/pr-330/docs/blueprints/by-use-case/security/"><span itemprop="name">Security</span></a><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs-next/pr-preview/pr-330/docs/blueprints/by-use-case/security/microsoft/microsoft"><span itemprop="name">Microsoft</span></a><meta itemprop="position" content="3"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Deploy Active Directory Federation Services on ECS</span><meta itemprop="position" content="4"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Deploy Active Directory Federation Services on ECS</h1></header>
<p>In this guide, we&#x27;ll walk you through deploying Microsoft Active Directory Federation Service (AD FS) on ECS. We&#x27;ll cover everything from installing Active Directory Domain Services &amp; Active Directory Certificate Services, preparing SSL certificates, configuring DNS zones till installing and configuring an AD FS farm.</p>
<div class="theme-admonition theme-admonition-warning admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>disclaimer</div><div class="admonitionContent_BuS1"><p>Deploying Active Directory Domain Services (AD DS), Active Directory Certificate Services (AD CS), and Active Directory Federation Services (AD FS) all on a single Windows server is supported for proof-of-concept or lab environments but is not recommended for production. Co-locating these roles can lead to:</p><ul>
<li><strong>Resource Contention</strong>: Directory replication, certificate issuance and federation token processing all compete for CPU, memory and I/O, potentially degrading performance.</li>
<li><strong>Security Boundaries</strong>: A compromise of one service (e.g. the CA) could expose your entire identity infrastructure—isolating roles on dedicated VMs or hardened physical hosts reduces blast radius.</li>
<li><strong>Patch and Maintenance Complexity</strong>: Windows updates or configuration changes for one role may inadvertently impact the others, complicating change windows and downtime planning.</li>
</ul><p>For resilient, secure operations, follow Microsoft&#x27;s <a href="https://learn.microsoft.com/en-us/windows-server/identity/ad-fs/deployment/best-practices-securing-ad-fs" target="_blank" rel="noopener noreferrer">best practices</a> by placing AD DS, AD CS and AD FS on separate servers, enforce strict network segmentation, and implement a robust backup and DR strategy.</p></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="prerequisites">Prerequisites<a href="#prerequisites" class="hash-link" aria-label="Direct link to Prerequisites" title="Direct link to Prerequisites" translate="no">​</a></h2>
<p>Before proceeding with the deployment, make sure you have control over a publicly registered domain name. This is required for configuring a public endpoint for AD FS and enabling secure communication over HTTPS.</p>
<p>For the rest of this blueprint we are going to assume:</p>
<ul>
<li><strong>Public Domain</strong>: <code>example.com</code></li>
<li><strong>Private Domain</strong>: <code>mycompany.com</code></li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="creating-an-ecs-server">Creating an ECS Server<a href="#creating-an-ecs-server" class="hash-link" aria-label="Direct link to Creating an ECS Server" title="Direct link to Creating an ECS Server" translate="no">​</a></h2>
<p>Go to <em>Open Telekom Cloud Console</em> -&gt; <em>Elastic Cloud Server</em> and click <em>Create ECS Server</em>. Choose :</p>
<ul>
<li><strong>Flavor</strong>: &quot;<em>General-purpose s7n.large.2</em>&quot;</li>
<li><strong>Image</strong>: <em>Public Image</em> -&gt; &quot;<em>Windows</em>&quot; -&gt; &quot;<em>Enterprise_Windows_Server_2025_STD_amd64_bios_latest</em>&quot;</li>
<li><strong>Security Group</strong>: Add the following <strong>Inbound Rules</strong> to a new Security Group (or amend an existing one):<!-- -->
<ul>
<li><code>TCP/80</code>, <code>TCP/443</code></li>
<li><code>TCP/3389 </code></li>
</ul>
</li>
<li><strong>EIP</strong>: Click on &quot;<em>Auto assign</em>&quot;</li>
</ul>
<p>Complete the wizard and deploy the ECS instance. Once the deployment completes, return the <em>Elastic Cloud Server</em>, enter your ECS instance
and click <em>More</em> -&gt; <em>Get Password</em>. Click <em>Select File</em> to select the Key Pair you used during the installation and click <em>Get Password</em> in order
to get the credentials for the local Administrator account.</p>
<div class="carousel-container" style="position:relative;width:100%;height:400px;overflow:hidden;margin-bottom:24px"><button style="position:absolute;top:50%;transform:translateY(-50%);background:rgba(0, 0, 0, 0.5);border:none;color:#fff;padding:0.5rem 1rem;cursor:pointer;z-index:1;left:10px" aria-label="Previous slide">‹</button><div style="display:flex;height:100%;transition:transform 0.5s ease-in-out;transform:translateX(-0%)"><div style="flex:0 0 100%;height:100%;display:flex;align-items:center;justify-content:center;cursor:zoom-in" role="button" aria-label="Zoom slide 1"><img src="/docs-next/pr-preview/pr-330/img/docs/blueprints/by-use-case/security/microsoft/Screenshot_from_2025-04-21_06-23-43.png"></div><div style="flex:0 0 100%;height:100%;display:flex;align-items:center;justify-content:center;cursor:zoom-in" role="button" aria-label="Zoom slide 2"><img src="/docs-next/pr-preview/pr-330/img/docs/blueprints/by-use-case/security/microsoft/Screenshot_from_2025-04-21_06-24-03.png"></div><div style="flex:0 0 100%;height:100%;display:flex;align-items:center;justify-content:center;cursor:zoom-in" role="button" aria-label="Zoom slide 3"><img src="/docs-next/pr-preview/pr-330/img/docs/blueprints/by-use-case/security/microsoft/Screenshot_from_2025-04-21_06-20-45.png"></div><div style="flex:0 0 100%;height:100%;display:flex;align-items:center;justify-content:center;cursor:zoom-in" role="button" aria-label="Zoom slide 4"><img src="/docs-next/pr-preview/pr-330/img/docs/blueprints/by-use-case/security/microsoft/Screenshot_from_2025-04-21_06-25-43.png"></div></div><button style="position:absolute;top:50%;transform:translateY(-50%);background:rgba(0, 0, 0, 0.5);border:none;color:#fff;padding:0.5rem 1rem;cursor:pointer;z-index:1;right:10px" aria-label="Next slide">›</button><div style="position:absolute;bottom:10px;width:100%;display:flex;justify-content:center;gap:0.5rem;z-index:1"><div style="width:10px;height:10px;border-radius:50%;background:#000;cursor:pointer" aria-label="Go to slide 1"></div><div style="width:10px;height:10px;border-radius:50%;background:#ccc;cursor:pointer" aria-label="Go to slide 2"></div><div style="width:10px;height:10px;border-radius:50%;background:#ccc;cursor:pointer" aria-label="Go to slide 3"></div><div style="width:10px;height:10px;border-radius:50%;background:#ccc;cursor:pointer" aria-label="Go to slide 4"></div></div></div>
<div class="theme-admonition theme-admonition-important admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>important</div><div class="admonitionContent_BuS1"><ul>
<li>Make sure you save the Key Pair (a <code>.pem</code> file) after its creation in your working station.</li>
<li>Getting the password will not be available for the first 3-5min after the creation of the instance.</li>
</ul></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="creating-a-public-dns-endpoint">Creating a Public DNS Endpoint<a href="#creating-a-public-dns-endpoint" class="hash-link" aria-label="Direct link to Creating a Public DNS Endpoint" title="Direct link to Creating a Public DNS Endpoint" translate="no">​</a></h2>
<p>When integrating AD FS as an Identity Provider (IdP) within your Open Telekom Cloud tenant—it is essential that the Elastic IP (EIP) assigned to your ECS Server
resolves to a valid and secure FQDN. This means the public DNS entry must point to the EIP and be backed by a properly issued TLS certificate.</p>
<p>Without this, the Open Telekom Cloud platform will not accept the IdP registration due to trust and validation requirements.
Ensuring your AD FS endpoint is accessible over a recognized, secure URL is not just best practice—it&#x27;s a prerequisite for federation scenarios with OTC&#x27;s IAM services.</p>
<p>To enable full DNS-based automation and allow for secure domain validation—especially when configuring AD FS as an Identity Provider—you need to delegate domain management to Open Telekom Cloud&#x27;s Domain Name Service (DNS). This requires transferring authority over your domain&#x27;s NS (Name Server) records to OTC.</p>
<p>Start by logging into your domain registrar&#x27;s control panel and ensure the following:</p>
<ol>
<li>Disable any dynamic DNS features associated with the domain or subdomains that will be used by AD FS endpoints.</li>
<li>Update the NS records of your domain to point exclusively to the following OTC name servers.</li>
</ol>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(220, 13%, 18%);--prism-color:hsl(220, 14%, 71%)"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="background-color:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">ns1.open-telekom-cloud.com</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">ns2.open-telekom-cloud.com</span><br></span></code></pre></div></div>
<p>Once the nameserver change propagates and OTC has authoritative control over your domain, you&#x27;re ready to define DNS zones and records.
Create a Public DNS Zone in the Open Telekom Cloud DNS service, then define an <strong>A record</strong> that maps your AD FS public domain (e.g., <code>adfs.example.com</code>) to the EIP you&#x27;ve already assigned to your ECS Server.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="installing-active-directory-domain-services">Installing Active Directory Domain Services<a href="#installing-active-directory-domain-services" class="hash-link" aria-label="Direct link to Installing Active Directory Domain Services" title="Direct link to Installing Active Directory Domain Services" translate="no">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="installing-the-server-roles">Installing the Server Roles<a href="#installing-the-server-roles" class="hash-link" aria-label="Direct link to Installing the Server Roles" title="Direct link to Installing the Server Roles" translate="no">​</a></h3>
<ol>
<li>Open <em>Server Manager</em> → <em>Add roles and features</em>.</li>
<li>Select &quot;<em>Role-based or feature-based installation</em>&quot; and choose the ECS Server from the <em>Server Pool</em>.</li>
<li>Under <em>Server Roles</em>, check &quot;<em>Active Directory Domain Services</em>&quot; and &quot;<em>DNS Server</em>&quot;</li>
<li>Click <em>Next</em> through the wizard, confirm installation selections and click <em>Install</em>.</li>
</ol>
<div class="carousel-container" style="position:relative;width:100%;height:400px;overflow:hidden;margin-bottom:24px"><button style="position:absolute;top:50%;transform:translateY(-50%);background:rgba(0, 0, 0, 0.5);border:none;color:#fff;padding:0.5rem 1rem;cursor:pointer;z-index:1;left:10px" aria-label="Previous slide">‹</button><div style="display:flex;height:100%;transition:transform 0.5s ease-in-out;transform:translateX(-0%)"><div style="flex:0 0 100%;height:100%;display:flex;align-items:center;justify-content:center;cursor:zoom-in" role="button" aria-label="Zoom slide 1"><img src="/docs-next/pr-preview/pr-330/img/docs/blueprints/by-use-case/security/microsoft/Screenshot_from_2025-04-21_06-46-38.png"></div><div style="flex:0 0 100%;height:100%;display:flex;align-items:center;justify-content:center;cursor:zoom-in" role="button" aria-label="Zoom slide 2"><img src="/docs-next/pr-preview/pr-330/img/docs/blueprints/by-use-case/security/microsoft/Screenshot_from_2025-04-21_06-46-53.png"></div><div style="flex:0 0 100%;height:100%;display:flex;align-items:center;justify-content:center;cursor:zoom-in" role="button" aria-label="Zoom slide 3"><img src="/docs-next/pr-preview/pr-330/img/docs/blueprints/by-use-case/security/microsoft/Screenshot_from_2025-04-21_06-47-03.png"></div><div style="flex:0 0 100%;height:100%;display:flex;align-items:center;justify-content:center;cursor:zoom-in" role="button" aria-label="Zoom slide 4"><img src="/docs-next/pr-preview/pr-330/img/docs/blueprints/by-use-case/security/microsoft/Screenshot_from_2025-04-21_06-47-32.png"></div><div style="flex:0 0 100%;height:100%;display:flex;align-items:center;justify-content:center;cursor:zoom-in" role="button" aria-label="Zoom slide 5"><img src="/docs-next/pr-preview/pr-330/img/docs/blueprints/by-use-case/security/microsoft/Screenshot_from_2025-04-21_06-48-21.png"></div><div style="flex:0 0 100%;height:100%;display:flex;align-items:center;justify-content:center;cursor:zoom-in" role="button" aria-label="Zoom slide 6"><img src="/docs-next/pr-preview/pr-330/img/docs/blueprints/by-use-case/security/microsoft/Screenshot_from_2025-04-21_06-49-00.png"></div><div style="flex:0 0 100%;height:100%;display:flex;align-items:center;justify-content:center;cursor:zoom-in" role="button" aria-label="Zoom slide 7"><img src="/docs-next/pr-preview/pr-330/img/docs/blueprints/by-use-case/security/microsoft/Screenshot_from_2025-04-21_06-49-06.png"></div></div><button style="position:absolute;top:50%;transform:translateY(-50%);background:rgba(0, 0, 0, 0.5);border:none;color:#fff;padding:0.5rem 1rem;cursor:pointer;z-index:1;right:10px" aria-label="Next slide">›</button><div style="position:absolute;bottom:10px;width:100%;display:flex;justify-content:center;gap:0.5rem;z-index:1"><div style="width:10px;height:10px;border-radius:50%;background:#000;cursor:pointer" aria-label="Go to slide 1"></div><div style="width:10px;height:10px;border-radius:50%;background:#ccc;cursor:pointer" aria-label="Go to slide 2"></div><div style="width:10px;height:10px;border-radius:50%;background:#ccc;cursor:pointer" aria-label="Go to slide 3"></div><div style="width:10px;height:10px;border-radius:50%;background:#ccc;cursor:pointer" aria-label="Go to slide 4"></div><div style="width:10px;height:10px;border-radius:50%;background:#ccc;cursor:pointer" aria-label="Go to slide 5"></div><div style="width:10px;height:10px;border-radius:50%;background:#ccc;cursor:pointer" aria-label="Go to slide 6"></div><div style="width:10px;height:10px;border-radius:50%;background:#ccc;cursor:pointer" aria-label="Go to slide 7"></div></div></div>
<p>or run as Administrator the following Powershell command:</p>
<div class="language-Powershell language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(220, 13%, 18%);--prism-color:hsl(220, 14%, 71%)"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar" style="background-color:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token function" style="color:hsl(207, 82%, 66%)">Install-WindowsFeature</span><span class="token plain"> AD-Domain-Services</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> DNS </span><span class="token operator" style="color:hsl(207, 82%, 66%)">-</span><span class="token plain">IncludeManagementTools</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="promoting-ecs-server-to-domain-controller">Promoting ECS Server to Domain Controller<a href="#promoting-ecs-server-to-domain-controller" class="hash-link" aria-label="Direct link to Promoting ECS Server to Domain Controller" title="Direct link to Promoting ECS Server to Domain Controller" translate="no">​</a></h3>
<p>Once the ADDS role installation completes, the <em>Post-Deployment Configuration</em> link appears in <em>Server Manager</em> -&gt; <em>Tasks</em>:</p>
<ol>
<li>Click <em>Promote this server to a domain controller</em>.</li>
<li>Choose <em>Add a new forest</em> and enter <code>mycompany.com</code> as domain name .</li>
<li>Specify a <em>Directory Services Restore Mode (DSRM)</em> password.</li>
<li>Accept <em>NETBIOS domain name</em> as is and <strong>disable</strong> (if it&#x27;s enabled) the <em>Create DNS delegation</em> option.</li>
<li>Accept default locations for the database, log files and SYSVOL.</li>
<li>Review prerequisites, then click <em>Install</em>. The server will reboot when promotion finishes.</li>
</ol>
<div class="carousel-container" style="position:relative;width:100%;height:400px;overflow:hidden;margin-bottom:24px"><button style="position:absolute;top:50%;transform:translateY(-50%);background:rgba(0, 0, 0, 0.5);border:none;color:#fff;padding:0.5rem 1rem;cursor:pointer;z-index:1;left:10px" aria-label="Previous slide">‹</button><div style="display:flex;height:100%;transition:transform 0.5s ease-in-out;transform:translateX(-0%)"><div style="flex:0 0 100%;height:100%;display:flex;align-items:center;justify-content:center;cursor:zoom-in" role="button" aria-label="Zoom slide 1"><img src="/docs-next/pr-preview/pr-330/img/docs/blueprints/by-use-case/security/microsoft/Screenshot_from_2025-04-21_06-56-50.png"></div><div style="flex:0 0 100%;height:100%;display:flex;align-items:center;justify-content:center;cursor:zoom-in" role="button" aria-label="Zoom slide 2"><img src="/docs-next/pr-preview/pr-330/img/docs/blueprints/by-use-case/security/microsoft/Screenshot_from_2025-04-21_06-59-35.png"></div><div style="flex:0 0 100%;height:100%;display:flex;align-items:center;justify-content:center;cursor:zoom-in" role="button" aria-label="Zoom slide 3"><img src="/docs-next/pr-preview/pr-330/img/docs/blueprints/by-use-case/security/microsoft/Screenshot_from_2025-04-21_07-00-04.png"></div><div style="flex:0 0 100%;height:100%;display:flex;align-items:center;justify-content:center;cursor:zoom-in" role="button" aria-label="Zoom slide 4"><img src="/docs-next/pr-preview/pr-330/img/docs/blueprints/by-use-case/security/microsoft/Screenshot_from_2025-04-21_07-01-05.png"></div></div><button style="position:absolute;top:50%;transform:translateY(-50%);background:rgba(0, 0, 0, 0.5);border:none;color:#fff;padding:0.5rem 1rem;cursor:pointer;z-index:1;right:10px" aria-label="Next slide">›</button><div style="position:absolute;bottom:10px;width:100%;display:flex;justify-content:center;gap:0.5rem;z-index:1"><div style="width:10px;height:10px;border-radius:50%;background:#000;cursor:pointer" aria-label="Go to slide 1"></div><div style="width:10px;height:10px;border-radius:50%;background:#ccc;cursor:pointer" aria-label="Go to slide 2"></div><div style="width:10px;height:10px;border-radius:50%;background:#ccc;cursor:pointer" aria-label="Go to slide 3"></div><div style="width:10px;height:10px;border-radius:50%;background:#ccc;cursor:pointer" aria-label="Go to slide 4"></div></div></div>
<p>Alternatively, use PowerShell:</p>
<div class="language-PowerShell language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(220, 13%, 18%);--prism-color:hsl(220, 14%, 71%)"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar" style="background-color:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token variable" style="color:hsl(207, 82%, 66%)">$secPwd</span><span class="token plain"> = </span><span class="token function" style="color:hsl(207, 82%, 66%)">ConvertTo-SecureString</span><span class="token plain"> </span><span class="token string" style="color:hsl(95, 38%, 62%)">&quot;ThisIsNotASecurePassword!&quot;</span><span class="token plain"> </span><span class="token operator" style="color:hsl(207, 82%, 66%)">-</span><span class="token plain">AsPlainText </span><span class="token operator" style="color:hsl(207, 82%, 66%)">-</span><span class="token plain">Force</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain"></span><span class="token function" style="color:hsl(207, 82%, 66%)">Install-ADDSForest</span><span class="token plain"> `</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">  </span><span class="token operator" style="color:hsl(207, 82%, 66%)">-</span><span class="token plain">DomainName </span><span class="token string" style="color:hsl(95, 38%, 62%)">&quot;mycompany.com&quot;</span><span class="token plain"> `</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">  </span><span class="token operator" style="color:hsl(207, 82%, 66%)">-</span><span class="token plain">CreateDNSDelegation:</span><span class="token boolean" style="color:hsl(29, 54%, 61%)">$false</span><span class="token plain"> `</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">  </span><span class="token operator" style="color:hsl(207, 82%, 66%)">-</span><span class="token plain">DatabasePath </span><span class="token string" style="color:hsl(95, 38%, 62%)">&quot;C:\Windows\NTDS&quot;</span><span class="token plain"> `</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">  </span><span class="token operator" style="color:hsl(207, 82%, 66%)">-</span><span class="token plain">DomainMode </span><span class="token string" style="color:hsl(95, 38%, 62%)">&quot;WinThreshold&quot;</span><span class="token plain"> `</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">  </span><span class="token operator" style="color:hsl(207, 82%, 66%)">-</span><span class="token plain">ForestMode </span><span class="token string" style="color:hsl(95, 38%, 62%)">&quot;WinThreshold&quot;</span><span class="token plain"> `</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">  </span><span class="token operator" style="color:hsl(207, 82%, 66%)">-</span><span class="token plain">InstallDNS:</span><span class="token boolean" style="color:hsl(29, 54%, 61%)">$true</span><span class="token plain"> `</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">  </span><span class="token operator" style="color:hsl(207, 82%, 66%)">-</span><span class="token plain">LogPath </span><span class="token string" style="color:hsl(95, 38%, 62%)">&quot;C:\Windows\NTDS&quot;</span><span class="token plain"> `</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">  </span><span class="token operator" style="color:hsl(207, 82%, 66%)">-</span><span class="token plain">SysvolPath </span><span class="token string" style="color:hsl(95, 38%, 62%)">&quot;C:\Windows\SYSVOL&quot;</span><span class="token plain"> `</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">  </span><span class="token operator" style="color:hsl(207, 82%, 66%)">-</span><span class="token plain">SafeModeAdministratorPassword </span><span class="token variable" style="color:hsl(207, 82%, 66%)">$secPwd</span><span class="token plain"> `</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">  </span><span class="token operator" style="color:hsl(207, 82%, 66%)">-</span><span class="token plain">Force</span><br></span></code></pre></div></div>
<div class="theme-admonition theme-admonition-warning admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>warning</div><div class="admonitionContent_BuS1"><p>Be sure to substitute every occurrence of <code>ThisIsNotASecurePassword!</code> with a strong, organization-approved password.</p></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="creating-organization-unit-users--groups">Creating Organization Unit, Users &amp; Groups<a href="#creating-organization-unit-users--groups" class="hash-link" aria-label="Direct link to Creating Organization Unit, Users &amp; Groups" title="Direct link to Creating Organization Unit, Users &amp; Groups" translate="no">​</a></h3>
<p>Before mapping roles in AD FS and Open Telekom Cloud, we need first to define our administrative scopes by provisioning a new Organization Unit (OU),
two security groups,<code>Tenant-Admins</code> and <code>ECS-Admins</code>, and then create one user per group.</p>
<ol>
<li>
<p>Open <em>Server Manager</em> -&gt; <em>Tools</em> -&gt; <em>Active Directory Users and Computers</em>, right-click on <strong>mycompany.com</strong> -&gt; <em>New</em> -&gt; <em>Organization Unit</em>.
Enter as name, the name of your Open Telekom Cloud Tenant and enable <em>&quot;Protect container from accidental deletion&quot;</em> and click <em>OK</em>.</p>
</li>
<li>
<p>Right-click the newly created OU -&gt; <em>New</em> -&gt; <em>Group</em>.</p>
<ul>
<li><strong>Group name</strong>: <code>Tenant-Admins</code></li>
<li><strong>Group scope</strong>: <em>&quot;Global&quot;</em></li>
<li><strong>Group type</strong>: <em>&quot;Security&quot;</em></li>
</ul>
<p>Repeat to create <code>ECS-Admins</code>.</p>
</li>
<li>
<p>Right-click the newly created OU -&gt; <em>New</em> -&gt; <em>User</em>. Create a new user (e.g. Erika Mustermann, <a href="mailto:merika@mycompany.com" target="_blank" rel="noopener noreferrer">merika@mycompany.com</a>) and assign them to group <strong>Tenant-Admins</strong>.</p>
</li>
<li>
<p>Right-click the newly created OU -&gt; <em>New</em> -&gt; <em>User</em>. Create a new user (e.g. Max Mustermann, <a href="mailto:mmax@mycompany.com" target="_blank" rel="noopener noreferrer">mmax@mycompany.com</a>) and assign them to group <strong>ECS-Admins</strong>.</p>
</li>
</ol>
<p><img decoding="async" loading="lazy" alt="image" src="/docs-next/pr-preview/pr-330/assets/images/Screenshot_from_2025-04-22_14-38-59-52a87ea4bb0d380f703e2af6bd51b7b5.png" width="1874" height="851" class="img_ev3q"></p>
<p>or altenative run as Administrator the following PowerShell commands:</p>
<div class="language-PowerShell language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(220, 13%, 18%);--prism-color:hsl(220, 14%, 71%)"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar" style="background-color:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token comment" style="color:hsl(220, 10%, 40%)"># Define base DN for the OTC OU in the mycompany.com domain</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain"></span><span class="token variable" style="color:hsl(207, 82%, 66%)">$otcOu</span><span class="token plain"> = </span><span class="token string" style="color:hsl(95, 38%, 62%)">&quot;OU=OTC0000001XXXXX,DC=mycompany,DC=com&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain"></span><span class="token comment" style="color:hsl(220, 10%, 40%)"># Create groups</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain"></span><span class="token function" style="color:hsl(207, 82%, 66%)">New-ADGroup</span><span class="token plain"> </span><span class="token operator" style="color:hsl(207, 82%, 66%)">-</span><span class="token plain">Name </span><span class="token string" style="color:hsl(95, 38%, 62%)">&quot;Tenant-Admins&quot;</span><span class="token plain"> </span><span class="token operator" style="color:hsl(207, 82%, 66%)">-</span><span class="token plain">GroupScope Global </span><span class="token operator" style="color:hsl(207, 82%, 66%)">-</span><span class="token plain">GroupCategory Security </span><span class="token operator" style="color:hsl(207, 82%, 66%)">-</span><span class="token plain">Path </span><span class="token variable" style="color:hsl(207, 82%, 66%)">$otcOu</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain"></span><span class="token function" style="color:hsl(207, 82%, 66%)">New-ADGroup</span><span class="token plain"> </span><span class="token operator" style="color:hsl(207, 82%, 66%)">-</span><span class="token plain">Name </span><span class="token string" style="color:hsl(95, 38%, 62%)">&quot;ECS-Admins&quot;</span><span class="token plain">    </span><span class="token operator" style="color:hsl(207, 82%, 66%)">-</span><span class="token plain">GroupScope Global </span><span class="token operator" style="color:hsl(207, 82%, 66%)">-</span><span class="token plain">GroupCategory Security </span><span class="token operator" style="color:hsl(207, 82%, 66%)">-</span><span class="token plain">Path </span><span class="token variable" style="color:hsl(207, 82%, 66%)">$otcOu</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain"></span><span class="token comment" style="color:hsl(220, 10%, 40%)"># Create users</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain"></span><span class="token function" style="color:hsl(207, 82%, 66%)">New-ADUser</span><span class="token plain"> </span><span class="token operator" style="color:hsl(207, 82%, 66%)">-</span><span class="token plain">Name </span><span class="token string" style="color:hsl(95, 38%, 62%)">&quot;Erika Mustermann&quot;</span><span class="token plain"> </span><span class="token operator" style="color:hsl(207, 82%, 66%)">-</span><span class="token plain">SamAccountName merika `</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">  </span><span class="token operator" style="color:hsl(207, 82%, 66%)">-</span><span class="token plain">UserPrincipalName merika@mycompany</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">.</span><span class="token plain">com `</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">  </span><span class="token operator" style="color:hsl(207, 82%, 66%)">-</span><span class="token plain">Path </span><span class="token variable" style="color:hsl(207, 82%, 66%)">$otcOu</span><span class="token plain"> `</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">  </span><span class="token operator" style="color:hsl(207, 82%, 66%)">-</span><span class="token plain">AccountPassword </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token function" style="color:hsl(207, 82%, 66%)">ConvertTo-SecureString</span><span class="token plain"> </span><span class="token string" style="color:hsl(95, 38%, 62%)">&quot;ThisIsNotASecurePassword!&quot;</span><span class="token plain"> </span><span class="token operator" style="color:hsl(207, 82%, 66%)">-</span><span class="token plain">AsPlainText </span><span class="token operator" style="color:hsl(207, 82%, 66%)">-</span><span class="token plain">Force</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token plain"> `</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">  </span><span class="token operator" style="color:hsl(207, 82%, 66%)">-</span><span class="token plain">Enabled </span><span class="token boolean" style="color:hsl(29, 54%, 61%)">$true</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain"></span><span class="token function" style="color:hsl(207, 82%, 66%)">New-ADUser</span><span class="token plain"> </span><span class="token operator" style="color:hsl(207, 82%, 66%)">-</span><span class="token plain">Name </span><span class="token string" style="color:hsl(95, 38%, 62%)">&quot;Max Mustermann&quot;</span><span class="token plain"> </span><span class="token operator" style="color:hsl(207, 82%, 66%)">-</span><span class="token plain">SamAccountName mmax `</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">  </span><span class="token operator" style="color:hsl(207, 82%, 66%)">-</span><span class="token plain">UserPrincipalName mmax@mycompany</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">.</span><span class="token plain">com `</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">  </span><span class="token operator" style="color:hsl(207, 82%, 66%)">-</span><span class="token plain">Path </span><span class="token variable" style="color:hsl(207, 82%, 66%)">$otcOu</span><span class="token plain"> `</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">  </span><span class="token operator" style="color:hsl(207, 82%, 66%)">-</span><span class="token plain">AccountPassword </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token function" style="color:hsl(207, 82%, 66%)">ConvertTo-SecureString</span><span class="token plain"> </span><span class="token string" style="color:hsl(95, 38%, 62%)">&quot;ThisIsNotASecurePassword!&quot;</span><span class="token plain"> </span><span class="token operator" style="color:hsl(207, 82%, 66%)">-</span><span class="token plain">AsPlainText </span><span class="token operator" style="color:hsl(207, 82%, 66%)">-</span><span class="token plain">Force</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token plain"> `</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">  </span><span class="token operator" style="color:hsl(207, 82%, 66%)">-</span><span class="token plain">Enabled </span><span class="token boolean" style="color:hsl(29, 54%, 61%)">$true</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain"></span><span class="token comment" style="color:hsl(220, 10%, 40%)"># Add users to groups</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain"></span><span class="token function" style="color:hsl(207, 82%, 66%)">Add-ADGroupMember</span><span class="token plain"> </span><span class="token operator" style="color:hsl(207, 82%, 66%)">-</span><span class="token plain">Identity </span><span class="token string" style="color:hsl(95, 38%, 62%)">&quot;Tenant-Admins&quot;</span><span class="token plain"> </span><span class="token operator" style="color:hsl(207, 82%, 66%)">-</span><span class="token plain">Members merika</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain"></span><span class="token function" style="color:hsl(207, 82%, 66%)">Add-ADGroupMember</span><span class="token plain"> </span><span class="token operator" style="color:hsl(207, 82%, 66%)">-</span><span class="token plain">Identity </span><span class="token string" style="color:hsl(95, 38%, 62%)">&quot;ECS-Admins&quot;</span><span class="token plain">    </span><span class="token operator" style="color:hsl(207, 82%, 66%)">-</span><span class="token plain">Members mmax</span><br></span></code></pre></div></div>
<div class="theme-admonition theme-admonition-warning admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>warning</div><div class="admonitionContent_BuS1"><p>Be sure to substitute every occurrence of <code>ThisIsNotASecurePassword!</code> with a strong, organization-approved password.</p></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="configuring-a-dns-zone">Configuring a DNS Zone<a href="#configuring-a-dns-zone" class="hash-link" aria-label="Direct link to Configuring a DNS Zone" title="Direct link to Configuring a DNS Zone" translate="no">​</a></h2>
<ol>
<li>Go to <em>Server Manager</em> -&gt; <em>Tools</em> -&gt; <em>DNS</em>.</li>
<li>Expand the tree and right-click <em>Forward Lookup Zones</em> -&gt; <em>New Zone</em> and click <em>Next</em>.</li>
<li>Choose <em>&quot;Primary Zone&quot;</em> as <strong>Zone Type</strong> and click <em>Next</em>.</li>
<li>Choose <em>&quot;To all DNS servers running on domain controllers in this domain: mycompany.com&quot;</em> as <strong>Active Directory Zone Replication Scope</strong> and click <em>Next</em>.</li>
<li>Enter <code>example.com</code> as <strong>Zone Name</strong> and click <em>Next</em> and <em>Finish</em>.</li>
</ol>
<p>Once the zone is created, right-click on it and then click on <em>New Host (A or AAAA)</em>. Fill in the following values for the A record and click <em>OK</em>:</p>
<ul>
<li><strong>Host</strong>: <code>adfs</code></li>
<li><strong>IP address</strong>: The private IP address of the ECS Server assigned by the VPC DHCP server.</li>
</ul>
<div class="carousel-container" style="position:relative;width:100%;height:400px;overflow:hidden;margin-bottom:24px"><button style="position:absolute;top:50%;transform:translateY(-50%);background:rgba(0, 0, 0, 0.5);border:none;color:#fff;padding:0.5rem 1rem;cursor:pointer;z-index:1;left:10px" aria-label="Previous slide">‹</button><div style="display:flex;height:100%;transition:transform 0.5s ease-in-out;transform:translateX(-0%)"><div style="flex:0 0 100%;height:100%;display:flex;align-items:center;justify-content:center;cursor:zoom-in" role="button" aria-label="Zoom slide 1"><img src="/docs-next/pr-preview/pr-330/img/docs/blueprints/by-use-case/security/microsoft/Screenshot_from_2025-04-21_13-49-24.png"></div><div style="flex:0 0 100%;height:100%;display:flex;align-items:center;justify-content:center;cursor:zoom-in" role="button" aria-label="Zoom slide 2"><img src="/docs-next/pr-preview/pr-330/img/docs/blueprints/by-use-case/security/microsoft/Screenshot_from_2025-04-21_13-49-32.png"></div><div style="flex:0 0 100%;height:100%;display:flex;align-items:center;justify-content:center;cursor:zoom-in" role="button" aria-label="Zoom slide 3"><img src="/docs-next/pr-preview/pr-330/img/docs/blueprints/by-use-case/security/microsoft/Screenshot_from_2025-04-21_13-51-15.png"></div><div style="flex:0 0 100%;height:100%;display:flex;align-items:center;justify-content:center;cursor:zoom-in" role="button" aria-label="Zoom slide 4"><img src="/docs-next/pr-preview/pr-330/img/docs/blueprints/by-use-case/security/microsoft/Screenshot_from_2025-04-21_13-50-12.png"></div><div style="flex:0 0 100%;height:100%;display:flex;align-items:center;justify-content:center;cursor:zoom-in" role="button" aria-label="Zoom slide 5"><img src="/docs-next/pr-preview/pr-330/img/docs/blueprints/by-use-case/security/microsoft/Screenshot_from_2025-04-21_13-52-11.png"></div></div><button style="position:absolute;top:50%;transform:translateY(-50%);background:rgba(0, 0, 0, 0.5);border:none;color:#fff;padding:0.5rem 1rem;cursor:pointer;z-index:1;right:10px" aria-label="Next slide">›</button><div style="position:absolute;bottom:10px;width:100%;display:flex;justify-content:center;gap:0.5rem;z-index:1"><div style="width:10px;height:10px;border-radius:50%;background:#000;cursor:pointer" aria-label="Go to slide 1"></div><div style="width:10px;height:10px;border-radius:50%;background:#ccc;cursor:pointer" aria-label="Go to slide 2"></div><div style="width:10px;height:10px;border-radius:50%;background:#ccc;cursor:pointer" aria-label="Go to slide 3"></div><div style="width:10px;height:10px;border-radius:50%;background:#ccc;cursor:pointer" aria-label="Go to slide 4"></div><div style="width:10px;height:10px;border-radius:50%;background:#ccc;cursor:pointer" aria-label="Go to slide 5"></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="installing-active-directory-certificate-services">Installing Active Directory Certificate Services<a href="#installing-active-directory-certificate-services" class="hash-link" aria-label="Direct link to Installing Active Directory Certificate Services" title="Direct link to Installing Active Directory Certificate Services" translate="no">​</a></h2>
<p>Before AD FS can issue and consume the SSL/TLS &amp; token-signing certificates it needs,
we must setup an Enterprise Certificate Authority on the ECS domain controller.</p>
<ol>
<li>Open <em>Server Manager</em>, click <em>Add roles and features</em>.</li>
<li>Choose <em>&quot;Role-based or feature-based installation&quot;</em>, and select the ECS Server from the <em>Server Pool</em>.</li>
<li>Under <em>Server Roles</em>, check <em>&quot;Active Directory Certificate Services&quot;</em>.</li>
<li>When prompted to select <em>AD CS/Role Services</em>, include the &quot;<em>Certification Authority</em>&quot;.</li>
<li>Click <em>Next</em> through the wizard and then <em>Install</em>.</li>
</ol>
<p>or alternatively via PowerShell:</p>
<div class="language-PowerShell language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(220, 13%, 18%);--prism-color:hsl(220, 14%, 71%)"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar" style="background-color:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token function" style="color:hsl(207, 82%, 66%)">Install-WindowsFeature</span><span class="token plain"> AD-Certificate </span><span class="token operator" style="color:hsl(207, 82%, 66%)">-</span><span class="token plain">IncludeManagementTools</span><br></span></code></pre></div></div>
<p>Once the Active Directory Certificate Services are installed, Open <em>Server Manager</em> → <em>Tasks</em> and click the link <em>Configure Active Directory Services</em></p>
<p><img decoding="async" loading="lazy" alt="image" src="/docs-next/pr-preview/pr-330/assets/images/Screenshot_from_2025-04-21_12-29-18-52c515a96220b1463d75dcc7eeadbbad.png" width="1870" height="830" class="img_ev3q"></p>
<p>Follow the wizard steps and set the following values:</p>
<ol>
<li><strong>Credentials</strong>: <code>MYCOMPANY\Administrator</code>, click <em>Next</em></li>
<li><strong>Select Role Services to configure</strong>: select <em>&quot;Certification Authority&quot;</em> and click <em>Next</em></li>
<li><strong>Specify the setup type of the CA</strong>: select <em>&quot;Enterprise CA&quot;</em> and click <em>Next</em></li>
<li><strong>Specify the type of the CA</strong>: select <em>&quot;Root CA&quot;</em> and click <em>Next</em></li>
<li><strong>Specify the type of the private key</strong>: select <em>&quot;Create a new private key&quot;</em> and click <em>Next</em></li>
<li><strong>Specify the cryptographic options</strong>: select <em>&quot;RSA#Microsoft Software Key Storage Provider&quot;</em> with <code>2048</code> length and hash algorithm <code>SHA256</code>, click <em>Next</em></li>
<li>Click <em>Next</em> for the rest of the wizard steps and finally <em>Configure</em></li>
</ol>
<div class="carousel-container" style="position:relative;width:100%;height:400px;overflow:hidden;margin-bottom:24px"><button style="position:absolute;top:50%;transform:translateY(-50%);background:rgba(0, 0, 0, 0.5);border:none;color:#fff;padding:0.5rem 1rem;cursor:pointer;z-index:1;left:10px" aria-label="Previous slide">‹</button><div style="display:flex;height:100%;transition:transform 0.5s ease-in-out;transform:translateX(-0%)"><div style="flex:0 0 100%;height:100%;display:flex;align-items:center;justify-content:center;cursor:zoom-in" role="button" aria-label="Zoom slide 1"><img src="/docs-next/pr-preview/pr-330/img/docs/blueprints/by-use-case/security/microsoft/Screenshot_from_2025-04-21_12-29-27.png"></div><div style="flex:0 0 100%;height:100%;display:flex;align-items:center;justify-content:center;cursor:zoom-in" role="button" aria-label="Zoom slide 2"><img src="/docs-next/pr-preview/pr-330/img/docs/blueprints/by-use-case/security/microsoft/Screenshot_from_2025-04-21_12-29-38.png"></div><div style="flex:0 0 100%;height:100%;display:flex;align-items:center;justify-content:center;cursor:zoom-in" role="button" aria-label="Zoom slide 3"><img src="/docs-next/pr-preview/pr-330/img/docs/blueprints/by-use-case/security/microsoft/Screenshot_from_2025-04-21_12-29-48.png"></div><div style="flex:0 0 100%;height:100%;display:flex;align-items:center;justify-content:center;cursor:zoom-in" role="button" aria-label="Zoom slide 4"><img src="/docs-next/pr-preview/pr-330/img/docs/blueprints/by-use-case/security/microsoft/Screenshot_from_2025-04-21_12-29-55.png"></div><div style="flex:0 0 100%;height:100%;display:flex;align-items:center;justify-content:center;cursor:zoom-in" role="button" aria-label="Zoom slide 5"><img src="/docs-next/pr-preview/pr-330/img/docs/blueprints/by-use-case/security/microsoft/Screenshot_from_2025-04-21_12-30-17.png"></div><div style="flex:0 0 100%;height:100%;display:flex;align-items:center;justify-content:center;cursor:zoom-in" role="button" aria-label="Zoom slide 6"><img src="/docs-next/pr-preview/pr-330/img/docs/blueprints/by-use-case/security/microsoft/Screenshot_from_2025-04-21_13-44-30.png"></div></div><button style="position:absolute;top:50%;transform:translateY(-50%);background:rgba(0, 0, 0, 0.5);border:none;color:#fff;padding:0.5rem 1rem;cursor:pointer;z-index:1;right:10px" aria-label="Next slide">›</button><div style="position:absolute;bottom:10px;width:100%;display:flex;justify-content:center;gap:0.5rem;z-index:1"><div style="width:10px;height:10px;border-radius:50%;background:#000;cursor:pointer" aria-label="Go to slide 1"></div><div style="width:10px;height:10px;border-radius:50%;background:#ccc;cursor:pointer" aria-label="Go to slide 2"></div><div style="width:10px;height:10px;border-radius:50%;background:#ccc;cursor:pointer" aria-label="Go to slide 3"></div><div style="width:10px;height:10px;border-radius:50%;background:#ccc;cursor:pointer" aria-label="Go to slide 4"></div><div style="width:10px;height:10px;border-radius:50%;background:#ccc;cursor:pointer" aria-label="Go to slide 5"></div><div style="width:10px;height:10px;border-radius:50%;background:#ccc;cursor:pointer" aria-label="Go to slide 6"></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="installing-active-directory-federation-services">Installing Active Directory Federation Services<a href="#installing-active-directory-federation-services" class="hash-link" aria-label="Direct link to Installing Active Directory Federation Services" title="Direct link to Installing Active Directory Federation Services" translate="no">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="creating-certificate">Creating Certificate<a href="#creating-certificate" class="hash-link" aria-label="Direct link to Creating Certificate" title="Direct link to Creating Certificate" translate="no">​</a></h3>
<p>First, we need to create a Certificate Template:</p>
<ol>
<li>Go to <em>Server Manager</em> -&gt; <em>Tools</em> -&gt; <em>Certificate Authority</em>.</li>
<li>Expand the tree of the local authority, right-click on <em>Certificate Templates</em> and then click on <em>Manage</em> and the <em>Certificate Templates Console</em> will open.</li>
<li>Find the template <em>Web Server</em> in the list, right-click on it and then click on <em>Duplicate Template</em>.</li>
<li>Fill in the following information:<!-- -->
<ul>
<li>Tab <strong>General</strong>:<!-- -->
<ul>
<li><strong>Template display name</strong>: <code>ADFS SSL</code>.</li>
<li><strong>Template name</strong>: <code>ADFS SSL</code>.</li>
<li><strong>Publish certificate in Active Directory</strong>: Enable this option.</li>
</ul>
</li>
<li>Tab <strong>Request Handling</strong>:<!-- -->
<ul>
<li><strong>Allow private key to be exported</strong>: Enable this option.</li>
</ul>
</li>
<li>Tab <strong>Security</strong>:<!-- -->
<ul>
<li>Add <code>Authenticated Users</code> in the <em>Group or user names</em> list and assign them <code>Read</code> and <code>Enroll</code> permissions.</li>
<li>Add <code>Domain Computers</code> in the <em>Group or user names</em> list and assign them <code>Read</code> and <code>Enroll</code> permissions.</li>
</ul>
</li>
</ul>
</li>
</ol>
<div class="carousel-container" style="position:relative;width:100%;height:400px;overflow:hidden;margin-bottom:24px"><button style="position:absolute;top:50%;transform:translateY(-50%);background:rgba(0, 0, 0, 0.5);border:none;color:#fff;padding:0.5rem 1rem;cursor:pointer;z-index:1;left:10px" aria-label="Previous slide">‹</button><div style="display:flex;height:100%;transition:transform 0.5s ease-in-out;transform:translateX(-0%)"><div style="flex:0 0 100%;height:100%;display:flex;align-items:center;justify-content:center;cursor:zoom-in" role="button" aria-label="Zoom slide 1"><img src="/docs-next/pr-preview/pr-330/img/docs/blueprints/by-use-case/security/microsoft/Screenshot_from_2025-04-21_13-45-47.png"></div><div style="flex:0 0 100%;height:100%;display:flex;align-items:center;justify-content:center;cursor:zoom-in" role="button" aria-label="Zoom slide 2"><img src="/docs-next/pr-preview/pr-330/img/docs/blueprints/by-use-case/security/microsoft/Screenshot_from_2025-04-21_13-46-12.png"></div><div style="flex:0 0 100%;height:100%;display:flex;align-items:center;justify-content:center;cursor:zoom-in" role="button" aria-label="Zoom slide 3"><img src="/docs-next/pr-preview/pr-330/img/docs/blueprints/by-use-case/security/microsoft/Screenshot_from_2025-04-21_13-46-53.png"></div><div style="flex:0 0 100%;height:100%;display:flex;align-items:center;justify-content:center;cursor:zoom-in" role="button" aria-label="Zoom slide 4"><img src="/docs-next/pr-preview/pr-330/img/docs/blueprints/by-use-case/security/microsoft/Screenshot_from_2025-04-21_13-47-03.png"></div><div style="flex:0 0 100%;height:100%;display:flex;align-items:center;justify-content:center;cursor:zoom-in" role="button" aria-label="Zoom slide 5"><img src="/docs-next/pr-preview/pr-330/img/docs/blueprints/by-use-case/security/microsoft/Screenshot_from_2025-04-21_13-47-37.png"></div></div><button style="position:absolute;top:50%;transform:translateY(-50%);background:rgba(0, 0, 0, 0.5);border:none;color:#fff;padding:0.5rem 1rem;cursor:pointer;z-index:1;right:10px" aria-label="Next slide">›</button><div style="position:absolute;bottom:10px;width:100%;display:flex;justify-content:center;gap:0.5rem;z-index:1"><div style="width:10px;height:10px;border-radius:50%;background:#000;cursor:pointer" aria-label="Go to slide 1"></div><div style="width:10px;height:10px;border-radius:50%;background:#ccc;cursor:pointer" aria-label="Go to slide 2"></div><div style="width:10px;height:10px;border-radius:50%;background:#ccc;cursor:pointer" aria-label="Go to slide 3"></div><div style="width:10px;height:10px;border-radius:50%;background:#ccc;cursor:pointer" aria-label="Go to slide 4"></div><div style="width:10px;height:10px;border-radius:50%;background:#ccc;cursor:pointer" aria-label="Go to slide 5"></div></div></div>
<p>Then we need to enable this Certificate Template:</p>
<ol>
<li>Go to <em>Server Manager</em> -&gt; <em>Tools</em> -&gt; <em>Certificate Authority</em>.</li>
<li>Expand the tree of the local authority, right-click on <em>Certificate Templates</em> and then click on <em>New</em> -&gt; <em>Certificate Template to Issue</em>.</li>
<li>Pick the template you created in the previous step from the list and click <em>OK</em>.</li>
</ol>
<div class="carousel-container" style="position:relative;width:100%;height:400px;overflow:hidden;margin-bottom:24px"><button style="position:absolute;top:50%;transform:translateY(-50%);background:rgba(0, 0, 0, 0.5);border:none;color:#fff;padding:0.5rem 1rem;cursor:pointer;z-index:1;left:10px" aria-label="Previous slide">‹</button><div style="display:flex;height:100%;transition:transform 0.5s ease-in-out;transform:translateX(-0%)"><div style="flex:0 0 100%;height:100%;display:flex;align-items:center;justify-content:center;cursor:zoom-in" role="button" aria-label="Zoom slide 1"><img src="/docs-next/pr-preview/pr-330/img/docs/blueprints/by-use-case/security/microsoft/Screenshot_from_2025-04-23_09-36-43.png"></div><div style="flex:0 0 100%;height:100%;display:flex;align-items:center;justify-content:center;cursor:zoom-in" role="button" aria-label="Zoom slide 2"><img src="/docs-next/pr-preview/pr-330/img/docs/blueprints/by-use-case/security/microsoft/Screenshot_from_2025-04-23_09-36-50.png"></div></div><button style="position:absolute;top:50%;transform:translateY(-50%);background:rgba(0, 0, 0, 0.5);border:none;color:#fff;padding:0.5rem 1rem;cursor:pointer;z-index:1;right:10px" aria-label="Next slide">›</button><div style="position:absolute;bottom:10px;width:100%;display:flex;justify-content:center;gap:0.5rem;z-index:1"><div style="width:10px;height:10px;border-radius:50%;background:#000;cursor:pointer" aria-label="Go to slide 1"></div><div style="width:10px;height:10px;border-radius:50%;background:#ccc;cursor:pointer" aria-label="Go to slide 2"></div></div></div>
<p>And lastly, we need to issue the Certificate:</p>
<ol>
<li>Open a Powershell Console as Administrator and run <code>mmc</code>.</li>
<li>Add the <em>Certificates</em> Snap-in. Select to manage a <em>&quot;Computer Account&quot;</em> and click <em>Next</em>.</li>
<li>Select the <em>&quot;Local computer&quot;</em> and click <em>Finish</em> and <em>OK</em>.</li>
<li>Right-click <em>Personal</em> -&gt; <em>All Tasks</em> -&gt; <em>Request New Certificate</em>, and the <em>Certificate Enrollment wizard</em> will open. Click <em>Next</em>.</li>
<li>Select <em>&quot;Active Directory Enrollment Policy&quot;</em> as Certificate Enrollment Policy and click <em>Next</em>.</li>
<li>Click on the link &quot;More information is required to enroll for this certificate. Click here to configure settings.&quot; under your certificate template.</li>
<li>On the <em>Certificate Properties</em> modal, configure the following and the exit by clicking <em>OK</em>:<!-- -->
<ul>
<li>Tab <strong>Subject</strong>:<!-- -->
<ul>
<li><strong>Subject name</strong>::<strong>Type</strong>: <em>&quot;Common name&quot;</em></li>
<li><strong>Subject name</strong>::<strong>Value</strong>: <code>adfs.example.com</code></li>
<li><strong>Alternative name</strong>::<strong>Type</strong>: <em>&quot;DNS&quot;</em></li>
<li><strong>Alternative name</strong>::<strong>Value</strong>: <code>adfs.example.com</code></li>
<li><strong>Alternative name</strong>::<strong>Value</strong>: <code>certauth.adfs.example.com</code></li>
</ul>
</li>
<li>Tab <strong>General</strong>:<!-- -->
<ul>
<li><strong>Friendly name</strong>: <code>ADSL SSL Cert</code></li>
<li><strong>Description</strong>: <code>ADSL SSL Cert</code></li>
</ul>
</li>
<li>Tab <strong>Private Key</strong>:<!-- -->
<ul>
<li><strong>Key options</strong>::<strong>Make private key exportable</strong>: Make sure this option is enabled</li>
</ul>
</li>
</ul>
</li>
<li>Select the certificate template you just configured and click <em>Enroll</em>.</li>
</ol>
<div class="carousel-container" style="position:relative;width:100%;height:400px;overflow:hidden;margin-bottom:24px"><button style="position:absolute;top:50%;transform:translateY(-50%);background:rgba(0, 0, 0, 0.5);border:none;color:#fff;padding:0.5rem 1rem;cursor:pointer;z-index:1;left:10px" aria-label="Previous slide">‹</button><div style="display:flex;height:100%;transition:transform 0.5s ease-in-out;transform:translateX(-0%)"><div style="flex:0 0 100%;height:100%;display:flex;align-items:center;justify-content:center;cursor:zoom-in" role="button" aria-label="Zoom slide 1"><img src="/docs-next/pr-preview/pr-330/img/docs/blueprints/by-use-case/security/microsoft/Screenshot_from_2025-04-23_13-45-14.png"></div><div style="flex:0 0 100%;height:100%;display:flex;align-items:center;justify-content:center;cursor:zoom-in" role="button" aria-label="Zoom slide 2"><img src="/docs-next/pr-preview/pr-330/img/docs/blueprints/by-use-case/security/microsoft/Screenshot_from_2025-04-23_13-45-25.png"></div><div style="flex:0 0 100%;height:100%;display:flex;align-items:center;justify-content:center;cursor:zoom-in" role="button" aria-label="Zoom slide 3"><img src="/docs-next/pr-preview/pr-330/img/docs/blueprints/by-use-case/security/microsoft/Screenshot_from_2025-04-23_13-46-12.png"></div></div><button style="position:absolute;top:50%;transform:translateY(-50%);background:rgba(0, 0, 0, 0.5);border:none;color:#fff;padding:0.5rem 1rem;cursor:pointer;z-index:1;right:10px" aria-label="Next slide">›</button><div style="position:absolute;bottom:10px;width:100%;display:flex;justify-content:center;gap:0.5rem;z-index:1"><div style="width:10px;height:10px;border-radius:50%;background:#000;cursor:pointer" aria-label="Go to slide 1"></div><div style="width:10px;height:10px;border-radius:50%;background:#ccc;cursor:pointer" aria-label="Go to slide 2"></div><div style="width:10px;height:10px;border-radius:50%;background:#ccc;cursor:pointer" aria-label="Go to slide 3"></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="installing-the-server-role">Installing the Server Role<a href="#installing-the-server-role" class="hash-link" aria-label="Direct link to Installing the Server Role" title="Direct link to Installing the Server Role" translate="no">​</a></h3>
<p>Once the AD FS role installation completes and the certificate is installed, the Post-Deployment Configuration link appears in Server Manager -&gt; Tasks:</p>
<ol>
<li>Click <em>Configure the federation service on this server</em>.</li>
<li>Choose <em>&quot;Create the first federation server in a federation server farm&quot;</em> and click <em>Next</em>.</li>
<li>Add <code>adfs.example.com</code> as <strong>SSL Certificate</strong> and as <strong>Federation Service Name</strong>. Enter <code>ADSL example.com SSO Login</code> as <strong>Federation Service Display Name</strong> and click <em>Next</em>.</li>
<li>Set <code>MYCOMPANY\Administrator</code> as the <strong>Account Name</strong> under <em>&quot;Use an existing domain user account or group Managed Service Account&quot;</em> and click <em>Next</em>.<!-- -->
<div class="theme-admonition theme-admonition-warning admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>warning</div><div class="admonitionContent_BuS1"><p>In production environments you should use a Service Account.</p></div></div>
</li>
<li>Select <em>&quot;Create a database on this server using Windows Internal Database&quot;</em> and click <em>Next</em>.</li>
<li>Wait until the prerequisites checks are completed and if they are successful, click <em>Configure</em>.</li>
</ol>
<div class="carousel-container" style="position:relative;width:100%;height:400px;overflow:hidden;margin-bottom:24px"><button style="position:absolute;top:50%;transform:translateY(-50%);background:rgba(0, 0, 0, 0.5);border:none;color:#fff;padding:0.5rem 1rem;cursor:pointer;z-index:1;left:10px" aria-label="Previous slide">‹</button><div style="display:flex;height:100%;transition:transform 0.5s ease-in-out;transform:translateX(-0%)"><div style="flex:0 0 100%;height:100%;display:flex;align-items:center;justify-content:center;cursor:zoom-in" role="button" aria-label="Zoom slide 1"><img src="/docs-next/pr-preview/pr-330/img/docs/blueprints/by-use-case/security/microsoft/Screenshot_from_2025-04-23_10-30-38.png"></div><div style="flex:0 0 100%;height:100%;display:flex;align-items:center;justify-content:center;cursor:zoom-in" role="button" aria-label="Zoom slide 2"><img src="/docs-next/pr-preview/pr-330/img/docs/blueprints/by-use-case/security/microsoft/Screenshot_from_2025-04-23_10-31-01.png"></div><div style="flex:0 0 100%;height:100%;display:flex;align-items:center;justify-content:center;cursor:zoom-in" role="button" aria-label="Zoom slide 3"><img src="/docs-next/pr-preview/pr-330/img/docs/blueprints/by-use-case/security/microsoft/Screenshot_from_2025-04-23_10-31-08.png"></div><div style="flex:0 0 100%;height:100%;display:flex;align-items:center;justify-content:center;cursor:zoom-in" role="button" aria-label="Zoom slide 4"><img src="/docs-next/pr-preview/pr-330/img/docs/blueprints/by-use-case/security/microsoft/Screenshot_from_2025-04-23_10-31-49.png"></div><div style="flex:0 0 100%;height:100%;display:flex;align-items:center;justify-content:center;cursor:zoom-in" role="button" aria-label="Zoom slide 5"><img src="/docs-next/pr-preview/pr-330/img/docs/blueprints/by-use-case/security/microsoft/Screenshot_from_2025-04-23_10-32-22.png"></div><div style="flex:0 0 100%;height:100%;display:flex;align-items:center;justify-content:center;cursor:zoom-in" role="button" aria-label="Zoom slide 6"><img src="/docs-next/pr-preview/pr-330/img/docs/blueprints/by-use-case/security/microsoft/Screenshot_from_2025-04-23_10-32-31.png"></div><div style="flex:0 0 100%;height:100%;display:flex;align-items:center;justify-content:center;cursor:zoom-in" role="button" aria-label="Zoom slide 7"><img src="/docs-next/pr-preview/pr-330/img/docs/blueprints/by-use-case/security/microsoft/Screenshot_from_2025-04-23_10-33-21.png"></div></div><button style="position:absolute;top:50%;transform:translateY(-50%);background:rgba(0, 0, 0, 0.5);border:none;color:#fff;padding:0.5rem 1rem;cursor:pointer;z-index:1;right:10px" aria-label="Next slide">›</button><div style="position:absolute;bottom:10px;width:100%;display:flex;justify-content:center;gap:0.5rem;z-index:1"><div style="width:10px;height:10px;border-radius:50%;background:#000;cursor:pointer" aria-label="Go to slide 1"></div><div style="width:10px;height:10px;border-radius:50%;background:#ccc;cursor:pointer" aria-label="Go to slide 2"></div><div style="width:10px;height:10px;border-radius:50%;background:#ccc;cursor:pointer" aria-label="Go to slide 3"></div><div style="width:10px;height:10px;border-radius:50%;background:#ccc;cursor:pointer" aria-label="Go to slide 4"></div><div style="width:10px;height:10px;border-radius:50%;background:#ccc;cursor:pointer" aria-label="Go to slide 5"></div><div style="width:10px;height:10px;border-radius:50%;background:#ccc;cursor:pointer" aria-label="Go to slide 6"></div><div style="width:10px;height:10px;border-radius:50%;background:#ccc;cursor:pointer" aria-label="Go to slide 7"></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="registering-spn">Registering SPN<a href="#registering-spn" class="hash-link" aria-label="Direct link to Registering SPN" title="Direct link to Registering SPN" translate="no">​</a></h3>
<p>When you configure Windows Integrated Authentication against your ADFS endpoint, the client will request a Kerberos ticket for the SPN <strong>HTTP/adfs.mycompany.com.</strong>. The Active Directory Key Distribution Center (KDC) must locate that SPN on the correct service account in order to encrypt the ticket with the matching key. If the SPN is missing or bound to the wrong account, Kerberos authentication cannot proceed—clients will either fall back to NTLM or enter a <code>401</code> challenge loop. To prevent this, we need to register the SPN explicitly on your AD FS service account in order to ensure that KDC can issue a valid Kerberos ticket and your Windows Integrated Auth flow succeeds.</p>
<p><strong>Run as Administrator</strong> the following command in PowerShell:</p>
<div class="language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(220, 13%, 18%);--prism-color:hsl(220, 14%, 71%)"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar" style="background-color:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">setspn </span><span class="token operator" style="color:hsl(207, 82%, 66%)">-</span><span class="token plain">s http/adfs</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">.</span><span class="token plain">mycompany</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">.</span><span class="token plain">com administrator</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="disabling-extended-protection-token-check">Disabling Extended Protection Token Check<a href="#disabling-extended-protection-token-check" class="hash-link" aria-label="Direct link to Disabling Extended Protection Token Check" title="Direct link to Disabling Extended Protection Token Check" translate="no">​</a></h3>
<div class="theme-admonition theme-admonition-warning admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>warning</div><div class="admonitionContent_BuS1"><p>When you integrate AD FS with most cloud-based IAM or SSO front-ends, you&#x27;re typically introducing one or more TLS-terminating proxies or load-balancers. Those intermediaries break the Channel-Binding Token (CBT) exchange that Extended Protection relies on, so AD FS sees no binding data and rejects the request.</p><p>Disabling Extended Protection is almost always needed when you&#x27;re fronting AD FS with a cloud-based TLS terminator that doesn&#x27;t forward the original channel-binding info. Once you have an end-to-end TLS path (or move to non-CBT-based auth), you can safely turn it back on.</p></div></div>
<p><strong>Run as Administrator</strong> the following command in PowerShell:</p>
<div class="language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(220, 13%, 18%);--prism-color:hsl(220, 14%, 71%)"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar" style="background-color:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token function" style="color:hsl(207, 82%, 66%)">Set-ADFSProperties</span><span class="token plain"> </span><span class="token operator" style="color:hsl(207, 82%, 66%)">-</span><span class="token plain">ExtendedProtectionTokenCheck None</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="enabling-ad-fs-sign-on-page">Enabling AD FS Sign-On Page<a href="#enabling-ad-fs-sign-on-page" class="hash-link" aria-label="Direct link to Enabling AD FS Sign-On Page" title="Direct link to Enabling AD FS Sign-On Page" translate="no">​</a></h3>
<p>By default (in Microsoft Server 2016 and later) the sign-on page is off, so trying to browse to: <code>https://adfs.example.com/adfs/ls/idpinitiatedsignon.aspx</code> will yield a <code>404</code> error.</p>
<p><strong>Run as Administrator</strong> the following command in PowerShell:</p>
<div class="language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(220, 13%, 18%);--prism-color:hsl(220, 14%, 71%)"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar" style="background-color:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token function" style="color:hsl(207, 82%, 66%)">Set-AdfsProperties</span><span class="token plain"> </span><span class="token operator" style="color:hsl(207, 82%, 66%)">-</span><span class="token plain">EnableIdpInitiatedSignonPage </span><span class="token boolean" style="color:hsl(29, 54%, 61%)">$true</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="automated-public-tls-certificate-management-with-win-acme">Automated Public TLS Certificate Management with WIN-ACME<a href="#automated-public-tls-certificate-management-with-win-acme" class="hash-link" aria-label="Direct link to Automated Public TLS Certificate Management with WIN-ACME" title="Direct link to Automated Public TLS Certificate Management with WIN-ACME" translate="no">​</a></h2>
<p>While an internal Certificate Authority (CA) is excellent for issuing token-signing and other internal-only certificates, your public-facing AD FS endpoint (<code>adfs.example.com</code>) requires a TLS certificate that is trusted by all external clients and cloud providers. This section details how to use WIN-ACME and Let&#x27;s Encrypt to automate the issuance and renewal of a publicly trusted SSL certificate, complementing your internal CA in a hybrid-certificate model.</p>
<p>This approach represents a security best practice:</p>
<ul>
<li><strong>Let&#x27;s Encrypt Certificate</strong>: Used for the public-facing <strong>SSL Certificate</strong> to secure HTTPS traffic. It is trusted globally.</li>
<li><strong>Internal CA Certificate</strong>: Used for the <strong>Token-Signing</strong> and <strong>Token-Decryption</strong> certificates, which should <em>not</em> be publicly trusted.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="when-to-use-win-acme-for-ad-fs">When to Use WIN-ACME for AD FS<a href="#when-to-use-win-acme-for-ad-fs" class="hash-link" aria-label="Direct link to When to Use WIN-ACME for AD FS" title="Direct link to When to Use WIN-ACME for AD FS" translate="no">​</a></h3>
<p>This method is necessary when your internal CA is not trusted by external partners or when client devices do not have your internal root CA certificate installed. It provides a free, automated way to maintain a trusted public endpoint.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="install-win-acme-and-prepare-for-validation">Install WIN-ACME and Prepare for Validation<a href="#install-win-acme-and-prepare-for-validation" class="hash-link" aria-label="Direct link to Install WIN-ACME and Prepare for Validation" title="Direct link to Install WIN-ACME and Prepare for Validation" translate="no">​</a></h3>
<p>First, download the latest <a href="https://www.win-acme.com/" target="_blank" rel="noopener noreferrer">WIN-ACME</a> release and extract it to a permanent location like <code>C:\win-acme</code>.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="create-the-automated-renewal-script">Create the Automated Renewal Script<a href="#create-the-automated-renewal-script" class="hash-link" aria-label="Direct link to Create the Automated Renewal Script" title="Direct link to Create the Automated Renewal Script" translate="no">​</a></h3>
<p>Because AD FS does not use standard IIS bindings, we must use a script to apply the new certificate upon renewal. Create the directory <code>C:\Scripts</code> and save the following PowerShell script as <code>ADFSSSLRenewal.ps1</code>. This script is specifically designed to update <em>only</em> the SSL certificate, leaving your internal token-signing certificates untouched.</p>
<div class="language-PowerShell language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(220, 13%, 18%);--prism-color:hsl(220, 14%, 71%)"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar" style="background-color:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token comment" style="color:hsl(220, 10%, 40%)"># C:\Scripts\ADFSSSLRenewal.ps1</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain"></span><span class="token keyword" style="color:hsl(286, 60%, 67%)">param</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token variable" style="color:hsl(207, 82%, 66%)">$CertThumbprint</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain"></span><span class="token keyword" style="color:hsl(286, 60%, 67%)">try</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">    </span><span class="token comment" style="color:hsl(220, 10%, 40%)"># Apply certificate to AD FS SSL binding with warning suppression</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">    </span><span class="token function" style="color:hsl(207, 82%, 66%)">Set-AdfsSslCertificate</span><span class="token plain"> </span><span class="token operator" style="color:hsl(207, 82%, 66%)">-</span><span class="token plain">Thumbprint </span><span class="token variable" style="color:hsl(207, 82%, 66%)">$CertThumbprint</span><span class="token plain"> </span><span class="token operator" style="color:hsl(207, 82%, 66%)">-</span><span class="token plain">WarningAction SilentlyContinue</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">    </span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">    </span><span class="token comment" style="color:hsl(220, 10%, 40%)"># For ADFS 2016+ with alternate TLS binding mode, also update the certauth binding</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">try</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">        </span><span class="token function" style="color:hsl(207, 82%, 66%)">Set-AdfsAlternateTlsClientBinding</span><span class="token plain"> </span><span class="token operator" style="color:hsl(207, 82%, 66%)">-</span><span class="token plain">Thumbprint </span><span class="token variable" style="color:hsl(207, 82%, 66%)">$CertThumbprint</span><span class="token plain"> </span><span class="token operator" style="color:hsl(207, 82%, 66%)">-</span><span class="token plain">Force </span><span class="token boolean" style="color:hsl(29, 54%, 61%)">$true</span><span class="token plain"> </span><span class="token operator" style="color:hsl(207, 82%, 66%)">-</span><span class="token plain">Confirm:</span><span class="token boolean" style="color:hsl(29, 54%, 61%)">$false</span><span class="token plain"> </span><span class="token operator" style="color:hsl(207, 82%, 66%)">-</span><span class="token plain">WarningAction SilentlyContinue</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">        </span><span class="token function" style="color:hsl(207, 82%, 66%)">Write-Output</span><span class="token plain"> </span><span class="token string" style="color:hsl(95, 38%, 62%)">&quot;Updated alternate TLS client binding for certificate authentication&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">catch</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">        </span><span class="token function" style="color:hsl(207, 82%, 66%)">Write-Warning</span><span class="token plain"> </span><span class="token string" style="color:hsl(95, 38%, 62%)">&quot;Could not update alternate TLS binding - may not be configured: </span><span class="token string function" style="color:hsl(207, 82%, 66%)">$</span><span class="token string function punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token string function variable" style="color:hsl(207, 82%, 66%)">$_</span><span class="token string function punctuation" style="color:hsl(220, 14%, 71%)">.</span><span class="token string function" style="color:hsl(207, 82%, 66%)">Exception</span><span class="token string function punctuation" style="color:hsl(220, 14%, 71%)">.</span><span class="token string function" style="color:hsl(207, 82%, 66%)">Message</span><span class="token string function punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token string" style="color:hsl(95, 38%, 62%)">&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">    </span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">    </span><span class="token comment" style="color:hsl(220, 10%, 40%)"># Restart AD FS service without prompting</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">    </span><span class="token function" style="color:hsl(207, 82%, 66%)">Restart-Service</span><span class="token plain"> adfssrv </span><span class="token operator" style="color:hsl(207, 82%, 66%)">-</span><span class="token plain">Force </span><span class="token operator" style="color:hsl(207, 82%, 66%)">-</span><span class="token plain">Confirm:</span><span class="token boolean" style="color:hsl(29, 54%, 61%)">$false</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">    </span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">    </span><span class="token function" style="color:hsl(207, 82%, 66%)">Write-Output</span><span class="token plain"> </span><span class="token string" style="color:hsl(95, 38%, 62%)">&quot;AD FS certificate updated successfully for both endpoints: </span><span class="token string variable" style="color:hsl(207, 82%, 66%)">$CertThumbprint</span><span class="token string" style="color:hsl(95, 38%, 62%)">&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">exit</span><span class="token plain"> 0</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain"></span><span class="token keyword" style="color:hsl(286, 60%, 67%)">catch</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">    </span><span class="token function" style="color:hsl(207, 82%, 66%)">Write-Error</span><span class="token plain"> </span><span class="token string" style="color:hsl(95, 38%, 62%)">&quot;Failed to update AD FS certificate: </span><span class="token string function" style="color:hsl(207, 82%, 66%)">$</span><span class="token string function punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token string function variable" style="color:hsl(207, 82%, 66%)">$_</span><span class="token string function punctuation" style="color:hsl(220, 14%, 71%)">.</span><span class="token string function" style="color:hsl(207, 82%, 66%)">Exception</span><span class="token string function punctuation" style="color:hsl(220, 14%, 71%)">.</span><span class="token string function" style="color:hsl(207, 82%, 66%)">Message</span><span class="token string function punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token string" style="color:hsl(95, 38%, 62%)">&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">exit</span><span class="token plain"> 1</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">}</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="request-the-certificate-and-configure-renewal">Request the Certificate and Configure Renewal<a href="#request-the-certificate-and-configure-renewal" class="hash-link" aria-label="Direct link to Request the Certificate and Configure Renewal" title="Direct link to Request the Certificate and Configure Renewal" translate="no">​</a></h3>
<p>Now, run <code>wacs.exe</code> to request the certificate and set up the automated renewal task.</p>
<ol>
<li>Open PowerShell as an Administrator and navigate to your WIN-ACME directory.</li>
<li>Run the following command, replacing the email address with your own:</li>
</ol>
<div class="language-PowerShell language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(220, 13%, 18%);--prism-color:hsl(220, 14%, 71%)"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar" style="background-color:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token punctuation" style="color:hsl(220, 14%, 71%)">.</span><span class="token plain">\wacs</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">.</span><span class="token plain">exe </span><span class="token operator" style="color:hsl(207, 82%, 66%)">--</span><span class="token plain">source manual `</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">  </span><span class="token operator" style="color:hsl(207, 82%, 66%)">--</span><span class="token plain">host </span><span class="token string" style="color:hsl(95, 38%, 62%)">&quot;adfs.example.com&quot;</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token string" style="color:hsl(95, 38%, 62%)">&quot;certauth.adfs.example.com&quot;</span><span class="token plain"> `</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">  </span><span class="token operator" style="color:hsl(207, 82%, 66%)">--</span><span class="token plain">validation selfhosting `</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">  </span><span class="token operator" style="color:hsl(207, 82%, 66%)">--</span><span class="token plain">store certificatestore `</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">  </span><span class="token operator" style="color:hsl(207, 82%, 66%)">--</span><span class="token plain">certificatestore My `</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">  </span><span class="token operator" style="color:hsl(207, 82%, 66%)">--</span><span class="token plain">installation script `</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">  </span><span class="token operator" style="color:hsl(207, 82%, 66%)">--</span><span class="token plain">script </span><span class="token string" style="color:hsl(95, 38%, 62%)">&quot;C:\Scripts\ADFSSSLRenewal.ps1&quot;</span><span class="token plain"> `</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">  </span><span class="token operator" style="color:hsl(207, 82%, 66%)">--</span><span class="token plain">scriptparameters </span><span class="token string" style="color:hsl(95, 38%, 62%)">&quot;&#x27;{CertThumbprint}&#x27;&quot;</span><span class="token plain"> `</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">  </span><span class="token operator" style="color:hsl(207, 82%, 66%)">--</span><span class="token plain">emailaddress </span><span class="token string" style="color:hsl(95, 38%, 62%)">&quot;admin@example.com&quot;</span><span class="token plain"> `</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">  </span><span class="token operator" style="color:hsl(207, 82%, 66%)">--</span><span class="token plain">accepttos </span><br></span></code></pre></div></div>
<p>This command tells WIN-ACME to get a certificate for <code>adfs.example.com</code> and <code>certauth.adfs.example.com</code>, validate it using the built-in web server, place it in the local computer&#x27;s certificate store, and configure the renewal to run the <code>ADFSSSLRenewal.ps1</code> script.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="verification">Verification<a href="#verification" class="hash-link" aria-label="Direct link to Verification" title="Direct link to Verification" translate="no">​</a></h2>
<p>Open the address <code>https://adfs.example.com/adfs/ls/idpinitiatedsignon.aspx</code>, in an incognito or private browsing session using your preferred browser,
and:</p>
<ol>
<li>Confirm that the SSL certificate is properly installed and trusted.</li>
<li>Verify the login page loads without errors and that the “Sign in” button is displayed.</li>
</ol>
<p><img decoding="async" loading="lazy" alt="image" src="/docs-next/pr-preview/pr-330/assets/images/Screenshot_from_2025-04-23_12-27-34-4c485560777cf32f50b45b02c0c580aa.png" width="1867" height="817" class="img_ev3q"></p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-tags-row"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a rel="tag" class="tag_zVej tagRegular_sFm0" href="/docs-next/pr-preview/pr-330/docs/tags/security">security</a></li><li class="tag_QGVx"><a rel="tag" class="tag_zVej tagRegular_sFm0" href="/docs-next/pr-preview/pr-330/docs/tags/active-directory">active-directory</a></li><li class="tag_QGVx"><a rel="tag" class="tag_zVej tagRegular_sFm0" href="/docs-next/pr-preview/pr-330/docs/tags/ldap">ldap</a></li><li class="tag_QGVx"><a rel="tag" class="tag_zVej tagRegular_sFm0" href="/docs-next/pr-preview/pr-330/docs/tags/adfs">adfs</a></li><li class="tag_QGVx"><a rel="tag" class="tag_zVej tagRegular_sFm0" href="/docs-next/pr-preview/pr-330/docs/tags/microsoft">microsoft</a></li></ul></div></div><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/opentelekomcloud/docs-next/tree/main/docs/blueprints/by-use-case/security/microsoft/deploy-active-directory-federation-services-on-ecs.mdx" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs-next/pr-preview/pr-330/docs/blueprints/by-use-case/security/microsoft/azure-entraid-as-identity-provider-iam"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Azure Entra ID as Identity Provider for IAM</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs-next/pr-preview/pr-330/docs/blueprints/by-use-case/security/zitadel/zitadel"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">ZITADEL</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#prerequisites" class="table-of-contents__link toc-highlight">Prerequisites</a></li><li><a href="#creating-an-ecs-server" class="table-of-contents__link toc-highlight">Creating an ECS Server</a></li><li><a href="#creating-a-public-dns-endpoint" class="table-of-contents__link toc-highlight">Creating a Public DNS Endpoint</a></li><li><a href="#installing-active-directory-domain-services" class="table-of-contents__link toc-highlight">Installing Active Directory Domain Services</a><ul><li><a href="#installing-the-server-roles" class="table-of-contents__link toc-highlight">Installing the Server Roles</a></li><li><a href="#promoting-ecs-server-to-domain-controller" class="table-of-contents__link toc-highlight">Promoting ECS Server to Domain Controller</a></li><li><a href="#creating-organization-unit-users--groups" class="table-of-contents__link toc-highlight">Creating Organization Unit, Users &amp; Groups</a></li></ul></li><li><a href="#configuring-a-dns-zone" class="table-of-contents__link toc-highlight">Configuring a DNS Zone</a></li><li><a href="#installing-active-directory-certificate-services" class="table-of-contents__link toc-highlight">Installing Active Directory Certificate Services</a></li><li><a href="#installing-active-directory-federation-services" class="table-of-contents__link toc-highlight">Installing Active Directory Federation Services</a><ul><li><a href="#creating-certificate" class="table-of-contents__link toc-highlight">Creating Certificate</a></li><li><a href="#installing-the-server-role" class="table-of-contents__link toc-highlight">Installing the Server Role</a></li><li><a href="#registering-spn" class="table-of-contents__link toc-highlight">Registering SPN</a></li><li><a href="#disabling-extended-protection-token-check" class="table-of-contents__link toc-highlight">Disabling Extended Protection Token Check</a></li><li><a href="#enabling-ad-fs-sign-on-page" class="table-of-contents__link toc-highlight">Enabling AD FS Sign-On Page</a></li></ul></li><li><a href="#automated-public-tls-certificate-management-with-win-acme" class="table-of-contents__link toc-highlight">Automated Public TLS Certificate Management with WIN-ACME</a><ul><li><a href="#when-to-use-win-acme-for-ad-fs" class="table-of-contents__link toc-highlight">When to Use WIN-ACME for AD FS</a></li><li><a href="#install-win-acme-and-prepare-for-validation" class="table-of-contents__link toc-highlight">Install WIN-ACME and Prepare for Validation</a></li><li><a href="#create-the-automated-renewal-script" class="table-of-contents__link toc-highlight">Create the Automated Renewal Script</a></li><li><a href="#request-the-certificate-and-configure-renewal" class="table-of-contents__link toc-highlight">Request the Certificate and Configure Renewal</a></li></ul></li><li><a href="#verification" class="table-of-contents__link toc-highlight">Verification</a></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="align-items-center" style="margin:0 0 0 32px"><div class="col-10 text-right"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://docs.otc.t-systems.com/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Help Center</a></li><li class="footer__item"><a class="footer__link-item" href="/docs-next/pr-preview/pr-330/portfolio">Portfolio Navigator</a></li><li class="footer__item"><a href="https://www.open-telekom-cloud.com/en/products-services/roadmap" target="_blank" rel="noopener noreferrer" class="footer__link-item">Portfolio Roadmap</a></li><li class="footer__item"><a href="https://www.open-telekom-cloud.com/en/support/release-notes" target="_blank" rel="noopener noreferrer" class="footer__link-item">Release Notes</a></li><li class="footer__item"><a href="https://www.open-telekom-cloud.com/en/products-services/core-services/certifications" target="_blank" rel="noopener noreferrer" class="footer__link-item">Core Services Certifications</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://marketplace.otc.t-systems.com/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Marketplace</a></li><li class="footer__item"><a href="https://community.open-telekom-cloud.com/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Community Portal</a></li><li class="footer__item"><a href="https://www.youtube.com/playlist?list=PLS60dhorR-hgQ5n5L1boEQh0oVD-_k75p" target="_blank" rel="noopener noreferrer" class="footer__link-item">Webinars in YouTube<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">Developers</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://docs.otc.t-systems.com/developer/sdk.html" target="_blank" rel="noopener noreferrer" class="footer__link-item">SDKs</a></li><li class="footer__item"><a href="https://docs.otc.t-systems.com/developer/drivers.html" target="_blank" rel="noopener noreferrer" class="footer__link-item">Drivers &amp; Tools</a></li><li class="footer__item"><a href="https://registry.terraform.io/providers/opentelekomcloud/opentelekomcloud/latest/docs" target="_blank" rel="noopener noreferrer" class="footer__link-item">Terraform Provider<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://docs.otc.t-systems.com/ansible-collection-cloud/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Ansible Collections</a></li><li class="footer__item"><a href="https://designer.otc-service.com/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Cloud Create</a></li></ul></div><div class="col footer__col"><div class="footer__title">API</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://docs.otc.t-systems.com/developer/api.html" target="_blank" rel="noopener noreferrer" class="footer__link-item">REST API</a></li><li class="footer__item"><a href="https://docs.otc.t-systems.com/developer/api_guidelines/index.html" target="_blank" rel="noopener noreferrer" class="footer__link-item">REST API Usage Guidelines</a></li><li class="footer__item"><a href="https://docs.otc.t-systems.com/regions-and-endpoints/index.html" target="_blank" rel="noopener noreferrer" class="footer__link-item">Regions &amp; Endpoints</a></li></ul></div><div class="col footer__col"><div class="footer__title">Tools</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://enterprise-dashboard.otc-service.com" target="_blank" rel="noopener noreferrer" class="footer__link-item">Enterprise Dashboard</a></li><li class="footer__item"><a href="https://www.open-telekom-cloud.com/en/prices/price-calculator" target="_blank" rel="noopener noreferrer" class="footer__link-item">Price Calculator</a></li><li class="footer__item"><a href="https://status.otc-service.com/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Status Dashboard</a></li></ul></div></div></div></div></div><scale-telekom-footer type="minimal"><scale-telekom-footer-content><span slot="notice">© T-Systems International GmbH 2025<!-- --> <scale-tag size="small" style="margin:0 0 0 8px" color="orange" type="strong">0.1.PR330-241-ff03bdd-ephemeral</scale-tag></span><ul slot="navigation"><li><a href="https://open-telekom-cloud.com/en/contact"> Contact </a></li><li><a href="https://open-telekom-cloud.com/en/data-protection"> Data privacy </a></li><li><a href="https://open-telekom-cloud.com/en/disclaimer-of-liability"> Disclaimer of liabilities </a></li><li><a href="https://open-telekom-cloud.com/en/imprint"> Imprint </a></li></ul></scale-telekom-footer-content></scale-telekom-footer></footer></div>
</body>
</html>