"use strict";(self.webpackChunkdocs_next=self.webpackChunkdocs_next||[]).push([[68371],{90428:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>l,contentTitle:()=>i,default:()=>h,frontMatter:()=>a,metadata:()=>t,toc:()=>c});const t=JSON.parse('{"id":"best-practices/containers/cloud-container-engine/migrating-from-other_clouds-to-cce","title":"Migrating Clusters from Other Clouds to CCE","description":"This best practices series showcase how to migrate Kubernetes workloads from other cloud or on-premises Kubernetes environments to the Cloud Container Engine (CCE) on Open Telekom Cloud. It highlights the key considerations for moving applications, container images, and persistent data while ensuring compatibility and service continuity. This best practice focuses on leveraging Open Telekom Cloud services such as OBS and SWR, along with established tools like Velero to provide a reliable and structured migration path for Kubernetes workloads.","source":"@site/docs/best-practices/containers/cloud-container-engine/migrating-from-other_clouds-to-cce.md","sourceDirName":"best-practices/containers/cloud-container-engine","slug":"/best-practices/containers/cloud-container-engine/migrating-from-other_clouds-to-cce","permalink":"/docs-next/pr-preview/pr-366/docs/best-practices/containers/cloud-container-engine/migrating-from-other_clouds-to-cce","draft":false,"unlisted":false,"editUrl":"https://github.com/opentelekomcloud/docs-next/tree/main/docs/best-practices/containers/cloud-container-engine/migrating-from-other_clouds-to-cce.md","tags":[{"inline":true,"label":"cce","permalink":"/docs-next/pr-preview/pr-366/docs/tags/cce"},{"inline":true,"label":"migration","permalink":"/docs-next/pr-preview/pr-366/docs/tags/migration"},{"inline":true,"label":"velero","permalink":"/docs-next/pr-preview/pr-366/docs/tags/velero"},{"inline":true,"label":"obs","permalink":"/docs-next/pr-preview/pr-366/docs/tags/obs"},{"inline":true,"label":"wordpress","permalink":"/docs-next/pr-preview/pr-366/docs/tags/wordpress"},{"inline":true,"label":"kubernetes","permalink":"/docs-next/pr-preview/pr-366/docs/tags/kubernetes"},{"inline":true,"label":"aws","permalink":"/docs-next/pr-preview/pr-366/docs/tags/aws"},{"inline":true,"label":"eks","permalink":"/docs-next/pr-preview/pr-366/docs/tags/eks"}],"version":"current","frontMatter":{"id":"migrating-from-other_clouds-to-cce","title":"Migrating Clusters from Other Clouds to CCE","tags":["cce","migration","velero","obs","wordpress","kubernetes","aws","eks"]},"sidebar":"bestPracticesSidebar","previous":{"title":"Auto Scaling Based on ELB Monitoring Metrics with Prometheus Adapter","permalink":"/docs-next/pr-preview/pr-366/docs/best-practices/containers/cloud-container-engine/auto-scaling-based-on-elb-monitoring-metrics/auto-scaling-based-on-elb-monitoring-metrics-with-prometheus-adapter"},"next":{"title":"Backing Up Kubernetes Objects of other Clusters","permalink":"/docs-next/pr-preview/pr-366/docs/best-practices/containers/cloud-container-engine/backup-kubernetes-objects"}}');var r=s(74848),o=s(28453);const a={id:"migrating-from-other_clouds-to-cce",title:"Migrating Clusters from Other Clouds to CCE",tags:["cce","migration","velero","obs","wordpress","kubernetes","aws","eks"]},i="Migrating Clusters from Other Clouds to CCE",l={},c=[{value:"Prerequisites",id:"prerequisites",level:2},{value:"Preparing an OBS Bucket",id:"preparing-an-obs-bucket",level:3},{value:"Preparing Container Images (Optional)",id:"preparing-container-images-optional",level:3},{value:"Installing Velero",id:"installing-velero",level:2},{value:"Preparing Environmental Variables",id:"preparing-environmental-variables",level:3},{value:"Creating a Bucket",id:"creating-a-bucket",level:3},{value:"Installing Velero CLI",id:"installing-velero-cli",level:3},{value:"Installing Velero with Helm Chart",id:"installing-velero-with-helm-chart",level:3},{value:"Installing a Velero Web UI (Optional)",id:"installing-a-velero-web-ui-optional",level:3},{value:"Pre-Migration Considerations",id:"pre-migration-considerations",level:2},{value:"Deploying a Demo Workload on AWS EKS",id:"deploying-a-demo-workload-on-aws-eks",level:2},{value:"Prerequisites on AWS EKS",id:"prerequisites-on-aws-eks",level:3},{value:"Deploying Namespace and Secrets",id:"deploying-namespace-and-secrets",level:3},{value:"Deploying MySQL with EBS PVC",id:"deploying-mysql-with-ebs-pvc",level:3},{value:"Deploying WordPress with EBS PVC",id:"deploying-wordpress-with-ebs-pvc",level:3}];function d(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,o.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"migrating-clusters-from-other-clouds-to-cce",children:"Migrating Clusters from Other Clouds to CCE"})}),"\n",(0,r.jsxs)(n.p,{children:["This best practices series showcase how to migrate Kubernetes workloads from other cloud or on-premises Kubernetes environments to the Cloud Container Engine (CCE) on Open Telekom Cloud. It highlights the key considerations for moving applications, container images, and persistent data while ensuring compatibility and service continuity. This best practice focuses on leveraging Open Telekom Cloud services such as ",(0,r.jsx)(n.a,{href:"https://docs.otc.t-systems.com/object-storage-service/index.html",children:"OBS"})," and ",(0,r.jsx)(n.a,{href:"https://docs.otc.t-systems.com/software-repository-container/index.html",children:"SWR"}),", along with established tools like ",(0,r.jsx)(n.a,{href:"https://velero.io/",children:"Velero"})," to provide a reliable and structured migration path for Kubernetes workloads."]}),"\n",(0,r.jsx)("center",{children:(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"image1",src:s(68986).A+"",width:"719",height:"512"})})}),"\n",(0,r.jsx)(n.h2,{id:"prerequisites",children:"Prerequisites"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["The source and target Kubernetes clusters must run version ",(0,r.jsx)(n.strong,{children:"1.10 or higher"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:["An ",(0,r.jsx)(n.strong,{children:"OBS bucket"})," on Open Telekom Cloud is required and ",(0,r.jsx)(n.strong,{children:"Access credentials (AK/SK)"})," with proper permissions. Same counts if any alternative S3-compliant object-storage instead of OBS."]}),"\n",(0,r.jsx)(n.li,{children:"Both the source and target clusters need network access to the chosen object storage."}),"\n",(0,r.jsxs)(n.li,{children:["The ",(0,r.jsx)(n.strong,{children:"source cluster must be healthy"}),", with no abnormal pods running."]}),"\n",(0,r.jsxs)(n.li,{children:["The ",(0,r.jsx)(n.strong,{children:"target CCE cluster must not contain conflicting resources"}),", since Velero will not overwrite existing objects."]}),"\n",(0,r.jsxs)(n.li,{children:["Sufficient ",(0,r.jsx)(n.strong,{children:"storage capacity"})," must be ensured for backups and restores."]}),"\n",(0,r.jsxs)(n.li,{children:["Having ",(0,r.jsx)(n.a,{href:"https://helm.sh/",children:"Helm"})," and ",(0,r.jsx)(n.a,{href:"https://brew.sh/",children:"Homebrew"})," installed on your workstation."]}),"\n",(0,r.jsxs)(n.li,{children:["Having ",(0,r.jsx)(n.a,{href:"https://kubernetes.io/docs/reference/kubectl/",children:"kubectl"}),", and optionally ",(0,r.jsx)(n.a,{href:"https://k9scli.io/",children:"k9s"}),", installed on your workstation."]}),"\n"]}),"\n",(0,r.jsx)(n.admonition,{type:"tip",children:(0,r.jsxs)(n.p,{children:["Deploying the necessary tooling (Helm, kubectl, k9s, velero-cli) on your workstation, can be performed ",(0,r.jsx)(n.strong,{children:"both"})," in macOS and in Linux via Homebrew. Another tool to add in your arsenal, is ",(0,r.jsx)(n.a,{href:"https://bold-brew.com/",children:"Bold Brew"}),", a Homebrew manager that simplifies your Homebrew package management making installations and updates effortless via a TUI interface."]})}),"\n",(0,r.jsx)(n.h3,{id:"preparing-an-obs-bucket",children:"Preparing an OBS Bucket"}),"\n",(0,r.jsxs)(n.p,{children:["For more details on creating a bucket on OBS, see ",(0,r.jsx)(n.a,{href:"https://docs.otc.t-systems.com/object-storage-service/umn/obs_console_operation_guide/getting_started/creating_a_bucket.html",children:"Creating a Bucket"}),". If you use OBS to store backup files, obtain the AK/SK of a user who has the right to operate OBS. For details, see ",(0,r.jsx)(n.a,{href:"https://docs.otc.t-systems.com/object-storage-service/api-ref/appendixes/obtaining_access_keys_ak_sk.html",children:"Obtaining Access Keys (AK/SK)"}),"."]}),"\n",(0,r.jsx)(n.h3,{id:"preparing-container-images-optional",children:"Preparing Container Images (Optional)"}),"\n",(0,r.jsxs)(n.p,{children:["If you are going to use exclusively ",(0,r.jsx)(n.a,{href:"https://docs.otc.t-systems.com/software-repository-container/index.html",children:"SWR"})," as the source of your container images in CCE, you need to upload the image files to the Open Telekom Cloud container registry. For details, see ",(0,r.jsx)(n.a,{href:"https://docs.otc.t-systems.com/software-repository-container/umn/image_management/uploading_an_image_through_the_client.html",children:"Uploading an Image Through the Client"}),"."]}),"\n",(0,r.jsx)(n.admonition,{type:"note",children:(0,r.jsx)(n.p,{children:"Provisioning the source and target Kubernetes cluster(s) is out of the scope of this best practice article."})}),"\n",(0,r.jsx)(n.h2,{id:"installing-velero",children:"Installing Velero"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.a,{href:"https://velero.io/",children:"Velero"})," is an open-source tool designed to back up and restore Kubernetes cluster resources ",(0,r.jsx)(n.strong,{children:"and"})," persistent volumes. It works by capturing the state of objects such as Deployments, Services, ConfigMaps, and PersistentVolumes data, and storing them in a remote backend, like an object storage. Velero installs as a set of components within the cluster, including a server that runs as a deployment and a client CLI used for triggering operations. During a backup, Velero communicates with the Kubernetes API to collect resource definitions and with cloud provider plug-ins to handle persistent storage snapshots. For a restore, Velero applies the saved resources to the target cluster and re-attaches storage where possible. This makes it a reliable solution for disaster recovery, cluster migration, and maintaining application consistency across environments."]}),"\n",(0,r.jsxs)(n.admonition,{type:"note",children:[(0,r.jsxs)(n.p,{children:["Velero offers two modes for handling persistent volume backups: ",(0,r.jsx)(n.strong,{children:"CSI"})," and ",(0,r.jsx)(n.strong,{children:"FSB"}),":"]}),(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"CSI (Container Storage Interface)"}),": this mode integrates with storage systems that provide a CSI driver and support the Kubernetes snapshot API. In this setup, Velero creates snapshots at the storage layer, which are typically faster and more efficient since they work directly with the underlying block storage. This approach is well-suited for production environments where the storage system offers native snapshot capabilities and consistency guarantees."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"FSB (File System Backup)"}),": this mode, on the other hand, operates at the file level inside the pod. Velero deploys a helper container alongside the application pod, which mounts the same volume and uses a file-copy mechanism to back up or restore data. This method is more flexible because it works even when the storage system does not support snapshots, but it is generally slower and can introduce more load on the pod during the backup process."]}),"\n"]}),(0,r.jsx)(n.p,{children:"In practice, CSI mode is preferred when the underlying infrastructure supports it, while FSB serves as a fallback to ensure Velero can still protect workloads on storage backends without snapshot capabilities."})]}),"\n",(0,r.jsx)(n.h3,{id:"preparing-environmental-variables",children:"Preparing Environmental Variables"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["Prepare a file named ",(0,r.jsx)(n.strong,{children:"obs.credentials"}),", and save it in your workstation:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",metastring:'title="obs.credentials"',children:"[default]\naws_access_key_id=<OBS_ACCESS_KEY>\naws_secret_access_key=<OBS_SECRET_KEY>\n"})}),"\n",(0,r.jsx)(n.admonition,{type:"important",children:(0,r.jsxs)(n.p,{children:["Replace ",(0,r.jsx)(n.strong,{children:"OBS_ACCESS_KEY"})," and ",(0,r.jsx)(n.strong,{children:"OBS_SECRET_KEY"})," with the values you obtained by executing the steps in ",(0,r.jsx)(n.a,{href:"https://docs.otc.t-systems.com/object-storage-service/api-ref/appendixes/obtaining_access_keys_ak_sk.html",children:"Obtaining Access Keys (AK/SK)"}),"."]})}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["Prepare a file named ",(0,r.jsx)(n.strong,{children:"obs.env"}),", and save it in your workstation:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",metastring:'title="obs.env"',children:"export VELERO_S3_REGION=<OBS_REGION>\nexport VELERO_S3_URL=<OBS_URL>\nexport VELERO_S3_BUCKET=velero\nexport VELERO_CREDENTIALS=obs.credentials\n"})}),"\n",(0,r.jsxs)(n.admonition,{type:"important",children:[(0,r.jsxs)(n.p,{children:["Replace ",(0,r.jsx)(n.strong,{children:"VELERO_S3_REGION"})," with the Open Telekom Cloud region that your bucket lives, and ",(0,r.jsx)(n.strong,{children:"VELERO_S3_URL"})," with the OBS address. Example for ",(0,r.jsx)(n.strong,{children:"eu-de"}),":"]}),(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"VELERO_S3_REGION"})," should be ",(0,r.jsx)(n.code,{children:"eu-de"})," and"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"VELERO_S3_URL"})," should be ",(0,r.jsx)(n.code,{children:"https://obs.eu-de.otc.t-systems.com"}),"."]}),"\n"]})]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"creating-a-bucket",children:"Creating a Bucket"}),"\n",(0,r.jsxs)(n.p,{children:["Navigate to the OBS console and create a bucket named ",(0,r.jsx)(n.code,{children:"velero"})," as a destination for your backup files. You can use ",(0,r.jsx)(n.strong,{children:"any"})," bucket name, but make sure you set ",(0,r.jsx)(n.code,{children:"VELERO_S3_BUCKET"})," value in the next steps accordingly."]}),"\n",(0,r.jsx)(n.h3,{id:"installing-velero-cli",children:"Installing Velero CLI"}),"\n",(0,r.jsx)(n.admonition,{type:"important",children:(0,r.jsxs)(n.p,{children:["The Velero CLI needs to be installed either on your workstation, provided it has access to both clusters, or on ",(0,r.jsx)(n.strong,{children:"each"})," bastion host used to connect to the individual clusters."]})}),"\n",(0,r.jsx)(n.p,{children:"You can use Homebrew to install the Velero CLI on macOS or on Linux:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-shell",children:"brew install velero\n"})}),"\n",(0,r.jsxs)(n.p,{children:["or alternatively directly from the ",(0,r.jsx)(n.a,{href:"https://github.com/vmware-tanzu/velero/releases",children:"GitHub releases"})," of the project:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-shell",children:"tar -xvf velero-v1.16.2-linux-amd64.tar.gz\n"})}),"\n",(0,r.jsxs)(n.p,{children:["and then move the extracted binaries to ",(0,r.jsx)(n.strong,{children:"/usr/local/bin"}),"."]}),"\n",(0,r.jsx)(n.admonition,{type:"note",children:(0,r.jsxs)(n.p,{children:["At the time of writing, the latest Velero CLI version was ",(0,r.jsx)(n.code,{children:"v1.16.2"}),". To check for the most recent release, always refer to the ",(0,r.jsx)(n.a,{href:"https://github.com/vmware-tanzu/velero/releases",children:"GitHub releases"}),"\npage."]})}),"\n",(0,r.jsx)(n.h3,{id:"installing-velero-with-helm-chart",children:"Installing Velero with Helm Chart"}),"\n",(0,r.jsx)(n.admonition,{type:"important",children:(0,r.jsxs)(n.p,{children:["The installation of Velero has to be performed in both source ",(0,r.jsx)(n.strong,{children:"and"})," target cluster(s), with the identical configuration prepared in the previous step."]})}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"Load the environment variables you prepared:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-shell",children:"source obs.env\n"})}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["Create a namespace and provision the necessary access and secret keys as a Kubernetes ",(0,r.jsx)(n.code,{children:"Secret"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"kubectl create ns velero\nkubectl -n velero create secret generic velero-cloud-credentials --from-file=cloud=$VELERO_CREDENTIALS\n"})}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"Deploy Velero using the Helm Chart:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"helm repo add vmware-tanzu https://vmware-tanzu.github.io/helm-charts\nhelm repo update\n\nhelm upgrade --install velero vmware-tanzu/velero -n velero \\\n--set credentials.existingSecret=velero-cloud-credentials \\\n--set configuration.backupStorageLocation[0].name=default \\\n--set configuration.backupStorageLocation[0].provider=aws \\\n--set configuration.backupStorageLocation[0].bucket=$VELERO_S3_BUCKET \\\n--set configuration.backupStorageLocation[0].config.region=$VELERO_S3_REGION \\\n--set configuration.backupStorageLocation[0].config.s3ForcePathStyle=true \\\n--set configuration.backupStorageLocation[0].config.s3Url=$VELERO_S3_URL \\\n--set deployNodeAgent=true \\\n--set defaultVolumesToFsBackup=true \\\n--set snapshotsEnabled=false\n"})}),"\n",(0,r.jsxs)(n.admonition,{type:"note",children:[(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"--set deployNodeAgent=true"}),", ensures that the ",(0,r.jsx)(n.strong,{children:"Velero Node Agent"})," (formerly known as Restic) is deployed to all cluster nodes. The Node Agent runs as a DaemonSet and enables file system\u2013level backups (FSB mode, check for explanation in the previous chapters) of persistent volumes, which is required when snapshot-based backups are not available or not supported by the storage backend."]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"--set defaultVolumesToFsBackup=true"}),", configures Velero to use file system backups (FSB) as the default method for all persistent volumes. With this setting, volumes are automatically backed up using the Node Agent without requiring explicit annotations on the pods or volumes, simplifying cluster-wide backup management (although you could find tune which volumes are going to be included in the backup, with annotations either in the StatefulSet or Pod specs)."]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"--set snapshotsEnabled=false"}),", disables the use of storage-level snapshots through CSI or cloud provider integrations. This is typically done when the target storage does not support snapshot APIs, or when the strategy is to rely solely on file system backups for data protection."]}),"\n"]}),"\n"]}),(0,r.jsx)(n.p,{children:"Together, these settings configure Velero to operate entirely with file system\u2013based backups (FSB) using the Node Agent, making the backup process independent of underlying storage snapshot capabilities."}),(0,r.jsxs)(n.p,{children:["For more details on configuring the helm chart values consult the ",(0,r.jsx)(n.a,{href:"https://github.com/vmware-tanzu/helm-charts/blob/main/charts/velero/README.md",children:"Velero Helm Chart README"}),"."]})]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"Install Velero Plugin for AWS:"}),"\n",(0,r.jsxs)(n.p,{children:["The ",(0,r.jsx)(n.a,{href:"https://github.com/vmware-tanzu/velero-plugin-for-aws",children:"velero/velero-plugin-for-aws"})," is a plugin that enables Velero to interact with AWS S3-compliant object store systems. Since Open Telekom Cloud\u2019s Object Storage Service (OBS) exposes an S3-compatible API, this plugin is required to allow Velero to store and retrieve backups from OBS (or any other S3-compliant object store). Without it, Velero would not be able to communicate with the storage backend, making the plugin a necessary component for backup and restore operations in ours environment."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"velero plugin add velero/velero-plugin-for-aws:v1.8.2\n"})}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"Verify installation:"}),"\n",(0,r.jsx)(n.p,{children:"After completing the Velero installation, the next step is to verify the setup by checking the configured backup locations. This ensures Velero can properly access the object storage backend before running any backups (and, indirectly, the entire installation)."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-shell",children:"velero get backup-locations\n"})}),"\n",(0,r.jsx)(n.p,{children:"and if everything went good you should see something like this:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-shell",children:"NAME      PROVIDER   BUCKET/PREFIX   PHASE       LAST VALIDATED                   ACCESS MODE   DEFAULT\ndefault   aws        velero          Available   2025-09-10 12:35:50 +0200 CEST   ReadWrite     true\n"})}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"installing-a-velero-web-ui-optional",children:"Installing a Velero Web UI (Optional)"}),"\n",(0,r.jsxs)(n.admonition,{type:"note",children:[(0,r.jsxs)(n.p,{children:["The installation of a Velero Web UI can be performed in both source ",(0,r.jsx)(n.strong,{children:"and"})," target cluster(s). Available open-source options are ",(0,r.jsx)(n.a,{href:"https://velero-ui.docs.otwld.com/",children:"Velero UI"})," and ",(0,r.jsx)(n.a,{href:"https://vui.seriohub.com/",children:"VUI"}),". For this guide we will go for the former."]}),(0,r.jsxs)(n.p,{children:["\u26a0\ufe0f"," Both of them are unofficial solutions."]})]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-shell",children:"helm repo add otwld https://helm.otwld.com/\nhelm repo update\n\nhelm install velero-ui otwld/velero-ui --namespace velero-ui --create-namespace\n"})}),"\n",(0,r.jsx)(n.p,{children:"and the you can access the it via port-forwarding:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-shell",children:"kubectl port-forward service/velero-ui 3000:3000 -n velero-ui\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"image1",src:s(23998).A+"",width:"1917",height:"864"})}),"\n",(0,r.jsxs)(n.p,{children:["For more details consult the project's ",(0,r.jsx)(n.a,{href:"https://velero-ui.docs.otwld.com/category/-getting-started",children:"documentation"}),"."]}),"\n",(0,r.jsx)(n.h2,{id:"pre-migration-considerations",children:"Pre-Migration Considerations"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Before the migration, clear the abnormal pod resources in the source cluster. If the pod is in the abnormal state and has a PVC mounted, the PVC is in the pending state after the cluster is migrated."}),"\n",(0,r.jsx)(n.li,{children:"Ensure that the cluster on the CCE side does not have the same resources as the cluster to be migrated because Velero does not restore the same resources by default."}),"\n",(0,r.jsx)(n.li,{children:"To ensure that container images can be properly pulled after cluster migration, migrate the images to SWR, if that's necessary."}),"\n",(0,r.jsxs)(n.li,{children:["CCE ",(0,r.jsx)(n.strong,{children:"does not"})," support EVS disks of the ",(0,r.jsx)(n.code,{children:"ReadWriteMany"})," type. If resources of this type exist in the source cluster, change the storage type to ",(0,r.jsx)(n.code,{children:"ReadWriteOnce"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:["Velero integrates the Restic tool to back up and restore storage volumes. Currently, the storage volumes of the HostPath type are not supported. For details, see ",(0,r.jsx)(n.a,{href:"https://velero.io/docs/v1.7/restic/#limitations",children:"Restic Restrictions"}),". To back up storage volumes of this type, replace the ",(0,r.jsx)(n.code,{children:"hostPath"})," volumes with ",(0,r.jsx)(n.code,{children:"local"})," volumes."]}),"\n"]}),"\n",(0,r.jsx)(n.admonition,{title:"caution",type:"danger",children:(0,r.jsxs)(n.p,{children:["If a backup task involves storage of the ",(0,r.jsx)(n.code,{children:"HostPath"})," type, ",(0,r.jsx)(n.strong,{children:"the storage volumes of this type will be automatically skipped"})," and a warning message will be generated. This will not cause a backup failure."]})}),"\n",(0,r.jsx)(n.h2,{id:"deploying-a-demo-workload-on-aws-eks",children:"Deploying a Demo Workload on AWS EKS"}),"\n",(0,r.jsxs)(n.p,{children:["We will deploy ",(0,r.jsx)(n.a,{href:"https://wordpress.com/",children:"WordPress"})," on an AWS EKS cluster as a demonstration workload to provide a realistic scenario for the migration examples that follow. This deployment serves as a practical workload to showcase how a live application, including its database and persistent data, can be backed up and migrated from AWS EKS to Open Telekom Cloud\u2019s Cloud Container Engine (CCE) using Velero. By using WordPress, we can illustrate key migration concepts such as persistent volume handling, database replication, and service continuity in a controlled lab environment, allowing users to test backup, restore, and migration procedures safely before applying them to production workloads."]}),"\n",(0,r.jsx)(n.admonition,{type:"warning",children:(0,r.jsx)(n.p,{children:"This deployment is provided solely for use in a lab context to support migration exercises and should not be considered a production-ready setup."})}),"\n",(0,r.jsx)(n.h3,{id:"prerequisites-on-aws-eks",children:"Prerequisites on AWS EKS"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Ensure the Amazon EBS CSI driver is installed/enabled as an EKS add-on (needed for dynamic PersistentVolumeClaims)."}),"\n",(0,r.jsx)(n.li,{children:"Confirm your worker nodes have IAM roles allowing EBS provisioning (usually handled automatically if the add-on is installed)."}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"Check your available storage classes with:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-shell",children:"kubectl get storageclass\n"})}),"\n",(0,r.jsxs)(n.p,{children:["Typically you\u2019ll see ",(0,r.jsx)(n.code,{children:"gp2"})," or ",(0,r.jsx)(n.code,{children:"gp3"}),". We\u2019ll use gp2."]}),"\n",(0,r.jsx)(n.h3,{id:"deploying-namespace-and-secrets",children:"Deploying Namespace and Secrets"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",metastring:'title="ns-secrets.yaml"',children:'apiVersion: v1\nkind: Namespace\nmetadata:\n  name: wordpress\n---\napiVersion: v1\nkind: Secret\nmetadata:\n  name: wp-db-secret\n  namespace: wordpress\ntype: Opaque\nstringData:\n  mysql-root-password: "<A_SECURE_PASSWORD>"\n  mysql-database: "wordpress"\n  mysql-user: "wpuser"\n  mysql-password: "<A_SECURE_PASSWORD>"\n'})}),"\n",(0,r.jsxs)(n.admonition,{type:"important",children:[(0,r.jsxs)(n.p,{children:["Replace the values of ",(0,r.jsx)(n.code,{children:"mysql-root-password"})," and ",(0,r.jsx)(n.code,{children:"mysql-password"})," with a secure, strong, random passwords of your choice. e.g.:"]}),(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-shell",children:"openssl rand -base64 32\n"})})]}),"\n",(0,r.jsx)(n.p,{children:"and apply:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-shell",children:"kubectl apply -f ns-secrets.yaml\n"})}),"\n",(0,r.jsx)(n.h3,{id:"deploying-mysql-with-ebs-pvc",children:"Deploying MySQL with EBS PVC"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",metastring:'title="deployment-mysql.yaml"',children:"apiVersion: v1\nkind: PersistentVolumeClaim\nmetadata:\n  name: mysql-pvc\n  namespace: wordpress\nspec:\n  accessModes:\n    - ReadWriteOnce\n  resources:\n    requests:\n      storage: 20Gi\n  storageClassName: gp2\n---\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: mysql\n  namespace: wordpress\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: mysql\n  template:\n    metadata:\n      labels:\n        app: mysql\n    spec:\n      containers:\n      - name: mysql\n        image: mysql:8.0\n        env:\n          - name: MYSQL_ROOT_PASSWORD\n            valueFrom:\n              secretKeyRef:\n                name: wp-db-secret\n                key: mysql-root-password\n          - name: MYSQL_DATABASE\n            valueFrom:\n              secretKeyRef:\n                name: wp-db-secret\n                key: mysql-database\n          - name: MYSQL_USER\n            valueFrom:\n              secretKeyRef:\n                name: wp-db-secret\n                key: mysql-user\n          - name: MYSQL_PASSWORD\n            valueFrom:\n              secretKeyRef:\n                name: wp-db-secret\n                key: mysql-password\n        ports:\n          - containerPort: 3306\n        volumeMounts:\n          - name: mysql-data\n            mountPath: /var/lib/mysql\n      volumes:\n        - name: mysql-data\n          persistentVolumeClaim:\n            claimName: mysql-pvc\n---\napiVersion: v1\nkind: Service\nmetadata:\n  name: mysql\n  namespace: wordpress\nspec:\n  ports:\n    - port: 3306\n      targetPort: 3306\n  selector:\n    app: mysql\n  clusterIP: None\n"})}),"\n",(0,r.jsx)(n.p,{children:"and apply:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-shell",children:"kubectl apply -f deployment-mysql.yaml\n"})}),"\n",(0,r.jsx)(n.h3,{id:"deploying-wordpress-with-ebs-pvc",children:"Deploying WordPress with EBS PVC"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",metastring:'title="deployment-wp.yaml"',children:"apiVersion: v1\nkind: PersistentVolumeClaim\nmetadata:\n  name: wp-pvc\n  namespace: wordpress\nspec:\n  accessModes:\n    - ReadWriteOnce\n  resources:\n    requests:\n      storage: 10Gi\n  storageClassName: gp2\n---\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: wordpress\n  namespace: wordpress\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: wordpress\n  template:\n    metadata:\n      labels:\n        app: wordpress\n    spec:\n      containers:\n      - name: wordpress\n        image: wordpress:6.2-apache\n        env:\n          - name: WORDPRESS_DB_HOST\n            value: mysql.wordpress.svc.cluster.local:3306\n          - name: WORDPRESS_DB_NAME\n            valueFrom:\n              secretKeyRef:\n                name: wp-db-secret\n                key: mysql-database\n          - name: WORDPRESS_DB_USER\n            valueFrom:\n              secretKeyRef:\n                name: wp-db-secret\n                key: mysql-user\n          - name: WORDPRESS_DB_PASSWORD\n            valueFrom:\n              secretKeyRef:\n                name: wp-db-secret\n                key: mysql-password\n        ports:\n          - containerPort: 80\n        volumeMounts:\n          - name: wp-data\n            mountPath: /var/www/html/wp-content\n      volumes:\n        - name: wp-data\n          persistentVolumeClaim:\n            claimName: wp-pvc\n---\napiVersion: v1\nkind: Service\nmetadata:\n  name: wordpress\n  namespace: wordpress\nspec:\n  type: ClusterIP\n  ports:\n    - port: 80\n      targetPort: 80\n  selector:\n    app: wordpress\n\n"})}),"\n",(0,r.jsx)(n.p,{children:"and apply:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-shell",children:"kubectl apply -f deployment-wp.yaml\n"})}),"\n",(0,r.jsx)(n.p,{children:"and the you can access the it via port-forwarding:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-shell",children:"kubectl port-forward wordpress/wordpress 3001:80 -n wordpress\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"image1",src:s(95481).A+"",width:"1917",height:"869"})})]})}function h(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}},23998:(e,n,s)=>{s.d(n,{A:()=>t});const t=s.p+"assets/images/Screenshot_from_2025-09-10_11-44-07-7887222be59807f2b4eb50b77987baaf.png"},95481:(e,n,s)=>{s.d(n,{A:()=>t});const t=s.p+"assets/images/Screenshot_from_2025-09-10_13-40-55-cc384648a6b5822e2e30a263446744c5.png"},68986:(e,n,s)=>{s.d(n,{A:()=>t});const t=s.p+"assets/images/en-us_image_0000001402114285-a22a695a80314852081dc4ac62700377.png"},28453:(e,n,s)=>{s.d(n,{R:()=>a,x:()=>i});var t=s(96540);const r={},o=t.createContext(r);function a(e){const n=t.useContext(o);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function i(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:a(e.components),t.createElement(o.Provider,{value:n},e.children)}}}]);