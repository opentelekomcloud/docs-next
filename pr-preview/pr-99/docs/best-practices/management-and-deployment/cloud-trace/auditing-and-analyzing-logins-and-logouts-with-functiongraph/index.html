<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-best-practices/management-and-deployment/cloud-trace/auditing-and-analyzing-logins-and-logouts-with-functiongraph" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.4.0">
<title data-rh="true">Auditing and Analyzing Logins and Logouts with Functiongraph | Architecture Center</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://akyriako.github.io/docs-next/pr-preview/pr-99/img/open-telekom-cloud-social-card.png"><meta data-rh="true" name="twitter:image" content="https://akyriako.github.io/docs-next/pr-preview/pr-99/img/open-telekom-cloud-social-card.png"><meta data-rh="true" property="og:url" content="https://akyriako.github.io/docs-next/pr-preview/pr-99/docs/best-practices/management-and-deployment/cloud-trace/auditing-and-analyzing-logins-and-logouts-with-functiongraph"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Auditing and Analyzing Logins and Logouts with Functiongraph | Architecture Center"><meta data-rh="true" name="description" content="Cloud Trace Service (CTS) collects real-time records of operations on cloud resources. You can create a CTS trigger to obtain records of subscribed cloud resource operations, analyze and process the operation records, and report alarms. You can use Simple Message Notification (SMN) to push alarm messages to service personnel by SMS message or email. Figure 1 shows the procedure."><meta data-rh="true" property="og:description" content="Cloud Trace Service (CTS) collects real-time records of operations on cloud resources. You can create a CTS trigger to obtain records of subscribed cloud resource operations, analyze and process the operation records, and report alarms. You can use Simple Message Notification (SMN) to push alarm messages to service personnel by SMS message or email. Figure 1 shows the procedure."><link data-rh="true" rel="icon" href="/docs-next/pr-preview/pr-99/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://akyriako.github.io/docs-next/pr-preview/pr-99/docs/best-practices/management-and-deployment/cloud-trace/auditing-and-analyzing-logins-and-logouts-with-functiongraph"><link data-rh="true" rel="alternate" href="https://akyriako.github.io/docs-next/pr-preview/pr-99/docs/best-practices/management-and-deployment/cloud-trace/auditing-and-analyzing-logins-and-logouts-with-functiongraph" hreflang="en"><link data-rh="true" rel="alternate" href="https://akyriako.github.io/docs-next/pr-preview/pr-99/docs/best-practices/management-and-deployment/cloud-trace/auditing-and-analyzing-logins-and-logouts-with-functiongraph" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/docs-next/pr-preview/pr-99/blog/rss.xml" title="Architecture Center RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/docs-next/pr-preview/pr-99/blog/atom.xml" title="Architecture Center Atom Feed">



<link rel="preconnect" href="https://analytics.example.de">
<script async defer="defer" src="https://analytics.example.de/script.js" data-website-id="00000" data-host-url="https://analytics.example.de" data-auto-track data-do-not-track data-cache data-domains="akyriako.github.io"></script><link rel="stylesheet" href="/docs-next/pr-preview/pr-99/assets/css/styles.38b42e01.css">
<script src="/docs-next/pr-preview/pr-99/assets/js/runtime~main.8528a155.js" defer="defer"></script>
<script src="/docs-next/pr-preview/pr-99/assets/js/main.0d034b02.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/docs-next/pr-preview/pr-99/"><div class="navbar__logo"><img src="/docs-next/pr-preview/pr-99/img/logo_headline_kombination_m_s_m.png" alt="Open Telekom Cloud Non-Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/docs-next/pr-preview/pr-99/img/logo_headline_kombination_m_w_m.png" alt="Open Telekom Cloud Non-Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs-next/pr-preview/pr-99/docs/best-practices/">Best Practices</a><a class="navbar__item navbar__link" href="/docs-next/pr-preview/pr-99/docs/blueprints/">Blueprints</a></div><div class="navbar__items navbar__items--right"><a href="https://auth.otc.t-systems.com/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link navbar--terminal-link" aria-label="Open Telekom Cloud Console"></a><a href="https://github.com/opentelekomcloud-blueprints" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link navbar--github-link" aria-label="GitHub"></a><div class="toggle_vylO colorModeToggle_x44X"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_dCNk"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs-next/pr-preview/pr-99/docs/best-practices/">Best Practices</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a href="https://docs.otc.t-systems.com/application-operations-management/index.html" target="_blank" rel="noopener noreferrer" class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false">Application Services</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a href="https://docs.otc.t-systems.com/cloud-search-service/index.html" target="_blank" rel="noopener noreferrer" class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false">Big Data &amp; Data Analysis</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a href="https://docs.otc.t-systems.com/auto-scaling/index.html" target="_blank" rel="noopener noreferrer" class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false">Computing</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs-next/pr-preview/pr-99/docs/best-practices/containers/cloud-container-engine/issue-an-acme-certificate-with-dns01-solver-in-cce">Containers</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs-next/pr-preview/pr-99/docs/best-practices/databases/distributed-cache-service/using-nginx-for-public-access-to-single-node-master-standby-or-proxy-cluster-dcs-redis-instances">Databases</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a href="https://docs.otc.t-systems.com/application-performance-management/index.html" target="_blank" rel="noopener noreferrer" class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true">Management &amp; Deployment</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a href="https://docs.otc.t-systems.com/application-performance-management/index.html" target="_blank" rel="noopener noreferrer" class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0">Application Performance Management</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/docs-next/pr-preview/pr-99/docs/best-practices/management-and-deployment/cloud-create/">Cloud Create 🔥</a><button aria-label="Expand sidebar category &#x27;Cloud Create 🔥&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs-next/pr-preview/pr-99/docs/best-practices/management-and-deployment/cloud-eye/resource-group-monitoring">Cloud Eye</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" tabindex="0" href="/docs-next/pr-preview/pr-99/docs/best-practices/management-and-deployment/cloud-trace/auditing-and-analyzing-logins-and-logouts-with-functiongraph">Cloud Trace Service</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs-next/pr-preview/pr-99/docs/best-practices/management-and-deployment/cloud-trace/auditing-and-analyzing-logins-and-logouts-with-functiongraph">Auditing and Analyzing Logins and Logouts with Functiongraph</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a href="https://docs.otc.t-systems.com/cloud-trace-service/index.html" target="_blank" rel="noopener noreferrer" class="menu__link menuExternalLink_NmtK" tabindex="0">📚 Go to Help Center<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a href="https://docs.otc.t-systems.com/log-tank-service/index.html" target="_blank" rel="noopener noreferrer" class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0">Log Tank Service</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a href="https://docs.otc.t-systems.com/resource-management-service/index.html" target="_blank" rel="noopener noreferrer" class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0">Resource Management Service</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a href="https://docs.otc.t-systems.com/tag-management-service/index.html" target="_blank" rel="noopener noreferrer" class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0">Tag Management Service</a></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a href="https://docs.otc.t-systems.com/direct-connect/index.html" target="_blank" rel="noopener noreferrer" class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false">Networking</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a href="https://docs.otc.t-systems.com/anti-ddos/index.html" target="_blank" rel="noopener noreferrer" class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false">Security Services</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a href="https://docs.otc.t-systems.com/cloud-backup-recovery/index.html" target="_blank" rel="noopener noreferrer" class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false">Storage</a></div></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/docs-next/pr-preview/pr-99/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Management &amp; Deployment</span><meta itemprop="position" content="1"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Cloud Trace Service</span><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Auditing and Analyzing Logins and Logouts with Functiongraph</span><meta itemprop="position" content="3"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Auditing and Analyzing Logins and Logouts with Functiongraph</h1>
<p>Cloud Trace Service (CTS) collects real-time records of operations on cloud resources. You can create a CTS trigger to obtain records of subscribed cloud resource operations, analyze and process the operation records, and report alarms. You can use Simple Message Notification (SMN) to push alarm messages to service personnel by SMS message or email. <a href="/docs-next/pr-preview/pr-99/docs/best-practices/management-and-deployment/cloud-trace/auditing-and-analyzing-logins-and-logouts-with-functiongraph#figure-1">Figure 1</a> shows the procedure.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="solution-design">Solution Design<a class="hash-link" aria-label="Direct link to Solution Design" title="Direct link to Solution Design" href="/docs-next/pr-preview/pr-99/docs/best-practices/management-and-deployment/cloud-trace/auditing-and-analyzing-logins-and-logouts-with-functiongraph#solution-design">​</a></h2>
<a id="figure-1"></a>
<p><img decoding="async" loading="lazy" alt="Figure 1" src="/docs-next/pr-preview/pr-99/assets/images/en-us_image_0000001264679162-167335dc9b9138298f172342e243483d.png" width="753" height="460" class="img_ev3q"></p>
<p><strong>Figure 1</strong> Flowchart</p>
<ul>
<li>Operation records collected by CTS can be quickly analyzed and operations from specified IP addresses can be filtered out.</li>
<li>CTS processes and analyzes data in response to log events in a serverless architecture, which features automatic scaling, no O&amp;M, and pay-per-use billing.</li>
<li>CTS sends alarm notifications through SMN.</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="enabling-cts">Enabling CTS<a class="hash-link" aria-label="Direct link to Enabling CTS" title="Direct link to Enabling CTS" href="/docs-next/pr-preview/pr-99/docs/best-practices/management-and-deployment/cloud-trace/auditing-and-analyzing-logins-and-logouts-with-functiongraph#enabling-cts">​</a></h2>
<p>Configure a tracker, and the system immediately starts recording operations based on the new rule.</p>
<ol>
<li>Log in to the console.</li>
<li>Click <img decoding="async" loading="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA8AAAASCAYAAACEnoQPAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAEXRFWHRTb2Z0d2FyZQBTbmlwYXN0ZV0Xzt0AAAGkSURBVDiNndO/i+JAGMfhj8eQLFYagkUKbSyEYCysRLCwsFJEwc7av8tCEGJnIfaaSkWxEWzFFCIqGAKJgbviUC5m2Vv2W87MMzPv/Ih5nvebH+bXT+F/8e12+xKL94bdbodlWTiO82pLJpM0m00SiURobOzfmufzOcvlEgBZllEUhcvlgud5ALRaLTKZTBTbto1pmgghaDQaoUGr1YrZbIYQgl6vhyRJ4ZoXiwUAlUrlBZ81F4tFdF0nCALW6/Vr0he+3W4IIcjlcgAMBgP6/T6TyQSAQqEAwPF4jOJnJEnC933u9zsAl8sl1P94PKL44+ODIAiwbRtJkmg2mxiGQbvdBuBwOACgKEoUZ7NZADabDQCaplGtVonH48DfKwTQdT2K8/k8siyz3+85nU6hrW63W87nM6qqomlaFEuSRLlcBmA8HuP7PgCu62JZFgC1Wi00aejADMMgnU7jOA6maeL7PqPRCM/zKJVKpFKpEI69/yrf9xkOh1yvV4QQBEGAqqp0u13e8+lVdTodZFn+En668jOu6zKdTqnX66/n+G38nfwBKbqv10VnRowAAAAASUVORK5CYII=" width="15" height="18" class="img_ev3q"> in the upper left corner of the console and select a region and a project.</li>
<li>Click <img decoding="async" loading="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABkAAAAXCAYAAAD+4+QTAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAEXRFWHRTb2Z0d2FyZQBTbmlwYXN0ZV0Xzt0AAABSSURBVEiJY/z///9/BhoDJlpbQDdLWGCM9+8/MKRllTJcvHyNIgP1dbUYZk3rZhAUFICL0cUnjKMRPzItGU3CJIHhE/HDx5LRJEwSGD4RTxdLANA6KyHkPZlqAAAAAElFTkSuQmCC" width="25" height="23" class="img_ev3q"> in the upper left corner and choose <em>Management &amp; Governance</em> -&gt; <em>Cloud Trace Service</em>.</li>
<li>On the displayed page, choose <em>Tracker List</em> in the navigation pane on the left.</li>
<li>Locate a data tracker and click <em>Configure</em> in the <em>Operation</em> column.<!-- -->
<ul>
<li><strong>Operation</strong>: Select the data operations that need to be recorded.</li>
<li><strong>Transfer to OBS</strong>
<ul>
<li>If you select <em>Yes</em>, select an existing OBS bucket or create one directly on the <em>Configure Tracker</em> page and set <strong>File Prefix</strong>.</li>
<li>If you select <em>No</em>, no configuration is required.</li>
</ul>
</li>
<li><strong>Create OBS Bucket</strong>: If this function is enabled, an OBS bucket will be created automatically with the name you enter. If this function is disabled, select an existing OBS bucket.</li>
<li><strong>OBS Bucket</strong>: You can create an OBS bucket or select an existing OBS bucket.</li>
<li><strong>Retention Period</strong>: Select the duration for storing traces in the OBS bucket.</li>
<li><strong>File Prefix</strong>: The prefix is used to mark a transferred trace file. Your specified prefix will be automatically added to the beginning of the name of a transferred file, helping you quickly filter files.</li>
<li><strong>Verify Trace File</strong>: When this function is enabled, integrity verification will be performed to check whether trace files in OBS buckets have been tampered with.</li>
</ul>
</li>
<li>Click <em>OK</em> to complete the tracker configuration.</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="creating-an-agency">Creating an Agency<a class="hash-link" aria-label="Direct link to Creating an Agency" title="Direct link to Creating an Agency" href="/docs-next/pr-preview/pr-99/docs/best-practices/management-and-deployment/cloud-trace/auditing-and-analyzing-logins-and-logouts-with-functiongraph#creating-an-agency">​</a></h2>
<ol>
<li>
<p>Log in to the <a href="https://console.otc.t-systems.com/iam/?locale=en-us" target="_blank" rel="noopener noreferrer"><em>Identity and Access Management (IAM) console</em></a>. In the navigation pane on the left, choose <em>Agencies</em>.</p>
</li>
<li>
<p>On the <em>Agencies</em> page, click <em>Create Agency</em>.</p>
</li>
<li>
<p>Set the agency information.</p>
<ul>
<li>For <strong>Agency Name</strong>, enter <code>serverless\_trust</code>.</li>
<li>For <strong>Agency Type</strong>, select <strong>Cloud service</strong>.</li>
<li>For <strong>Cloud service</strong>, select <strong>FunctionGraph</strong>.</li>
<li>For <strong>Validity Period</strong>, select <strong>Unlimited</strong>.</li>
<li>Click <em>Assign Permissions</em>. On the <em>Assign Permissions</em> page, select <strong>Tenant Administrator</strong>.</li>
</ul>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><p>Users with the <strong>Tenant Administrator</strong> permission can perform any operations on all cloud resources of the enterprise.</p></div></div>
</li>
<li>
<p>Click <em>OK</em>.</p>
</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="pushing-alarm-messages">Pushing Alarm Messages<a class="hash-link" aria-label="Direct link to Pushing Alarm Messages" title="Direct link to Pushing Alarm Messages" href="/docs-next/pr-preview/pr-99/docs/best-practices/management-and-deployment/cloud-trace/auditing-and-analyzing-logins-and-logouts-with-functiongraph#pushing-alarm-messages">​</a></h2>
<ul>
<li>Create a topic named <code>cts\_test</code> on the <em>SMN console</em>. For details, see <a href="https://docs.otc.t-systems.com/simple-message-notification/umn/topic_management/creating_a_topic.html" target="_blank" rel="noopener noreferrer">Creating a Topic</a>.</li>
<li>Add subscriptions to the <strong>cts_test</strong> topic to push alarm messages. For details, see <a href="https://docs.otc.t-systems.com/simple-message-notification/umn/topic_management/adding_a_subscription_to_a_topic.html" target="_blank" rel="noopener noreferrer">Adding a Subscription</a>.</li>
</ul>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><ul>
<li>Alarm messages can be sent by <strong>emails</strong>, <strong>SMS</strong> messages, and <strong>HTTP/HTTPS</strong>.</li>
<li>In this example, when log events trigger the specified function, the function filters operations that are performed by users not in the IP address whitelist, and pushes alarm messages to the subscribers.</li>
</ul></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="building-a-program">Building a Program<a class="hash-link" aria-label="Direct link to Building a Program" title="Direct link to Building a Program" href="/docs-next/pr-preview/pr-99/docs/best-practices/management-and-deployment/cloud-trace/auditing-and-analyzing-logins-and-logouts-with-functiongraph#building-a-program">​</a></h2>
<p>This section describes how to download and use the program package <a href="https://functionstage-examples.obs.cn-north-1.myhuaweicloud.com/index.zip" target="_blank" rel="noopener noreferrer">(index.zip)</a> for log alarms.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="creating-a-function">Creating a Function<a class="hash-link" aria-label="Direct link to Creating a Function" title="Direct link to Creating a Function" href="/docs-next/pr-preview/pr-99/docs/best-practices/management-and-deployment/cloud-trace/auditing-and-analyzing-logins-and-logouts-with-functiongraph#creating-a-function">​</a></h3>
<p>Create a function for extracting logs and upload the <a href="https://functionstage-examples.obs.cn-north-1.myhuaweicloud.com/fss_examples_logstore_warning.zip" target="_blank" rel="noopener noreferrer">sample code</a> package. For details, see <a href="https://docs.otc.t-systems.com/function-graph/umn/function_management.html" target="_blank" rel="noopener noreferrer">Function Management</a>.</p>
<p>This function analyzes received operation records, filters logins or logouts from unauthorized IP addresses using a whitelist, and sends alarms under a specified SMN topic.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="setting-environment-variables">Setting Environment Variables<a class="hash-link" aria-label="Direct link to Setting Environment Variables" title="Direct link to Setting Environment Variables" href="/docs-next/pr-preview/pr-99/docs/best-practices/management-and-deployment/cloud-trace/auditing-and-analyzing-logins-and-logouts-with-functiongraph#setting-environment-variables">​</a></h3>
<p>On the <em>Configuration</em> tab page of the function, set the environment variables and SMN topic name, as shown in table below:</p>
<table><thead><tr><th>Environment Variable</th><th>Description</th></tr></thead><tbody><tr><td>SMN_Topic</td><td>SMN topic name.</td></tr><tr><td>RegionName</td><td>Region.</td></tr><tr><td>IP</td><td>IP address whitelist.</td></tr></tbody></table>
<p><strong>Table 1</strong> Environment variable description</p>
<p>For details about how to set environment variables, see <a href="https://docs.otc.t-systems.com/function-graph/umn/configuring_functions/configuring_environment_variables.html" target="_blank" rel="noopener noreferrer">Using Environment Variables</a>, as shown in <a href="/docs-next/pr-preview/pr-99/docs/best-practices/management-and-deployment/cloud-trace/auditing-and-analyzing-logins-and-logouts-with-functiongraph#figure-2">Figure 2</a>.</p>
<a id="figure-2"></a>
<p><img decoding="async" loading="lazy" src="/docs-next/pr-preview/pr-99/assets/images/en-us_image_0000001264392960-9054719e1a3dce557972321447efaadb.png" width="859" height="307" class="img_ev3q"></p>
<p><strong>Figure 2</strong> Setting environment variables</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="adding-an-event-source">Adding an Event Source<a class="hash-link" aria-label="Direct link to Adding an Event Source" title="Direct link to Adding an Event Source" href="/docs-next/pr-preview/pr-99/docs/best-practices/management-and-deployment/cloud-trace/auditing-and-analyzing-logins-and-logouts-with-functiongraph#adding-an-event-source">​</a></h2>
<p>Create a CTS trigger, as shown in <a href="/docs-next/pr-preview/pr-99/docs/best-practices/management-and-deployment/cloud-trace/auditing-and-analyzing-logins-and-logouts-with-functiongraph#enabling-cts">Enabling CTS</a>. For details, see <a href="https://docs.otc.t-systems.com/function-graph/umn/creating_triggers/using_a_cts_trigger.html" target="_blank" rel="noopener noreferrer">Using a CTS Trigger</a>.</p>
<a id="figure-3"></a>
<p><img decoding="async" loading="lazy" src="/docs-next/pr-preview/pr-99/assets/images/en-us_image_0000001312436037-e3255c9a57e3bf03e77905d1bad381f0.png" width="671" height="560" class="img_ev3q"></p>
<p><strong>Figure 3</strong> Creating a CTS trigger</p>
<p>CTS records the logins and logouts of users on IAM.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="processing-operation-records">Processing Operation Records<a class="hash-link" aria-label="Direct link to Processing Operation Records" title="Direct link to Processing Operation Records" href="/docs-next/pr-preview/pr-99/docs/best-practices/management-and-deployment/cloud-trace/auditing-and-analyzing-logins-and-logouts-with-functiongraph#processing-operation-records">​</a></h2>
<p>When a user performs login or logout using an account, the subscription service log will be triggered and a function will be directly invoked. The system then checks whether the IP address of the current login or logout account is in the whitelist based on function code. If the IP address is not in the whitelist, SMN will send notifications, as shown in <a href="/docs-next/pr-preview/pr-99/docs/best-practices/management-and-deployment/cloud-trace/auditing-and-analyzing-logins-and-logouts-with-functiongraph#figure-4">Figure 4</a>.</p>
<a id="figure-4"></a>
<p><img decoding="async" loading="lazy" src="https://support.huaweicloud.com/intl/en-us/bestpractice-cts/en-us_image_0000001312598869.png" alt="" class="img_ev3q"></p>
<p><strong>Figure 4</strong> Alarm notification sent by email</p>
<p>The email contains the unauthorized IP address and user operation (login or logout).</p>
<p>On the <em>Monitoring</em> tab page of the function, check the number of invocations, as shown in <a href="/docs-next/pr-preview/pr-99/docs/best-practices/management-and-deployment/cloud-trace/auditing-and-analyzing-logins-and-logouts-with-functiongraph#figure-5">Figure 5</a>.</p>
<a id="figure-"></a>
<p><strong>Figure 5</strong> Function metrics<br>
<img decoding="async" loading="lazy" src="https://support.huaweicloud.com/intl/en-us/bestpractice-cts/en-us_image_0000001312357985.png" alt="" class="img_ev3q"></p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-tags-row"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/docs-next/pr-preview/pr-99/docs/tags/cts">cts</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/docs-next/pr-preview/pr-99/docs/tags/cts-trigger">cts-trigger</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/docs-next/pr-preview/pr-99/docs/tags/functiongraph">functiongraph</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/docs-next/pr-preview/pr-99/docs/tags/events">events</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/docs-next/pr-preview/pr-99/docs/tags/logs">logs</a></li></ul></div></div><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/akyriako/docs-next/tree/main/docs/best-practices/management-and-deployment/cloud-trace/auditing-and-analyzing-logins-and-logouts-with-functiongraph.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs-next/pr-preview/pr-99/docs/best-practices/management-and-deployment/cloud-eye/resource-group-monitoring"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Resource Group Monitoring</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs-next/pr-preview/pr-99/docs/best-practices/networking/domain-name-service/configuring-private-domain-names-for-ecss"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Configuring Private Domain Names for ECSs</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a class="table-of-contents__link toc-highlight" href="/docs-next/pr-preview/pr-99/docs/best-practices/management-and-deployment/cloud-trace/auditing-and-analyzing-logins-and-logouts-with-functiongraph#solution-design">Solution Design</a></li><li><a class="table-of-contents__link toc-highlight" href="/docs-next/pr-preview/pr-99/docs/best-practices/management-and-deployment/cloud-trace/auditing-and-analyzing-logins-and-logouts-with-functiongraph#enabling-cts">Enabling CTS</a></li><li><a class="table-of-contents__link toc-highlight" href="/docs-next/pr-preview/pr-99/docs/best-practices/management-and-deployment/cloud-trace/auditing-and-analyzing-logins-and-logouts-with-functiongraph#creating-an-agency">Creating an Agency</a></li><li><a class="table-of-contents__link toc-highlight" href="/docs-next/pr-preview/pr-99/docs/best-practices/management-and-deployment/cloud-trace/auditing-and-analyzing-logins-and-logouts-with-functiongraph#pushing-alarm-messages">Pushing Alarm Messages</a></li><li><a class="table-of-contents__link toc-highlight" href="/docs-next/pr-preview/pr-99/docs/best-practices/management-and-deployment/cloud-trace/auditing-and-analyzing-logins-and-logouts-with-functiongraph#building-a-program">Building a Program</a><ul><li><a class="table-of-contents__link toc-highlight" href="/docs-next/pr-preview/pr-99/docs/best-practices/management-and-deployment/cloud-trace/auditing-and-analyzing-logins-and-logouts-with-functiongraph#creating-a-function">Creating a Function</a></li><li><a class="table-of-contents__link toc-highlight" href="/docs-next/pr-preview/pr-99/docs/best-practices/management-and-deployment/cloud-trace/auditing-and-analyzing-logins-and-logouts-with-functiongraph#setting-environment-variables">Setting Environment Variables</a></li></ul></li><li><a class="table-of-contents__link toc-highlight" href="/docs-next/pr-preview/pr-99/docs/best-practices/management-and-deployment/cloud-trace/auditing-and-analyzing-logins-and-logouts-with-functiongraph#adding-an-event-source">Adding an Event Source</a></li><li><a class="table-of-contents__link toc-highlight" href="/docs-next/pr-preview/pr-99/docs/best-practices/management-and-deployment/cloud-trace/auditing-and-analyzing-logins-and-logouts-with-functiongraph#processing-operation-records">Processing Operation Records</a></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://docs.otc.t-systems.com/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Help Center</a></li><li class="footer__item"><a href="https://www.open-telekom-cloud.com/en/products-services/roadmap" target="_blank" rel="noopener noreferrer" class="footer__link-item">Portfolio Roadmap</a></li></ul></div><div class="col footer__col"><div class="footer__title">Developers</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://docs.otc.t-systems.com/developer/sdk.html" target="_blank" rel="noopener noreferrer" class="footer__link-item">SDKs</a></li><li class="footer__item"><a href="https://docs.otc.t-systems.com/developer/drivers.html" target="_blank" rel="noopener noreferrer" class="footer__link-item">Drivers &amp; Tools</a></li><li class="footer__item"><a href="https://registry.terraform.io/providers/opentelekomcloud/opentelekomcloud/latest/docs" target="_blank" rel="noopener noreferrer" class="footer__link-item">Terraform Provider</a></li><li class="footer__item"><a href="https://docs.otc.t-systems.com/ansible-collection-cloud/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Ansible Collections</a></li><li class="footer__item"><a href="https://designer.otc-service.com/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Cloud Create</a></li></ul></div><div class="col footer__col"><div class="footer__title">API</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://docs.otc.t-systems.com/developer/api.html" target="_blank" rel="noopener noreferrer" class="footer__link-item">REST API</a></li><li class="footer__item"><a href="https://docs.otc.t-systems.com/developer/api_guidelines/index.html" target="_blank" rel="noopener noreferrer" class="footer__link-item">REST API Usage Guidelines</a></li><li class="footer__item"><a href="https://docs.otc.t-systems.com/regions-and-endpoints/index.html" target="_blank" rel="noopener noreferrer" class="footer__link-item">Endpoints</a></li><li class="footer__item"><a href="https://status.otc-service.com/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Status Dashboard</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://community.open-telekom-cloud.com/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Community Forums</a></li><li class="footer__item"><a href="https://www.youtube.com/watch?v=U-x2gEy3968&amp;list=PLS60dhorR-hgQ5n5L1boEQh0oVD-_k75p" target="_blank" rel="noopener noreferrer" class="footer__link-item">Webinars<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"></div></div><scale-telekom-footer type="minimal"><scale-telekom-footer-content><span slot="notice">© T-Systems International GmbH 2024 (v0.1.PR99-14-59622d3-preview)</span><ul slot="navigation"><li><a href="https://open-telekom-cloud.com/en/contact"> Contact </a></li><li><a href="https://open-telekom-cloud.com/en/data-protection"> Data privacy </a></li><li><a href="https://open-telekom-cloud.com/en/disclaimer-of-liability"> Disclaimer of liabilities </a></li><li><a href="https://open-telekom-cloud.com/en/imprint"> Imprint </a></li></ul></scale-telekom-footer-content></scale-telekom-footer></footer></div>
</body>
</html>